import{withDirectives as e,openBlock as t,createElementBlock as s,createElementVNode as l,renderSlot as i,vShow as a,reactive as n,ref as r,Fragment as o,renderList as d,createTextVNode as c,toDisplayString as p,vModelText as u,pushScopeId as h,popScopeId as f,onMounted as m,unref as _,computed as g,mergeProps as y,createBlock as v,vModelSelect as b,vModelDynamic as k,createVNode as j,withCtx as w,resolveComponent as x,withModifiers as S,createCommentVNode as O,vModelCheckbox as C,normalizeClass as P,inject as A,normalizeStyle as E,isRef as M,Suspense as T,resolveDynamicComponent as U,Teleport as V,createApp as N}from"vue";const D={class:"ptj-modal-backdrop"},R={class:"ptj-modal"};var L={props:{active:{required:!0}},setup:n=>(r,o)=>e((t(),s("div",D,[l("div",R,[l("header",null,[l("button",{type:"button",class:"btn-close",onClick:o[0]||(o[0]=e=>{r.$emit("close")})}," x ")]),i(r.$slots,"default")])],512)),[[a,n.active]]),__file:"presstojam/src/components/ptj-modal.vue"};let B={};var I={regSettings:function(e,t=null){t?B[t]=e:B=e},getSettings:function(e){return B[e]},getModelSettings:function(e,t){return B.models&&B.models[e]&&B.models[e][t]?B.models[e][t]:{}}};let z,F={};var $={initSettings(){const e=I.getSettings("client");if(!e.url)throw"No URL defined for client";if(z=e.url,e.custom_headers)for(let t in e.custom_headers)F[t]=e.custom_headers[t]},run(e,t){return z||this.initSettings(),t.mode="cors",t.cache="no-cache",t.credentials="include",t["Content-Type"]="application/json",t.headers=F,fetch(z+e,t).then((e=>{if(e.ok)return e.json();throw e}))},get(e,t){if(t){const s=new URLSearchParams;for(let e in t)Array.isArray(t[e])||"object"==typeof t[e]&&null!==t[e]?s.append(e,JSON.stringify(t[e])):s.append(e,t[e]);-1==e.indexOf("?")?e+="?":e+="&",e+=s.toString()}let s={method:"GET"};return this.run(e,s)},getprimary(e,t){return this.get(e,t)},post(e,t){let s={method:"POST"};return s.body=JSON.stringify(t),this.run(e,s)},put(e,t){let s={method:"PUT"};return s.body=JSON.stringify(t),this.run(e,s)},patch(e,t){let s={method:"PATCH"};return s.body=JSON.stringify(t),this.run(e,s)},delete(e,t){let s={method:"DELETE"};return s.body=JSON.stringify(t),this.run(e,s)}};const J=new class{constructor(){this._route="",this._model="",this._state="",this._key=0,this._to="",this._params={},this._settings={},this._base="/",this._default=!1,this._changes={};Object.keys(this).forEach((e=>{"_"==e[0]&&Object.defineProperty(this,e.substring(1),{get:function(){return this[e]},set:function(t){t!=this[e]&&(this._changes[e.substring(1)]=this[e],this[e]=t)}})})),this.action_map={post:"-create",put:"-update",delete:"-delete",login:"-login",logout:"-logout",primary:"-primary",parent:"-parent",get:""}}get id(){return this.model+"-"+this.state+"-"+this.to}hasChange(e){return this._changes.hasOwnProperty(e)}reset(){this.route="",this.model="",this.state="",this.key=0,this.to="",this.params={},this.settings={},this._changes={}}resetChanges(){this._changes={}}convertToURL(){let e=this._base+this.route+"/"+this.model+this.action_map[this.state];this.key&&(e+="-"+this.key),this.to&&(e+="-to-"+this.to);let t=[];for(const e in this.params)"Array"==typeof this.params[e]||"Object"==typeof this.params[e]?t.push(e+"="+JSON.stringify(this.params[e])):t.push(e+"="+this.params[e]);return t.length>0&&(e+="?"+t.join("&")),e}init(){let e=new URL(window.location.href),t=e.pathname.replace(this.base,"");if(t=t.replace(/^\/+|\/+$/g,""),!t)return;let s=t.split("/");if(s.length<2)throw"Map can't init as can't convert url of "+e.pathname;this.route=s[0],t=s[1];const l=this;e.searchParams.forEach((function(e,t){l.params[t]=e.indexOf(",")>-1?e.split(","):e})),s=t.split("-to-"),s.length>1&&(this.to=s[1],t=s[0]),s=t.split("-");let i=s[s.length-1];if("first"==i?(this.key=i,s.pop()):isNaN(i)||(this.key=i,s.pop()),0==s.length)throw new Error("Can't convert this url string: "+t);this.state="get";for(let e in this.action_map)if(this.action_map[e]=="-"+s[s.length-1]){this.state=e,s.pop();break}this.model=s.join("-")}getAll(){return{route:this.route,model:this.model,state:this.state,key:this.key,to:this.to,params:this.params,base:this.base,default:this.default}}apply(e){for(let t in e)this[t]=e[t]}};let X={};function q(e,t,s){if(!X.fields[e])return s;const l=X.fields[e];return l[t]?l[t]:s}window.onpopstate=function(){J.convertFromURL(),Q()};const Y=n({component:"",title:"",name:"",route:{children:[],parent:null,perms:[]},slug:[]});function H(){return Y.component="",$.get("/nav/route-points/"+J.route+"/"+J.model).then((e=>{var t;Y.route.children=e.children,Y.route.perms=e.perms,Y.route.parent=e.parent,Y.title=e.title,Y.name=e.name,t=e.dictionary,X=t,"get"==J.state||"parent"==J.state?Y.component="ptj-repo":"primary"==J.state?Y.component="ptj-primary":"login"==J.state&&(Y.component="ptj-account-handler")})).then((e=>{})).catch((e=>console.log(e)))}function K(){Y.slug=[];let e={};if("parent"==J.state)e["--parentid"]=J.key;else{if("primary"!=J.state)return;e["--id"]=J.key}return $.get("/slug/"+J.route+"/"+J.model,e).then((e=>{Y.slug=e;for(let e in Y.slug)e=parseInt(e),Y.slug[e].route=e>0?{model:Y.slug[e].model,state:"parent",key:Y.slug[e].id}:{model:Y.slug[e].model,state:"get",key:0}}))}function W(){location.href=J.base}function Z(){G(),Q()}function G(){const e=window.location.protocol+"//"+window.location.host+J.convertToURL(),t=new URL(e);window.history.pushState({name:t.pathname},document.title,t)}function Q(){H(),K()}var ee={props:{route:Object},setup(e){const l=e;function a(){for(let e in l.route)J[e]=l.route[e];Z()}return(l,n)=>(t(),s("a",{class:"ptj-button",key:e.route,onClick:a},[i(l.$slots,"default")]))},__file:"presstojam/src/components/ptj-button.vue"};const te={class:"ptj-multiple-select"},se={class:"ptj-multiple-select-display"},le={class:"ptj-multiple-select-values"},ie=["onClick"],ae=[(e=>(h("data-v-51b18f4e"),e=e(),f(),e))((()=>l("span",{class:"material-icons"},"close",-1)))];var ne={props:{field:Object},setup(i){const a=i,n=r("");function h(){a.field.change1=n.value,n.value=""}return(r,f)=>(t(),s("div",te,[l("div",se,[l("div",le,[(t(!0),s(o,null,d(i.field.change1,(e=>(t(),s("div",{class:"ptj-multiple-select-val",key:e},[c(p(e)+" ",1),l("a",{class:"ptj-multiple-select-val-remove",onClick:t=>{return s=e,void(a.field.change=a.field.change.filter((function(e){return e!==s})));var s}},ae,8,ie)])))),128))]),e(l("input",{type:"text","onUpdate:modelValue":f[0]||(f[0]=e=>n.value=e)},null,512),[[u,n.value]]),l("a",{onClick:h},"add")])]))}};function re(e,t){void 0===t&&(t={});var s=t.insertAt;if(e&&"undefined"!=typeof document){var l=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===s&&l.firstChild?l.insertBefore(i,l.firstChild):l.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}re("\n.ptj-multiple-select-val[data-v-51b18f4e] {\r\n    display : inline-block;\r\n    border : 1px solid green;\r\n    margin-left : 2px;\r\n    margin-right : 2px;\r\n    padding : 2px;\r\n    background-color : green;\n}\n.ptj-multiple-select-val-remove[data-v-51b18f4e] {\r\n    color : red;\n}\n.ptj-multiple-select-display[data-v-51b18f4e] {\r\n    position :relative;\r\n    background-color : #fff;\r\n    border : 1px solid #cdcdcd;\r\n    min-height : 35px;\n}\r\n\r\n"),ne.__scopeId="data-v-51b18f4e",ne.__file="presstojam/src/components/ptj-multiple-input.vue";const oe={class:"ptj-multiple-select"},de={class:"ptj-multiple-select-display"},ce={class:"ptj-multiple-select-values"},pe=["onClick"],ue=[(e=>(h("data-v-5b05457d"),e=e(),f(),e))((()=>l("span",{class:"material-icons"},"close",-1)))],he={class:"material-icons"},fe=["data-key"];var me={props:{field:Object},setup(i){const r=i;m((()=>{if(r.field.reference){let e="/reference/"+J.model+"/"+r.field.name;r.field.setReferenceOptions(e,{"--parentid":J.key})}}));const u=n({display:!1,symbol:"keyboard_arrow_down"});function h(){u.display?(u.display=!1,u.symbol="keyboard_arrow_down"):(u.display=!0,u.symbol="keyboard_arrow_up")}function f(e){r.field.change1=e.target.getAttribute("data-key"),h()}return(n,m)=>(t(),s("div",oe,[l("div",de,[l("div",ce,[(t(!0),s(o,null,d(i.field.change,(e=>(t(),s("div",{class:"ptj-multiple-select-val",key:e},[c(p(i.field.getOption(e))+" ",1),l("a",{class:"ptj-multiple-select-val-remove",onClick:t=>{return s=e,void(r.field.change=r.field.change.filter((function(e){return e!==s})));var s}},ue,8,pe)])))),128))]),l("a",{class:"ptj-multiple-select-arrow",onClick:h},[l("span",he,p(_(u).symbol),1)])]),e(l("ul",{class:"ptj-multiple-select-options",onClick:f},[(t(!0),s(o,null,d(i.field.options,(e=>(t(),s("li",{key:e.key,"data-key":e.key},p(e.value),9,fe)))),128))],512),[[a,_(u).display]])]))}};re("\n.ptj-multiple-select-val[data-v-5b05457d] {\r\n    display : inline-block;\r\n    border : 1px solid green;\r\n    margin-left : 2px;\r\n    margin-right : 2px;\r\n    padding : 2px;\r\n    background-color : green;\n}\n.ptj-multiple-select-val-remove[data-v-5b05457d] {\r\n    color : red;\n}\n.ptj-multiple-select-arrow[data-v-5b05457d] {\r\n    position :absolute;\r\n    right : 2px;\r\n    top : 3px;\n}\n.ptj-multiple-select-display[data-v-5b05457d] {\r\n    position :relative;\r\n    background-color : #fff;\r\n    border : 1px solid #cdcdcd;\r\n    min-height : 35px;\n}\n.ptj-multiple-select-options li[data-v-5b05457d] {\r\n    list-style: none;\r\n    cursor: pointer;\r\n    margin-top : 2px;\r\n    border : 1px solid #cdcdcd;\r\n    background-color : #fff;\n}\n.ptj-multiple-select-options li[data-v-5b05457d]:hover {\r\n    background-color : #f9f9fb;\r\n    transition : background-color .2s ease-out,border .2s ease-out;\n}\r\n"),me.__scopeId="data-v-5b05457d",me.__file="presstojam/src/components/ptj-multiple-select.vue";const _e=["name"],ge={key:1},ye=["name"],ve=l("option",{value:"",selected:"",disabled:""},"Select Option",-1),be=["value"],ke=["name"],je={key:6},we={key:7};var xe={props:{field:{type:Object,required:!0},type:{type:String,default:"view"}},setup(l){const i=l;let a=g((()=>"edit"==i.type&&i.field.immutable?"view":i.type));const n=g((()=>function(e){if(0==e.length)return null;let t=[];const s=new RegExp(/^[a-zA-Z]+[a-zA-Z0-9._]+$/);for(let l of e)if(l){if(!s.test(l))return null;t.push(l)}return t}(i.field.contains)?"select":i.field.encrypted?"input":i.field.html||i.field.max>300?"textarea":"input")),r=g((()=>{let e=[];for(let t of i.field.contains)e.push({key:t,value:t});return e})),h=g((()=>{let e={};return i.field.encrypted&&(e.type="password"),i.field.atts.readonly&&(e.readonly=!0),i.field.atts.placeholder&&(e.placeholder=field.meta.placeholder),i.field.atts.html&&(e["data-html"]=1),e}));return(i,f)=>"textarea"==_(n)&&"edit"==_(a)?e((t(),s("textarea",y({key:0},_(h),{name:l.field.name,"onUpdate:modelValue":f[0]||(f[0]=e=>l.field.change=e)}),null,16,_e)),[[u,l.field.change]]):"textarea"==_(n)&&"view"==_(a)?(t(),s("div",ge,p(l.field.val),1)):"select"==_(n)&&"filter"==_(a)?(t(),v(me,{key:2,field:l.field},null,8,["field"])):"select"==_(n)&&"edit"==_(a)?e((t(),s("select",y({key:3,"onUpdate:modelValue":f[1]||(f[1]=e=>l.field.change=e),name:l.field.name},_(h),{onBlur:f[2]||(f[2]=e=>l.field.validateon=!0)}),[ve,(t(!0),s(o,null,d(_(r),(e=>(t(),s("option",{key:e.key,value:e.key},p(e.value),9,be)))),128))],16,ye)),[[b,l.field.change]]):"edit"==_(a)?e((t(),s("input",y({key:4},_(h),{name:l.field.name,"onUpdate:modelValue":f[3]||(f[3]=e=>l.field.change=e),onBlur:f[4]||(f[4]=e=>l.field.validateon=!0)}),null,16,ke)),[[k,l.field.change]]):"filter"==_(a)?(t(),v(ne,{key:5,field:l.field},null,8,["field"])):"view"==_(a)&&l.field.reference?(t(),s("span",je,[j(ee,{route:{model:l.field.reference,key:l.field.val,state:"primary"}},{default:w((()=>[c(p(l.field.val),1)])),_:1},8,["route"])])):(t(),s("span",we,p(l.field.val),1))},__file:"presstojam/src/components/ptj-string.vue"};const Se=n({init:!1,login:!1,user:"public"}),Oe=n({cats:{},routes:[]});function Ce(){$.post("/core/logout").then((()=>{W()}))}function Pe(){$.get("/core/check-user").then((e=>{if(e.is_expired)return $.put("/core/switch-tokens").then((()=>{Pe()}));Se.init||(Se.user=e.user,Se.role=e.role,Se.init=!0)})).then((e=>{"public"!=Se.user&&setTimeout(Pe,6e5)})).catch((e=>{Se.login=!0}))}function Ae(){return Oe.cats={},Oe.routes=[],$.get("/nav/site-map").then((e=>{for(let t in e)for(let s in e[t]){const l={model:s,state:e[t][s].state};e[t][s].default&&(l.default=!0),l.route=s,Oe.routes.push(l),Oe.cats[t]||(Oe.cats[t]=[]),Oe.cats[t].push(l)}})).then((()=>(J.model||J.apply(function(){for(let e in Oe.cats)for(let t of Oe.cats[e])if(t.default)return t}()),!0))).catch((e=>{console.log(e)}))}const Ee={class:"ptj-slug-trail"};var Me={setup:e=>(e,l)=>(t(),s("div",Ee,[(t(!0),s(o,null,d(_(Y).slug,(e=>(t(),v(ee,{key:e.id,route:e.route},{default:w((()=>[c(p(e.model),1)])),_:2},1032,["route"])))),128))])),__file:"presstojam/src/components/ptj-slug-trail.vue"};class Te{constructor(e={}){this._handle=e.handle,this._drop_target=e.drop_target,this._drag_target=e.drag_target,this._call_back=e.callback,this._x=0,this._y=0,this._offset_x=0,this._offset_y=0,this._judder=e.judder?e.judder:5,this._drag_node,this._drop_node,this._tree=e.tree}isJudder(e,t){const s=e-this._x,l=t-this._y;return!(s<-5||s>5)&&!(l<-5||l>5)}getDirection(e,t){return{x:e==this._x?0:e>this._x?1:-1,y:t==this._y?0:t>this._y?1:-1}}offset(e){var t=e.getBoundingClientRect(),s=e.ownerDocument.defaultView;return{top:t.top+s.pageYOffset,left:t.left+s.pageXOffset}}insertAfter(){let e=this._drag_node.getAttribute("id"),t=this._drop_node.getAttribute("id"),s=0,l=0;if(this._drop_node.nextElementSibling){for(let e in this._tree){let i=this._tree[e];if(i.id==t){s=i.circular,l=i.sort;break}}for(let t in this._tree){let i=this._tree[t];i.id==e?(i.circular=s,i.sort=l+1):i.circular==s&&i.sort>l&&++i.sort}}else for(let t in this._tree){let l=this._tree[t];l.id==e&&(l.circular=s,l.sort=0)}}insertBefore(){let e=this._drag_node.getAttribute("id"),t=this._drop_node.getAttribute("id"),s=0,l=0;for(let e in this._tree){let i=this._tree[e];if(i.id==t){s=i.circular,l=i.sort,++i.sort;break}}for(let t in this._tree){let i=this._tree[t];i.id==e?(i.circular=s,i.sort=l):i.circular==s&&i.sort>l&&++i.sort}}dragStart(e){const t=e.target.closest("[id]");this._drag_node=t;const{top:s,left:l}=this.offset(t);e.dataTransfer.dropEffect="move",this._x=e.clientX,this._y=e.clientY,this._offset_x=e.clientX-l,this._offset_y=e.clientY-s}isDroppable(e){return!!e.target.closest(this._drop_target)}dragEnter(e){if(!this.isDroppable(e))return!0;if(e.preventDefault(),e.dataTransfer.dropEffect="move",this._drop_node=e.target.closest(this._drag_target),!this._drop_node||this._drop_node.getAttribute("id")==this._drag_node.getAttribute("id"))return;const t=this.getDirection(e.clientX,e.clientY);1==t.y?this.insertAfter():-1==t.y&&this.insertBefore(),this._x=e.clientX,this._y=e.clientY}dragOver(e){if(!this.isDroppable(e))return!0;e.preventDefault(),e.dataTransfer.dropEffect="move"}dragEnd(){this._drag_node&&this._drag_node.setAttribute("draggable",!1),this._drag_node=null}drop(e){if(!this._drop_node)return!0;e.preventDefault(),this._call_back&&this._call_back(this._tree)}}var Ue={initDD:function(e){let t=new Te(e);if(document.querySelectorAll(e.handle).forEach((e=>e.addAttribute("draggable",!0))),e.handle){document.querySelectorAll(e.handle).forEach((t=>{t.addEventListener("mousedown",(t=>{t.target.closest(e.drag_target).addAttribute("draggable",!0)}))}))}e.main.addEventListener("dragstart",(e=>t.dragStart(e))),e.main.addEventListener("dragenter",(e=>t.dragEnter(e))),e.main.addEventListener("dragover",(e=>t.dragOver(e))),e.main.addEventListener("drop",(e=>t.drop(e))),e.main.addEventListener("dragend",(e=>t.dragEnd(e)))}};const Ve=0,Ne=1,De=2,Re=3,Le=4;class Be{constructor(e,t=null){this._name=e,this._type="",this._atts={},this._confirm=!1,this._reference="",this._label="",this._store=n({summary:0,options:[]}),this._default_val=null,this._immutable=!1,this._encrypted=!1,this._min=null,this._max=null,this._contains=[],this._notcontains=[],this._recursive=!1,this._error={OK:0,MIN_VALUE:1,MAX_VALUE:2,HAS:3,HAS_NOT:4};if(Object.keys(this).forEach((e=>{"_store"!=e&&"_"==e[0]&&Object.defineProperty(this,e.substring(1),{get:function(){return this[e]},set:function(t){"_type"==e?this._type=t.toLowerCase():this[e]=t}})})),this.summary=g({get:()=>this._store.summary,set:e=>{this._store.summary=e?1:0}}),this.options=g({get:()=>this._store.options,set:e=>{this._store.options=e}}),t){for(let e in t)if("summary"==e)this.summary=t[e]?1:0;else{if("validation"==e)continue;"type"==e?this.type=t[e].toLowerCase():this["_"+e]=t[e]}this._min=t.validation.min,this._max=t.validation.max,t.validation.contains&&(this._contains=t.validation.contains.split("|")),t.validation.notcontains&&(this._notcontains=t.validation.notcontains.split("|"))}}getOption(e){for(let t of this._store.options)if(t.key==e)return t.value}setReferenceOptions(e,t){return this._store.options=[],$.get(e,t).then((e=>{for(let t in e){let s=e[t]["--id"],l=[];for(let s in e[t])"--id"!=s&&l.push(e[t][s]);this._store.options.push({key:s,value:l.join(" ",l)})}})).catch((e=>{console.log(e)}))}clean(e){return"checkbox"==this._type?e?1:0:e}calcValue(e){return e||""}validateSize(e){return e<this._min?Ne:e>this._max?De:Ve}validate(e){if(null===e)return;let t;if(isNaN(e)){const s=e?e.length:0;t=this.validateSize(s)}else t=this.validateSize(e);if(t!=Ve)return t;for(let t of this._notcontains)if(e.match(t))return Le;if(0==this._contains.length)return Ve;for(let t of this._contains)if(e.match(t))return Ve;return Re}}class Ie{constructor(){this._cells={},this._children={},this._states={},this._limit=0,this._page=0,this._sort={},this._groups=[],this._active=0,this._max_pages=0,this._count=0,this._limited_fields=[],this._init=!1,this._store=n({index:null});Object.keys(this).forEach((e=>{"_"==e[0]&&Object.defineProperty(this,e.substring(1),{get:function(){return this[e]},set:function(t){this[e]=t}})}))}addChild(e,t){this._children[e]=t}addState(e,t){this._actions[e]=t}convertToParams(){let e={};return this._limit&&(e._limit=this._limit),this._page&&(e._page=this._page),this._limited_fields.length>0&&(e._fields=this._limited_fields),Object.keys(this._sort).length>0&&(e._sort=this._sort),e}resetSummary(e){for(let e in this._cells)this._cells[e].summary=!1;for(let t in e)this._cells[e[t]]&&(this._cells[e[t]].summary=!0)}mapField(e,t){this._cells[e]=new Be(e,t),this._cells[e].recursive&&(this._store.index=e)}map(e,t=[]){if(t.length>0)for(let s of t)this.mapField(s,e[s]);else for(let t in e)this.mapField(t,e[t])}getCellByType(e){let t={};for(let s in this._cells)this._cells[s].type==e&&(t[s]=this._cells[s]);return t}applyMap(e){if("first"==e.key?this._limit=1:e.key&&(this._key=e.key),e.param_str){const t=JSON.parse(e.param_str);t._limit&&(this._limit=t._limit),t._fields&&(this._cells=t._fields),t.hasOwnProperty("_page")&&(this._page=t._page),t.hasOwnProperty("_sort")&&(this._sort=t._sort);for(const e in this._cells)t.hasOwnProperty(e)&&this._cells[e].setVal(t[e])}}applySettings(e){e.groups&&(this._groups=e.groups),e.limit&&(this._limit=e.limit)}}class ze{constructor(e){this._meta=e,this._store=n({value:null,change:null,display:null,error:0,is_validate_on:!1});const t=Object.getOwnPropertyNames(this._meta),s=Object.keys(this);t.forEach((e=>{"_"==e[0]||s.includes(e)||Object.defineProperty(this,e,{get:function(){return this._meta[e]},set:function(t){this._meta[e]=t}})})),this.error=g({get:()=>{this._store.error},set:e=>{this._store.error=e}}),this.showError=g((()=>!(!this._store.is_validate_on||!this._store.error))),this._meta.default_val?this._store.value=this._meta.default_val:"select"==this._meta.type&&(this._store.value=0),this.val=g({get:()=>this._store.value,set:e=>{this._store.value=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.change=g({get:()=>null==this._store.change?this._store.value:this._store.change,set:e=>{this._store.change=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.addParam=e=>{null!==this._store.value&&(e[this.name]=this._store.value)},"time"==this.type?(this.change1=g({get:()=>(null==this._store.change&&(this._store.change=this._store.value),this._store.change?this._store.change.min:""),set:e=>{this._store.change||(this._store.change={min:null,max:null}),this._store.change.min=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.change2=g({get:()=>(null==this._store.change&&(this._store.change=this._store.value),this._store.change?this._store.change.max:""),set:e=>{this._store.change||(this._store.change={min:null,max:null}),this._store.change.max=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.addAPIParam=e=>{null!=this._store.value&&(e[this.name]=this._store.value)}):"flag"==this.type?(this.change1=g({get:()=>(null==this._store.change&&(this._store.change=this._store.value),null==this._store.change?0:this._store.change?this._store.change:2),set:e=>{0!=e?(2==e&&(e=0),this._store.change=this._meta.clean(e),this._store.error=this._meta.validate(e)):this._store.change=null}}),this.addAPIParam=e=>{null!=this._store.value&&(e[this.name]=this._store.value)}):"id"==this.type?(this.change1=g({get:()=>(null==this._store.change&&(this._store.change=this._store.value),null==this._store.change?[]:this._store.change),set:e=>{null==this._store.change&&(this._store.change=[]),this._store.change.includes(e)||(this._store.change.push(this._meta.clean(e)),this._store.error=this._meta.validate(e))}}),this.addAPIParam=e=>{null!=this._store.value&&(e[this.name]=this._store.value)}):"number"==this.type?(this.change1=g({get:()=>(null==this._store.change&&(this._store.change=this._store.value),this._store.change?this._store.change.min:""),set:e=>{this._store.change||(this._store.change={min:null,max:null}),this._store.change.min=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.change2=g({get:()=>(null==this._store.change&&(this._store.change=this._store.value),this._store.change?this._store.change.max:""),set:e=>{this._store.change||(this._store.change={min:null,max:null}),this._store.change.max=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.addAPIParam=e=>{null!=this._store.value&&(e[this.name]=this._store.value)}):"string"==this.type&&(this.change=g({get:()=>null==this._store.change?"":this._store.change,set:e=>{this._store.change=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.change1=g({get:()=>(null==this._store.change&&(this._store.change=this._store.value),null==this._store.change?[]:this._store.change),set:e=>{null==this._store.change&&(this._store.change=[]),this._store.change.push(this._meta.clean(e)),this._store.error=this._meta.validate(e)}}),this.addAPIParam=e=>{if(null!=this._store.value){e[this.name]=[];for(let t in this._store.value)e[this.name].push("%"+this._store.value[t]+"%")}})}get meta(){return this._meta}set validateon(e){this._store.is_validate_on=e}set display(e){this._store.display=e}get display(){return this._store.display?this._store.display:this._store.value}get store(){return this._store}toString(){return this._store.display}isSummary(){return this._meta.summary}setReferenceOptions(e,t){this._meta.setReferenceOptions(e,t)}reset(){this._store.change=null}getOption(e){return"string"==this._meta.type?e:this._meta.getOption(e)}}class Fe{constructor(e){this._metarow=e,this._cells=n({}),this._children={},e&&this.applyMetaRow(e),this.cells=g((()=>this._cells))}set children(e){this._children=e}get children(){return this._children}get primary(){return this._cells["--id"]}get parent(){return this._cells["--parentid"]}clone(){const e=new Fe(this._metarow);let t={};for(let e in this._cells)t[e].val=this._cells[e].val;let s={};for(let t in e.children)s[t]=e.children[t].clone();return e.children=s,e}applyMetaRow(e){for(const t in e.cells){const s=e.cells[t];this._cells[s.name]=new ze(s)}for(const t in e.children)this._children[t]=e.children[t]}addChild(e,t){this._children[e]||(this._children[e]=[]),this._children[e].push(t)}set row(e){if(e){for(let t in this._cells)e.hasOwnProperty(t)&&(this._cells[t].val=e[t]);for(let t in this._children)this._children[t].row=e[t]}}getSummary(){let e=[];for(let t in this._cells){const s=this._cells[t];if(s.isSummary()){const t=s.display;e.push(t)}}return e.join(" ")}toString(){let e=[];for(let t in this._cells)e.push(this._cells[t].display);return e.join(" ")}serialize(e=!1){let t={};for(let s in this._cells)e?this._cells[s].change!=this._cells[s].val&&(t[s]=this._cells[s].change):null!=this._cells[s].change&&(t[s]=this._cells[s].change);return t}getCellByType(e){let t={};for(let s in this._cells)this._cells[s].type==e&&(t[s]=this._cells[s]);return t}clearErrors(){for(let e in this._cells)this._cells[e].error=0}reset(){for(let e in this._cells)this._cells[e].error=0,this._cells[e].change=null}setErrors(e){for(let t in e)0!==t.indexOf("__")&&this._cells[t]&&(this._cells[t].error=e[t])}convertToParams(){let e={};for(let t in this._cells)this._cells[t].addParam(e);return e}convertToAPIParams(){let e={};for(let t in this._cells)"asset"!=this._cells[t].type&&this._cells[t].addAPIParam(e);return e}applyChangeData(){for(let e in this._cells)this._cells[e].val=this._cells[e].change}}const $e=I.getModelSettings(J.model,J.state),Je=n({meta:new Ie,data:[],indexes:{},search:new Fe});function Xe(){Je.indexes={};for(const e in Je.data){let t=Je.data[e].cells[Je.meta.store.index].val;Je.indexes[t]||(Je.indexes[t]=[]),Je.indexes[t].push(e)}}function qe(e){Je.data=[];for(const t in e){let s=new Fe(Je.meta);s.row=e[t],Je.data.push(s)}}$e.fields&&(Je.meta.limited_fields=$e.fields);const Ye=async()=>{let e={...Je.meta.convertToParams(),...Je.search.convertToParams()};Je.meta=new Ie,Je.data=[],Je.indexes={},Je.search=new Fe,e||(e={}),J.to&&(e.__to=J.to),J.key&&(e["--parentid"]=J.key),$e.fields&&(e.__fields=$e.fields);let t="/"+J.route+"/"+J.model;return"parent"==J.state&&(t+="/parent"),$.get("/route"+t,e).then((e=>{Je.meta.map(e.fields,$e.fields),Je.meta.applyMap(J),Je.meta.applyMap($e),Je.search.applyMetaRow(Je.meta),Je.search.row=J.params,Je.meta.init=!0})).then((()=>(e={...e,...Je.search.convertToAPIParams()},Je.meta.limit>0?$.get("/data"+t+"/count",e).then((e=>{Je.meta.count=e.count,Je.meta.max_pages=Math.ceil(e.count/Je.meta.limit)})).then((()=>$.get("/data"+t,e))).then((e=>(qe(e),Je.meta.store.index&&Xe(),e))):$.get("/data"+t,e).then((e=>(qe(e),Je.meta.store.index&&Xe(),e)))))).catch((e=>console.log(e)))},He=e=>(h("data-v-1dcaa9f5"),e=e(),f(),e),Ke=["id"],We={class:"ptj-tree-node-row"},Ze=[He((()=>l("span",{class:"material-icons"},"subdirectory_arrow_right",-1)))],Ge=[He((()=>l("span",{class:"material-icons"},"keyboard_arrow_right",-1)))],Qe={key:0},et=[He((()=>l("span",{class:"material-icons"},"drag_handle",-1)))],tt=He((()=>l("span",{class:"material-icons"},"arrow_forward_ios",-1)));var st={props:{row:{type:[String,Number],required:!0},draggable:Boolean,ischild:{type:Boolean,default:!1}},setup(i){const r=i,c=n({toggle_state:{},branch:null});function u(){const e=c.branch.primary.val;c.toggle_state[e]=!c.toggle_state[e]}const h=g((()=>{if(!c.branch)return[];const e=c.branch.primary.val;return Je.indexes[e]?Je.indexes[e]:[]})),f=g((()=>c.branch?c.branch.primary.val:0)),y=g((()=>c.branch?c.branch.getSummary():""));return m((()=>{c.branch=Je.data[r.row]})),(n,r)=>{const m=x("ptj-tree-node",!0);return t(),s("div",{class:"ptj-tree-node ptj-draggable",id:_(f),draggable:"false"},[l("div",We,[l("div",null,[i.ischild?(t(),s("a",{key:0,"data-action":"more",class:"button",onClick:r[0]||(r[0]=S((e=>u()),["prevent","stop"]))},Ze)):(t(),s("a",{key:1,"data-action":"more",class:"button",onClick:r[1]||(r[1]=S((e=>u()),["prevent","stop"]))},Ge))]),_(Je).meta.sortable?(t(),s("div",Qe,[l("a",{"data-action":"more",class:"button",onClick:r[2]||(r[2]=(...e)=>n.prevent.stop&&n.prevent.stop(...e)),onMousedown:r[3]||(r[3]=(...e)=>n.setDraggable&&n.setDraggable(...e)),onMouseup:r[4]||(r[4]=(...e)=>n.endDraggable&&n.endDraggable(...e))},et,32)])):O("v-if",!0),l("div",null,p(_(y)),1),j(ee,{route:{state:"primary",key:_(f)}},{default:w((()=>[tt])),_:1},8,["route"])]),(t(!0),s(o,null,d(_(h),((s,l)=>e((t(),v(m,{row:s,ischild:!0,key:l},null,8,["row"])),[[a,_(c).toggle_state[_(f)]]]))),128))],8,Ke)}}};re("\n.model-tree.branch[data-v-1dcaa9f5] {\r\n  padding-left: 8px;\r\n  padding-right: 8px;\r\n  margin: 6px 0;\r\n  background-color:#111111;\n}\n.tree .ide-block[data-v-1dcaa9f5] {\r\n\tdisplay : none;\n}\n.dragArea[data-v-1dcaa9f5] {\r\n  min-height: 50px;\r\n  outline: 1px solid #777777;\n}\r\n\r\n\r\n"),st.__scopeId="data-v-1dcaa9f5",st.__file="presstojam/src/components/ptj-tree-node.vue";const lt={class:"ptj-tree ptj-drop-target'",ref:"treeroot"};var it={setup(e){function l(){}return m((()=>{Je.meta.sortable&&Ue.initDD({handle:".ptj-drag-handle",drag_target:".ptj-draggable",drop_target:".ptj-drop-target",callback:l})})),(e,l)=>(t(),s("div",lt,[(t(!0),s(o,null,d(_(Je).indexes[0],((e,s)=>(t(),v(st,{key:s,row:e},null,8,["row"])))),128))],512))},__file:"presstojam/src/components/ptj-tree.vue"};const at=["name"],nt={key:1},rt=["name"],ot=c(" - "),dt=["name"],ct={key:2};var pt={props:{field:Object,type:{type:String,default:"view"}},setup:i=>(a,n)=>"edit"==i.type?e((t(),s("input",y({key:0,class:"ptj-form-number",name:i.field.name,type:"number","onUpdate:modelValue":n[0]||(n[0]=e=>i.field.change=e)},i.field.atts,{onBlur:n[1]||(n[1]=e=>i.field.validateon=!0)}),null,16,at)),[[u,i.field.change]]):"filter"==i.type?(t(),s("div",nt,[e(l("input",y({class:"ptj-form-filter-number ptj-min",name:i.field.name,type:"number","onUpdate:modelValue":n[2]||(n[2]=e=>i.field.change1=e)},i.field.atts,{onBlur:n[3]||(n[3]=e=>i.field.validateon=!0)}),null,16,rt),[[u,i.field.change1]]),ot,e(l("input",y({class:"ptj-form-filter-number ptj-max",name:i.field.name,type:"number","onUpdate:modelValue":n[4]||(n[4]=e=>i.field.change2=e)},i.field.atts,{onBlur:n[5]||(n[5]=e=>i.field.validateon=!0)}),null,16,dt),[[u,i.field.change2]])])):(t(),s("span",ct,p(i.field.val),1)),__file:"presstojam/src/components/ptj-number.vue"};const ut=["name"],ht=["name"],ft=[l("option",{value:0},p("All"),-1),l("option",{value:1},p("Checked"),-1),l("option",{value:2},p("Unchecked"),-1)],mt={class:"material-icons"};var _t={props:{field:Object,type:{type:String,default:"view"}},setup(i){const a=i;let n=g((()=>"edit"==a.type&&a.field.immutable?"view":a.type));let r=g((()=>1==a.field.val?"check_circle_outline":"highlight_off"));return(o,d)=>"edit"==_(n)?e((t(),s("input",{key:0,class:"ptj-checkbox",type:"checkbox","true-value":1,"false-value":0,name:i.field.name,"onUpdate:modelValue":d[0]||(d[0]=e=>i.field.change=e)},null,8,ut)),[[C,i.field.change]]):"filter"==_(n)?e((t(),s("select",{key:1,name:i.field.name,"onUpdate:modelValue":d[1]||(d[1]=e=>i.field.change1=e),class:"ptj-filter-form-checkbox"},ft,8,ht)),[[b,i.field.change1]]):(t(),s("a",{key:2,onClick:d[2]||(d[2]=e=>function(){let e={};return e["--id"]=J.key,e[a.field.name]=1==a.field.val?0:1,J.key&&(e["--id"]=J.key),$.put("/data/"+J.route+"/"+J.model,e).then((()=>{a.field.val=1==a.field.val?0:1})).catch((e=>{console.log(e)}))}())},[l("span",mt,p(_(r)),1)]))},__file:"presstojam/src/components/ptj-flag.vue"};const gt=["name"],yt=l("option",{value:"0",selected:""},"Select Option",-1),vt=["value"],bt={key:2};var kt={props:{field:Object,type:{default:"view",type:String}},setup(l){const i=l;let a=g((()=>"edit"==i.type&&i.field.immutable?"view":i.type));return g((()=>i.field.options)),(i,n)=>"edit"==_(a)?e((t(),s("select",y({key:0,"onUpdate:modelValue":n[0]||(n[0]=e=>l.field.change=e)},l.field.atts,{name:l.field.name,onBlur:n[1]||(n[1]=e=>l.field.validateon=!0)}),[yt,(t(!0),s(o,null,d(l.field.options,(e=>(t(),s("option",{key:e.key,value:e.key},p(e.value),9,vt)))),128))],16,gt)),[[b,l.field.change]]):"filter"==_(a)?(t(),v(me,{key:1,field:l.field},null,8,["field"])):(t(),s("span",bt,p(l.field.getOption(l.field.val)),1))},__file:"presstojam/src/components/ptj-id.vue"};const jt=["name"],wt={key:1},xt=["name"],St=c(" - "),Ot=["name"],Ct={key:2};var Pt={props:{field:Object,type:{default:"view",type:String}},setup(i){const a=i;let n=g((()=>"edit"==a.type&&a.field.immutable?"view":a.type));return(a,r)=>"edit"==_(n)?e((t(),s("input",y({key:0,name:i.field.name,type:"datetime-local","onUpdate:modelValue":r[0]||(r[0]=e=>i.field.change=e)},i.field.atts,{onBlur:r[1]||(r[1]=e=>i.field.validateon=!0)}),null,16,jt)),[[u,i.field.change]]):"filter"==_(n)?(t(),s("div",wt,[e(l("input",y({type:"datetime-local",name:i.field.name+"min"},i.field.atts,{"onUpdate:modelValue":r[2]||(r[2]=e=>i.field.change1=e)}),null,16,xt),[[u,i.field.change1]]),St,e(l("input",y({type:"datetime-local",name:i.field.name+"max"},i.field.atts,{"onUpdate:modelValue":r[3]||(r[3]=e=>i.field.change2=e)}),null,16,Ot),[[u,i.field.change2]])])):(t(),s("span",Ct,p(i.field.val),1))},__file:"presstojam/src/components/ptj-time.vue"};const At=["name"],Et={key:1};var Mt={props:{field:Object,type:{type:String,default:"view"}},setup:e=>(l,i)=>"edit"==e.type?(t(),s("input",{key:0,class:"ptj-form-asset",ref:"input",onChange:i[0]||(i[0]=(...e)=>l.setFile&&l.setFile(...e)),name:e.field.meta.name,type:"file"},null,40,At)):(t(),s("span",Et,p(e.field.val),1)),__file:"presstojam/src/components/ptj-asset.vue"};const Tt=e=>(h("data-v-15ab9672"),e=e(),f(),e),Ut={class:"ptj-table-header"},Vt=["onClick"],Nt={key:0,class:"material-icons"},Dt={key:1,class:"material-icons"},Rt=Tt((()=>l("th",{class:"ptj-actions"}," ",-1))),Lt={class:"ptj-actions"},Bt=Tt((()=>l("span",{class:"material-icons"},"arrow_forward_ios",-1)));var It={setup(i){let r=n({name:"",dir:""});return(i,n)=>(t(),s("table",{class:P(["ptj-table",Map.model])},[l("thead",null,[l("tr",Ut,[(t(!0),s(o,null,d(_(Je).meta.cells,(l=>e((t(),s("th",{key:l.name,class:P(["ptj-table-header-cell",l.name]),onClick:e=>{!function(e){if(Je.meta.pages>0){r.dir=!r.name!=e||"desc"==r.dir?"asc":"desc",r.name=e;let t=[];t[r.name]=r.dir,Je.meta.sort=t,load()}else r.name!=e||"desc"==r.dir?(Je.data.sort((function(t,s){let l=t.getCell(e).toVal(),i=s.getCell(e).toVal();return l<i?-1:l>i?1:0})),r.name=e,r.dir="asc"):(Je.data.sort((function(t,s){let l=t.getCell(e).toVal(),i=s.getCell(e).toVal();return l<i?1:l>i?-1:0})),r.name=e,r.dir="desc")}(l.name)}},[c(p(l.label)+" ",1),_(r).name==l.name&&"asc"==_(r).dir?(t(),s("span",Nt,"keyboard_arrow_up")):O("v-if",!0),_(r).name==l.name&&"desc"==_(r).dir?(t(),s("span",Dt,"keyboard_arrow_down")):O("v-if",!0)],10,Vt)),[[a,l.summary]]))),128)),Rt])]),l("tbody",null,[(t(!0),s(o,null,d(_(Je).data,((i,n)=>(t(),s("tr",{key:n,class:"ptj-table-row"},[(t(!0),s(o,null,d(i.cells,((l,i)=>e((t(),s("td",{key:i,class:P(["ptj-table-cell",l.meta.name])},["asset"==l.type?(t(),v(Mt,{key:0,field:l},null,8,["field"])):"number"==l.type?(t(),v(pt,{key:1,field:l},null,8,["field"])):"flag"==l.type?(t(),v(_t,{key:2,field:l},null,8,["field"])):"id"==l.type?(t(),v(kt,{key:3,field:l},null,8,["field"])):"time"==l.type?(t(),v(Pt,{key:4,field:l},null,8,["field"])):"string"==l.type?(t(),v(xe,{key:5,field:l},null,8,["field"])):O("v-if",!0)],2)),[[a,l.summary]]))),128)),l("td",Lt,[j(ee,{route:{state:"primary",key:i.cells["--id"].val}},{default:w((()=>[Bt])),_:2},1032,["route"])])])))),128))])],2))}};re("\n.table[data-v-15ab9672], .thead[data-v-15ab9672], .tbody[data-v-15ab9672], .tr[data-v-15ab9672] {\r\n    width : 100%;\n}\r\n\r\n\r\n"),It.__scopeId="data-v-15ab9672",It.__file="presstojam/src/components/ptj-table.vue";var zt={setup(e){A("data"),A("indexes");const i=g((()=>{let e=[];for(let t in indexes)e=this.getCombinations(t,indexes[t],e);return e}));return(e,a)=>(t(!0),s(o,null,d(_(i),((i,a)=>(t(),s("div",{key:a},[l("h3",null,[(t(!0),s(o,null,d(i.tags,((e,l)=>(t(),s("span",{key:l},p(e)+" ",1)))),128))]),l("ul",null,[(t(!0),s(o,null,d(i.data,(l=>(t(),s("li",{key:l},[j(ee,{route:e.route},{default:w((()=>[c(p(e.data[l].getSummary()),1)])),_:2},1032,["route"])])))),128))])])))),128))},__file:"presstojam/src/components/ptj-list.vue"};const Ft={class:"ptj-error"};var $t={props:{error:[Number,String,Object]},setup:e=>(l,i)=>(t(),s("p",Ft,p(e.error),1))};re("\n.ptj-error {\r\n  color : red;\n}\r\n"),$t.__file="presstojam/src/components/ptj-error.vue";const Jt={class:"ptj-form-label"};var Xt={props:{field:[Object,Function]},setup:n=>(r,o)=>(t(),s("div",{class:P(["ptj-form-row",n.field.name])},[l("label",Jt,p(_(q)(n.field.name,"label",n.field.label)),1),i(r.$slots,"default"),e(j($t,{error:n.field.error},null,8,["error"]),[[a,n.field.showError]])],2)),__file:"presstojam/src/components/ptj-form-row.vue"};const qt={class:"ptj-widget-window"},Yt={class:"ptj-widget-window-header"},Ht={class:"ptj-widget-window-title"},Kt=[l("span",{class:"material-icons"},"more_horiz",-1)],Wt={class:"ptj-widget-window-body"};var Zt={props:{title:String,active:{type:Boolean,default:!1}},setup(n){let o=r(!1);function d(){o.value=!o.value}return(r,u)=>(t(),s("div",qt,[l("div",Yt,[l("h1",Ht,[c(p(n.title)+" ",1),l("a",{class:"ptj-widget-window-toggle",onClick:d},Kt)])]),e(l("div",Wt,[i(r.$slots,"default",{toggleWidget:d})],512),[[a,_(o)]])]))},__file:"presstojam/src/components/ptj-widget.vue"};const Gt=["onSubmit"],Qt=["onClick"],es=["onClick"];var ts={setup(i){function n(){Je.search.applyChangeData(),J.params=Je.search.convertToParams(),G(),Ye()}return(i,r)=>(t(),v(Zt,{title:"search"},{default:w((i=>[l("form",{onSubmit:S(n,["prevent"]),class:"ptj-filter-form"},[(t(!0),s(o,null,d(_(Je).search.cells,(s=>e((t(),v(Xt,{key:s.name,field:s},{default:w((()=>["id"==s.type?(t(),v(kt,{key:0,type:"filter",field:s},null,8,["field"])):"flag"==s.type?(t(),v(_t,{key:1,type:"filter",field:s},null,8,["field"])):"number"==s.type?(t(),v(pt,{key:2,type:"filter",field:s},null,8,["field"])):"time"==s.type?(t(),v(Pt,{key:3,type:"filter",field:s},null,8,["field"])):"string"==s.type?(t(),v(xe,{key:4,type:"filter",field:s},null,8,["field"])):O("v-if",!0),l("a",{onClick:e=>s.reset()},"x",8,Qt)])),_:2},1032,["field"])),[[a,"id"!=s.type||Object.keys(s.options).length>0]]))),128)),l("input",{type:"submit",value:"Submit",class:"ptj-filter-form-submit",onClick:i.toggleWidget},null,8,es)],40,Gt)])),_:1}))}};re("\n.error[data-v-71ada21d] {\r\n  color : red;\n}\r\n\r\n"),ts.__scopeId="data-v-71ada21d",ts.__file="presstojam/src/components/ptj-filter-form.vue";const ss=["onUpdate:modelValue"],ls={class:"ptj-selectfields-label"};var is={setup:i=>(i,a)=>(t(),v(Zt,{title:"select fields",class:"ptj-selectfields"},{default:w((()=>[(t(!0),s(o,null,d(_(Je).meta.cells,((i,a)=>(t(),s("div",{key:a},[e(l("input",{type:"checkbox","onUpdate:modelValue":e=>i.summary=e,"true-value":1,"false-value":0,class:"ptj-selectfields-checkbox"},null,8,ss),[[C,i.summary]]),l("label",ls,p(_(q)(i.name,"label",i.name)),1)])))),128))])),_:1})),__file:"presstojam/src/components/ptj-selectfields.vue"};const as={class:"ptj-pagination"},ns=["onClick"];var rs={props:{data_template:Object},setup(e){const l=e;function i(e){return e-1==l.data_template.page?"ptj-pagination-active":""}return(l,a)=>(t(),s("div",as,[(t(!0),s(o,null,d(e.data_template.max_pages,(e=>(t(),s("a",{key:e,onClick:t=>l.$emit("setPage",e-1),class:P(i(e))},p(e),11,ns)))),128))]))},__file:"presstojam/src/components/ptj-pagination.vue"};const os={class:"ptj-progress-bar-wrapper"},ds={class:"ptj-progress-holder"};var cs={props:{total:Number,progress:Number},setup(e){const i=e,a=g((()=>{let e=Math.floor(i.progress/i.total*100);return isNaN(e)?0:e}));return(e,i)=>(t(),s("div",os,[l("div",ds,[l("div",{class:"ptj-progress-bar",style:E("width:"+_(a)+"px")}," ",4)]),l("span",null,p(_(a))+"%",1)]))}};re("\n.ptj-progress-holder[data-v-460b10ff] {\r\n     width : 100%;\r\n     min-height : 10px;\r\n     position : relative;\r\n     display : flex;\r\n     align-items: stretch;\r\n     padding : 2px;\n}\n.ptj-progress-bar[data-v-460b10ff] {\r\n     width : 0;\r\n     height : 100%;\r\n     position : relative;\r\n     line-height : 100%;\n}\r\n\r\n\r\n"),cs.__scopeId="data-v-460b10ff",cs.__file="presstojam/src/components/ptj-progress-bar.vue";const ps=["onSubmit"],us=l("input",{type:"submit",value:"Submit",class:"ptj-form-submit"},null,-1);var hs={emits:["close"],setup(i,{emit:c}){let u=r("");I.getModelSettings(J.model,J.state);const h=n(new Fe),f=n({total:0,progress:0});let g=0;function y(){g=f.total>0?1:2,h.clearErrors();let e=h.serialize();return J.key&&(e["--parentid"]=J.key),$.post("/data/"+J.route+"/"+J.model,e).then((e=>{let t=[],s=h.getCellByType("asset");f.total=0;for(let l in s){if(!s[l].val)continue;++f.total;const i=new Asset;i.url="/asset/"+J.model+"/"+l+"/"+e["--id"];let a=i.saveFile(s[l].val).then((()=>{++f.progress}));t.push(a)}return Promise.all(t)})).then((()=>{h.reset(),Ye(),c("close")})).catch((e=>{console.log(e),g=0,"string"==typeof e?u=e:h.setErrors(e)}))}return m((async()=>{await(async()=>$.post("/route/"+J.route+"/"+J.model).then((e=>{const t=new Ie;t.map(e.fields),h.applyMetaRow(t);let s=[];for(let e in t.cells)if("id"==t.cells[e].type&&t.cells[e].reference){let l="/reference/"+J.model+"/"+e;s.push(t.cells[e].setReferenceOptions(l,{"--parentid":J.key}))}return Promise.all(s)})).catch((e=>console.log(e))))()})),(i,n)=>e((t(),s("form",{onSubmit:S(y,["prevent"]),class:P(["ptj-form",J.model+" "+J.state])},[e(l("div",{class:"ptj-form-error"},p(_(u)),513),[[a,_(u)]]),(t(!0),s(o,null,d(_(h).cells,(e=>(t(),v(Xt,{key:e.name,field:e},{default:w((()=>["asset"==e.type?(t(),v(Mt,{key:0,type:"edit",field:e},null,8,["field"])):"number"==e.type?(t(),v(pt,{key:1,type:"edit",field:e},null,8,["field"])):"flag"==e.type?(t(),v(_t,{key:2,type:"edit",field:e},null,8,["field"])):"id"==e.type?(t(),v(kt,{key:3,type:"edit",field:e},null,8,["field"])):"time"==e.type?(t(),v(Pt,{key:4,type:"edit",field:e},null,8,["field"])):"string"==e.type?(t(),v(xe,{key:5,type:"edit",field:e},null,8,["field"])):O("v-if",!0)])),_:2},1032,["field"])))),128)),us,e(j(cs,{total:_(f).total,progress:_(f).progress},null,8,["total","progress"]),[[a,1==_(g)]])],42,ps)),[[a,0==_(g)]])},__file:"presstojam/src/components/ptj-create-form.vue"},fs={setup(e){const i=I.getModelSettings(Map.model,Map.state),a=r(!1),n=g((()=>i.component?i.component:Je.meta.cells?Je.meta.store.index||Je.meta.children.length>0?"tree":"table":""));function o(){a.value=!a.value}return m((async()=>{await Ye()})),(e,r)=>(t(),s("div",{class:P([Map.model,Map.state])},[l("button",{onClick:r[0]||(r[0]=e=>o())},"Create"),j(L,{active:a.value,onClose:r[2]||(r[2]=e=>o())},{default:w((()=>[j(hs,{onClose:r[1]||(r[1]=e=>o())})])),_:1},8,["active"]),1!=_(i).disable_filter?(t(),v(ts,{key:0})):O("v-if",!0),1!=_(i).disable_selectfields?(t(),v(is,{key:1})):O("v-if",!0),"tree"==_(n)?(t(),v(it,{key:2})):"list"==_(n)?(t(),v(zt,{key:3})):"table"==_(n)?(t(),v(It,{key:4})):O("v-if",!0),_(Je).meta.limit>0?(t(),v(rs,{key:5})):O("v-if",!0)],2))}};re("\n.table[data-v-1c7fb47e], .thead[data-v-1c7fb47e], .tbody[data-v-1c7fb47e], .tr[data-v-1c7fb47e] {\r\n    width : 100%;\n}\r\n\r\n"),fs.__scopeId="data-v-1c7fb47e",fs.__file="presstojam/src/components/ptj-repo.vue";const ms=["placeholder"],_s=["disabled"];var gs={props:{check_str:{type:String,default:"delete"},parentid:{default:0}},emits:["close"],setup(i,{emit:a}){const n=i;let d=r(""),c=r(!0);function h(){c.value=d.value!=n.check_str}function f(){$.delete("/data/"+J.route+"/"+J.model,{"--id":J.key}).then((e=>{J.state="parent",J.key=n.parentid.val,Z()})).catch((e=>console.log(e)))}return(a,n)=>(t(),s(o,null,[l("p",null,"Are you sure you want to permanently delete this record? Type "+p(i.check_str)+" in the box below to continue.",1),e(l("input",{type:"text",placeholder:i.check_str,onKeyup:h,"onUpdate:modelValue":n[0]||(n[0]=e=>M(d)?d.value=e:d=e)},null,40,ms),[[u,_(d)]]),l("button",{disabled:_(c),onClick:f},"Delete",8,_s)],64))},__file:"presstojam/src/components/ptj-delete.vue"};const ys={class:"ptj-children"};var vs={setup(e){const i=I.getModelSettings(J.model,J.state),a=n({data:new Fe,fstate:0,type:"view",show_def:!1,progress:{total:0,progress:0}});let u=r(!1);function h(){a.type="view"==a.type?"edit":"view"}let f=g((()=>"edit"==a.type?"view":"edit"));function y(){u.value=!u.value}function b(){a.fstate=a.progress.total>0?1:2,a.data.clearErrors();let e=a.data.serialize(!0);if(0!=Object.keys(e).length)return e["--id"]=J.key,$.put("/data/"+J.route+"/"+J.model,e).then((e=>{let t=[],s=a.data.getCellByType("asset");a.progress.total=0;for(let l in s){if(!s[l].val)continue;++a.progress.total;const i=new Asset;i.url="/asset/"+J.model+"/"+l+"/"+e["--id"];let n=i.saveFile(s[l].val).then((()=>{++a.progress.progress}));t.push(n)}return Promise.all(t)})).then((()=>{for(let e in a.data.cells)a.data.cells[e].val=a.data.cells[e].change})).then((()=>{h()})).catch((e=>{a.fstate=0,"string"==typeof e?globalerror=e:a.data.setErrors(e)}));h()}return m((async()=>{await(async()=>{let e={};return J.to&&(e.__to=J.to),J.key&&(e["--id"]=J.key),i.fields&&(e.__fields=i.fields),$.get("/route/"+J.route+"/"+J.model+"/primary",e).then((e=>{const t=new Ie;t.map(e.fields,i.fields),a.data.applyMetaRow(t)})).then((()=>$.get("/data/"+J.route+"/"+J.model+"/primary",e))).then((e=>{a.data.row=e;for(let e in a.data.cells)a.data.cells[e].change=a.data.cells[e].val})).then((e=>{for(let e in a.data.cells)if("id"==a.data.cells[e].type&&a.data.cells[e].reference){let t="/reference/"+J.model+"/"+e;a.data.cells[e].setReferenceOptions(t,{"--id":J.key})}})).catch((e=>console.log(e)))})()})),(e,i)=>(t(),s(o,null,[_(Y).route.perms.includes("put")?(t(),s("button",{key:0,onClick:h},p(_(f)),1)):O("v-if",!0),_(Y).route.perms.includes("delete")?(t(),s("button",{key:1,onClick:y},"Delete")):O("v-if",!0),j(L,{active:_(u),onClose:i[1]||(i[1]=e=>y())},{default:w((()=>[j(gs,{parentid:_(a).data.parent,onClose:i[0]||(i[0]=e=>y())},null,8,["parentid"])])),_:1},8,["active"]),l("div",{class:P(["ptj-primary",J.model])},[(t(!0),s(o,null,d(_(a).data.cells,(e=>(t(),v(Xt,{key:e.name,field:e},{default:w((()=>["asset"==e.meta.type?(t(),v(Mt,{key:0,type:_(a).type,field:e},null,8,["type","field"])):"number"==e.meta.type?(t(),v(pt,{key:1,type:_(a).type,field:e},null,8,["type","field"])):"flag"==e.meta.type?(t(),v(_t,{key:2,type:_(a).type,field:e},null,8,["type","field"])):"id"==e.meta.type?(t(),v(kt,{key:3,type:_(a).type,field:e},null,8,["type","field"])):"time"==e.meta.type?(t(),v(Pt,{key:4,type:_(a).type,field:e},null,8,["type","field"])):"string"==e.meta.type?(t(),v(xe,{key:5,type:_(a).type,field:e},null,8,["type","field"])):O("v-if",!0)])),_:2},1032,["field"])))),128)),"edit"==_(a).type?(t(),s("input",{key:0,type:"submit",value:"Submit",class:"ptj-form-submit",onClick:b})):O("v-if",!0)],2),l("div",ys,[(t(!0),s(o,null,d(_(Y).route.children,(e=>(t(),v(ee,{key:e,route:{model:e,state:"parent"}},{default:w((()=>[c(p(e),1)])),_:2},1032,["route"])))),128))])],64))},__file:"presstojam/src/components/ptj-primary.vue"};const bs={class:"ptj-account-handler"},ks=["onSubmit"],js=l("input",{type:"submit",value:"Submit",class:"ptj-form-submit"},null,-1),ws=["onSubmit"],xs=l("input",{type:"submit",value:"Submit",class:"ptj-form-submit"},null,-1);var Ss={props:{actions:[]},setup(i){const r=n({state:"login",active:!0,login_data:new Fe,register_data:new Fe,globalerror:""});function c(){return r.active=!1,r.globalerror="","login"==r.state?$.post("/data/"+J.route+"/"+J.model+"/login",r.login_data.serialize("login")).then((e=>{W()})).catch((e=>{r.globalerror="Incorrect username / password"})):$.post("/data/"+J.route+"/"+J.model,r.register_data.serialize("post")).then((e=>{W()})).catch((e=>{r.register_data.applyErrors(e)}))}return $.post("/route/"+J.route+"/"+J.model).then((e=>{let t=new Ie;t.map(e.fields),r.register_data.applyMetaRow(t)})),$.post("/route/"+J.route+"/"+J.model+"/login").then((e=>{let t=new Ie;t.map(e.fields),r.login_data.applyMetaRow(t)})),(i,n)=>(t(),s("div",bs,[e(l("form",{onSubmit:S(c,["prevent"]),class:"ptj-login"},[e(l("div",{class:"ptj-form-error"},p(_(r).globalerror),513),[[a,_(r).globalerror]]),(t(!0),s(o,null,d(_(r).login_data.cells,(e=>(t(),v(Xt,{key:e.meta.name,field:e},{default:w((()=>[j(xe,{type:"edit",field:e},null,8,["field"])])),_:2},1032,["field"])))),128)),js],40,ks),[[a,"login"==_(r).state]]),e(l("form",{onSubmit:S(c,["prevent"]),class:"ptj-register"},[e(l("div",{class:"ptj-form-error"},p(_(r).globalerror),513),[[a,_(r).globalerror]]),(t(!0),s(o,null,d(_(r).register_data.cells,(e=>(t(),v(Xt,{key:e.meta.name,field:e},{default:w((()=>["number"==e.meta.type?(t(),v(pt,{key:0,type:"edit",field:e},null,8,["field"])):"flag"==e.meta.type?(t(),v(_t,{key:1,type:"edit",field:e},null,8,["field"])):"time"==e.meta.type?(t(),v(Pt,{key:2,type:"edit",field:e},null,8,["field"])):"string"==e.meta.type?(t(),v(xe,{key:3,type:"edit",field:e},null,8,["field"])):O("v-if",!0)])),_:2},1032,["field"])))),128)),xs],40,ws),[[a,"create"==_(r).state]])]))},__file:"presstojam/src/components/ptj-account-handler.vue"};const Os=l("div",null,"Loading ...",-1);var Cs={setup(e){const i=g((()=>Y.component?"ptj-primary"==Y.component?vs:"ptj-repo"==Y.component?fs:"ptj-account-handler"==Y.component?Ss:void 0:null));return m((()=>{(function(){const e=I.getSettings("mapper");return e&&(J.base="/"+e.base.replace(/^\/+|\/+$/g,""),e.role),Promise.resolve()})().then((()=>(K(),H())))})),(e,a)=>(t(),s(o,null,[j(Me),(t(),v(T,null,{default:w((()=>[l("div",{class:P([Map.model,Map.state])},[l("h1",null,p(_(Y).title),1),_(i)?(t(),v(U(_(i)),{key:0})):O("v-if",!0)],2)])),fallback:w((()=>[Os])),_:1}))],64))},__file:"presstojam/src/components/ptj-router.vue"};const Ps={class:"ptj-nav"},As={key:0};var Es={setup:e=>(Pe(),(e,i)=>(t(),s(o,null,[(t(),v(V,{to:"#ptj-accountdetails"},["public"!=_(Se).user?(t(),s("a",{key:0,class:"ptj-account-details-logout",onClick:i[0]||(i[0]=(...e)=>_(Ce)&&_(Ce)(...e))},"Logout")):O("v-if",!0)])),l("div",Ps,[(t(!0),s(o,null,d(_(Oe).cats,((e,l)=>(t(),s("div",{key:l},[e.length>1?(t(),s("span",As,p(l),1)):O("v-if",!0),(t(!0),s(o,null,d(e,(e=>(t(),v(ee,{route:{route:e.route,model:e.model,state:e.state,key:0},key:e.route},{default:w((()=>[c(p(e.route),1)])),_:2},1032,["route"])))),128))])))),128))]),j(Cs),j(L,{active:_(Se).login},null,8,["active"])],64)))};function Ms(e,t){return I.regSettings(t),J.init(),Ae().then((()=>{const t=N(Es);return t.mount(e),t}))}function Ts(e,t){I.regSettings(t),J.init();const s=N(Cs);return s.mount(e),s}function Us(e){return I.regSettings(e),$}Es.__file="presstojam/src/components/ptj-user.vue";export{Us as getClient,Ms as runApp,Ts as runRoute};
//# sourceMappingURL=ptj.esm.js.map
