import{ref as t,reactive as e,computed as s,defineComponent as r,openBlock as i,createElementBlock as a,normalizeClass as o,toDisplayString as l,resolveComponent as n,createCommentVNode as p,withDirectives as h,createElementVNode as d,vModelDynamic as c,createVNode as u,vShow as f,Fragment as m,renderList as _,vModelSelect as g,vModelRadio as j,vModelCheckbox as b,vModelText as y,normalizeStyle as v,withModifiers as k,createBlock as C,createTextVNode as w,renderSlot as x,withCtx as S,pushScopeId as E,popScopeId as D,onMounted as O,resolveDynamicComponent as R,Teleport as A,createApp as U}from"vue";let L,I,z,N={},B={},P=!0;var V={regCustomHeader(t,e){N[t]=e},regStatusHandler(t,e){B[t]=e},setURL(t){L=t},regDebug(t){P=t},run:(t,e)=>(e.mode="cors",e.cache="no-cache",e.credentials="include",e["Content-Type"]="application/json",e.headers=N,fetch(L+t,e).then((t=>{if(I=t.status,z=t.ok,!B[t.status])return 401==t.status?t.status:t.json();B[t.status](t)})).then((s=>{if(!z)throw s;if(401==I){let s=e.method;return e.method="PUT",fetch(L+"/core-switch-tokens",e).then((r=>{if(r.ok)return e.method=s,fetch(L+t,e).then((t=>{if(401==t.status)throw new Error("Issue with refresh token");if(t.ok)return t.json()}))}))}return s})).catch((t=>{throw P&&console.log(t),t}))),setDebug:t=>(t?t.__debug=!0:t={__debug:!0},t),get(t,e){if(P&&(e=this.setDebug(e)),e){const s=new URLSearchParams;let r={};for(let t in e)Array.isArray(e[t])||"object"==typeof e[t]&&null!==e[t]?r[t]=e[t]:s.append(t,e[t]);r&&s.append("graph",JSON.stringify(r)),-1==t.indexOf("?")?t+="?":t+="&",t+=s.toString()}let s={method:"GET"};return this.run(t,s)},getprimary(t,e){return this.get(t,e)},post(t,e){P&&(e=this.setDebug(e));let s={method:"POST"};return s.body=JSON.stringify(e),this.run(t,s)},put(t,e){P&&(e=this.setDebug(e));let s={method:"PUT"};return s.body=JSON.stringify(e),this.run(t,s)},patch(t,e){P&&(e=this.setDebug(e));let s={method:"PATCH"};return s.body=JSON.stringify(e),this.run(t,s)},delete(t,e){P&&(e=this.setDebug(e));let s={method:"DELETE"};return s.body=JSON.stringify(e),this.run(t,s)}};const T={1:"too small",2:"too large",3:"contains incorrect characters",4:"doesn't contain required characters",5:"not unique"};var M={getError:function(t){return T[t]}};class F{constructor(){this._min,this._max,this._has=[],this._has_not=[],this._errors={OK:0,MIN_VALUE:1,MAX_VALUE:2,HAS:3,HAS_NOT:4}}set min(t){this._min=t}set max(t){this._max=t}set has(t){this._has.push(t)}set nothas(t){this._has_not.push(t)}validateSize(t){return t<this._min?this._errors.MIN_VALUE:t>this._max?this._errors.MAX_VALUE:this._errors.OK}validate(t){let e;if(isNaN(t)){const s=t?t.length:0;e=this.validateSize(s)}else e=this.validateSize(t);if(e!=this._errors.OK)return e;for(let e of this._has_not)if(t.match(e))return this._errors.HAS_NOT;if(0==this._has.length)return this._errors.OK;for(let e of this._has)if(t.match(this._has))return this._errors.OK;return this._errors.HAS}}class K{constructor(r,i=null){if(this._name=r,this._value=t(null),this._type,this._is_primary=!1,this._is_parent=!1,this._valid=1,this._atts={},this._confirm=!1,this._readonly=!1,this._placeholder="",this._conditions,this._link,this._reference,this._error=0,this._label="",this._on=t(!0),this._summary=!1,this._default=null,this._validator=new F,this._multiple,this._is_validate_on=!1,this._options=e([]),this._asset=null,this._display_value,this.val=s({get:()=>this._value.value,set:t=>{this._value.value="checkbox"==this._type?t?1:0:t,this._error=this.validate(t)}}),this.on=s({get:()=>this._on.value,set:t=>{this._on.value=t}}),i){for(let t in i)"field"!=t&&"validator"!=t&&(this[t]=i[t]);if(i.field)for(let t in i.field)this[t]=i.field[t];if(i.validation)for(let t in i.validation)this._validator[t]=i.validation[t]}}set confirm(t){this._confirm=t}set readonly(t){this._readonly=t}set placeholder(t){this._placeholder=t}set atts(t){this._atts=t}set default(t){this._default=t}set asset(t){this._asset=t}set conditions(t){this._conditions=t}set display_value(t){this._display_value=t}set link(t){this._link=t}set name(t){this._name=t}set type(t){this._type=t}set multiple(t){this._multiple=t}set is_primary(t){this._is_primary=t}set is_parent(t){this._is_parent=t}set reference(t){this._reference=t}set error(t){this._error=t}set label(t){this._label=t}set summary(t){this._summary=t}set validateon(t){this._is_validate_on=t}get name(){return this._name}get type(){return this._type}get options(){return this._options}get isprimary(){return this._is_primary}get required(){return this._min>0}get summary(){return this._summary}get display_value(){return this._display_value?this._display_value:this.val}get readonly(){return this._readonly}get placeholder(){return this._placeholder}get default(){return this._default}get atts(){return this._atts}get conditions(){return this._conditions}get link(){return this._link}get isparent(){return this._is_parent}get multiple(){return this._multiple}get confirm(){return this._confirm}get reference(){return this._reference}get error(){return this._error?isNaN(this._error)?this._error:M.getError(this._error):""}get showError(){return!(!this._is_validate_on||!this._error)}get label(){return this._label}saveAsset(t){if(this._asset){if(this.val)return this._asset.saveFile(this.val,t)}return Promise.resolve()}setOptions(t){if(this._options.length=0,this._reference)V.get(this._reference,t).then((t=>{for(let e in t.__data)0!==e.indexOf("__")&&this._options.push({key:t.__data[e].id,value:t.__data[e].value})})).catch((t=>{console.log(t)}));else try{for(let t of this._atts.options)this._options.push({key:t,value:t})}catch(t){console.log("options not set for ",this._name)}}clean(t){return"checkbox"==this._type?Boolean(t):t}validate(t){return this._validator.validate(t)}exp(){return{name:this._name,type:this._type,atts:this._atts}}calcValue(t){return t||""}}class q{constructor(){this._size=0,this._blob=null,this._uploaded=!1,this._chunk_size=0,this._url,this._key=0,this._key_field}set chunk_size(t){this._chunk_size=t}set blob(t){this._blob=t}set url(t){this._url=t}set key(t){this._key=t}set keyfield(t){this._key_field=t}get blob(){return this._blob}get size(){return this._size}get uploaded(){return this._uploaded}get chunk_size(){return this._chunk_size}get url(){return this._url}getChunk(t){const e=0==this._chunk_size?0:t*this._chunk_size;let s=0==this._chunk_size?this._size:(t+1)*this._chunk_size;s>this._size&&(s=this._size);const r=new DataView(this._blob,e,s-e);let i=[];for(let t=0,e=r.byteLength;t<e;++t)i.push(r.getInt8(t));return i.join("")}loadFile(t){let e={};return e[this._key_field]=t,V.get(this._url,e).catch((t=>{alert(t)}))}delFile(t){let e={};return e[this._key_field]=t,V.delete(this._url,e).catch((t=>{alert(t)}))}saveFile(t,e){return this._size=t.size,new Promise(((e,s)=>{const r=new FileReader;let i=this;r.onload=function(t){i.blob=t.target.result,e(r.result)},r.onerror=s,r.readAsArrayBuffer(t)})).then((()=>{let t=[],s=0==this.chunk_size?1:Math.ceil(this.size/this.chunk_size);for(let r=0;r<s;++r){const s={};s.__chunk=r,s.__blob=this.getChunk(r),s.id=e,t.push(V.put(this._url,s))}return Promise.all(t)}))}}class H{constructor(e=null,r=null){this._value=t(null),this._display=t(null),null!==e&&(this._value.value=e),null!==r&&(this._display.value=r),this.val=s((()=>this._value.value)),this.display=s((()=>this._display.value?this._display:this._value.value))}toString(){return this.display}}class J{constructor(){this._active_children=[],this._active_state,this._change_intention,this._children=[],this._circular,this._default_state,this._key_states={parent_key:null,primary_key:null},this._name,this._parent_key,this._primary_key,this._settings={},this._states={},this._main_model,this._to,this.store=e({fields:{},parent_models:[],label:"",title:"",data:[],component:"",rawcomponent:"",actions:[],next:null,index:"",primarykeyname:"",parentkeyname:"",circular:"",model:this._name,siblings:[],children:[],stage:0,groups:[],classes:""})}get name(){return this._name}get currentstate(){return this._active_state?this._active_state:this._default_state}get children(){return this._children}get siblings(){return this._siblings.length>1?this._siblings:[]}set state(t){this._active_state=t||this._default_state,this._change_intention=null,this.store.settings={fields:null},this._settings[this._active_state]&&(this.store.settings=this._settings[this._active_state]),this.applySettings(),this.loadState()}set groups(t){this.store.groups=t}get main_model(){return this._main_model}set main_model(t){this._main_model=t}get key(){return"post"==this._active_state||"get"==this._active_state?this._key_states.parent_key:this._key_states.primary_key}set to(t){this._to=t}set key(t){if("get"==this._active_state||"post"==this._active_state?this._key_states.parent_key=t:this._key_states.primary_key=t,"post"==this._active_state||"put"==this._active_state)for(let t in this.store.fields)this.store.fields[t].on&&"select"==this.store.fields[t].type&&this.store.fields[t].setOptions(this.params)}set stage(t){this.store.stage=t}set name(t){this._name=t}set change_intention(t){this._change_intention=t}injectCustomSettings(t){this._settings=t}snakeCase(t){return t.replace("-","_")}get loadurl(){let t="/"+this._name;return"getprimary"!=this._active_state&&"put"!=this._active_state||(t+="-primary"),t}get saveurl(){return"/"+this._name}get params(){let t={};return"get"==this._active_state||"post"==this._active_state?this._key_states.parent_key&&(t[this._parent_key]=this._key_states.parent_key):"put"!=this._active_state&&"getprimary"!=this._active_state&&"delete"!=this._active_state||(t[this._primary_key]=this._key_states.primary_key),this.to&&(t.__to=this.to),t}get classes(){return this._name.replace("_","-")+" "+this._state}get to(){return this._to}get state(){return this._active_state}get parentkey(){return this._parent_key}get primarykey(){return this._primary_key}get index(){return this._name+"-"+this._active_state}get stage(){return this.store.stage}get change_intention(){return this._change_intention}get map(){return{model:this._name,key:this.key,state:this._active_state,to:this.to,stage:this.stage}}getSummary(t,e){let s=[];for(let r in e[t.reference])s.push(e[t.reference][r]);return s.join(" ")}applySettings(){this.store.settings&&(this.store.settings.groups&&(this.store.groups=this.store.settings.groups),this.store.settings.disable_filter&&(this.store.disable_filter=!0),this.store.settings.disable_selectfields&&(this.store.disable_selectfields=!0))}buildIntention(t,e=null){if(e||(e=this._key),this._change_intention={state:t,key:e,target:0},this.store.settings&&this.store.settings.change_intention)for(let t in this.store.settings.change_intention)this._change_intention[t]=this.store.settings.change_intention[t]}mapResponse(t){this._name=t.model,this.store.model=this._name,this._primary_key=t.primarykey,this._parent_key=t.parentkey,this._children=t.children,this.store.children=[];for(let e of t.children)this.store.children.push({r:()=>{this.buildIntention("get",this._key_states.primary_key),this._change_intention.model=e.name},n:e.label});this.store.siblings=[];for(let e of t.siblings)this.store.siblings.push({r:()=>{this.buildIntention("get",this._key_states.parent_key),this._change_intention.model=e.name},n:e.label});this._circular=t.circular,this.store.primarykeyname=t.primarykey,this.store.parentkeyname=t.parentkey,this.store.circular=t.circular,this.store.fields={};for(let e in t.fields)if(this.store.fields[e]=new K(e,t.fields[e]),"asset"==this.store.fields[e].type){let t=new q;t.url=this._name+"-"+e,t.keyfield=this.store.primarykeyname,this.store.fields[e].asset=t}this._states=t.states,this._default_state=t.default_state;let e=t.to;for(;e;){let t=new J({model:e.model,key:0});t.mapResponse(e),t.main_model=this,t.state="getprimary",this.store.parent_models.push(t),e=e.to}}load(){this.store.data=[];for(let t in this.store.fields)this.store.fields[t].val=null;if("get"==this._active_state)return V.get(this.loadurl,this.params).then((t=>{if("SUCCESS"!=t.__status)throw new Error(t);return this.mapRepoData(t),t}));if("getprimary"==this._active_state||"put"==this._active_state)return V.get(this.loadurl,this.params).then((t=>{if("SUCCESS"!=t.__status)throw new Error(t);this.mapData(t);for(let e of this.store.parent_models)t[e.name]&&e.mapData(t[e.name])}));if("post"==this._active_state&&this.store.parent_models.length>0){let t=this.store.parent_models[0];return t.keymanager=this._key_states.parent_key,t.to=this.to,V.get(t.loadurl,t.params).then((t=>{if("SUCCESS"!=t.__status)throw new Error(t);this.store.parent_models[this.store.parent_models.length-1].mapData(t);for(let e of this.store.parent_models)e.mapData(t[e.name])})).catch((t=>{console.log(t)}))}return Promise.resolve()}rLoadObj(t){let e={};for(const s in this.store.fields)e[s]=this.store.fields[s].reference?new H(t[s],this.getSummary(this.store.fields[s],t)):new H(t[s]);if(this._circular&&t[this._name]&&t[this._name]){e[this._name]=[];for(const s in t[this._name])e[this._name].push(this.rLoadObj(t[this._name][s]))}for(const s in this._active_children){const r=this._active_children[s];if(t[r]){e[r]=[];for(const s in t[r])e[r].push(this.rLoadObj(t[r][s]))}}return e}indexData(t){let e={};for(const s in t){const r=t[s];for(let t of this.store.groups){t=this.snakeCase(t),e[t]||(e[t]={});let i=r[t].val;e[t][i]||(e[t][i]={display:"",contains:[]},e[t][i].display=r[t].display),e[t][i].contains.push(s)}}return e}mapRepoData(t){this.store.data=[];for(const e in t.__data){const s=this.rLoadObj(t.__data[e]);this.store.data.push(s);for(let s in this.store.parent_models){let r=this.store.parent_models[s];r.mapData(t.__data[e][r.name])}}this.store.indexes=this.indexData(this.store.data)}mapData(t){for(const e in this.store.fields)this.store.fields[e].val=t[e]?t[e]:null}buildlink=t=>()=>{this.buildIntention(t)};loadState(){this.store.actions=[],this.store.component="",this.store.rawcomponent="",this.store.data=[],this.store.title=this._states[this._active_state].title,this.store.label=this._states[this._active_state].label,this.store.action=this._active_state,this.store.method=this.store.action,this.store.submiturl=this.saveurl,this.store.classes=this._name+" "+this._active_state,this.store.settings||(this.store.settings={}),this.store.primarykey=()=>this._key_states.primary_key,this.store.addKeys=()=>{},this.store.resolveKeys=()=>{},{get:()=>{if(this.store.actions=[],this._states.post&&this.store.actions.push({r:this.buildlink("post"),n:this._states.get.actions.post}),this.store.rawcomponent=this.store.groups.length>0?"ptj-list":this._circular||this._active_children.length>0?"ptj-tree":"ptj-table",this.store.component="ptj-repo",this.store.index=this._name+"-get",this.store.reload=()=>{this.load()},this.store.next=t=>{this._states.getprimary?this.buildIntention("getprimary",t):this._states.put&&this.buildIntention("put",t),this.store.active_repo=[]},this.store.addKeys=t=>{},!this.store.settings.fields){this.store.settings.fields=[];for(let t in this.store.fields)(t==this.primarykey||this.store.fields[t].summary)&&this.store.settings.fields.push(t)}this.store.submiturl=this.loadurl},getprimary:()=>{if(this.store.actions=[],this.store.index=this._name+"-getprimary",this._states.put&&this.store.actions.push({r:this.buildlink("put"),n:this._states.getprimary.actions.put}),this._states.delete&&this.store.actions.push({r:async()=>{if(confirm("Are you sure you want to delete this record and all associated children?")){let t={};t[this._primary_key]=this._key_states.primary_key,await V.delete("/"+this._name,t),this.buildIntention("get",this._key_states.parent_key)}},n:this._states.getprimary.actions.delete}),this.store.component="ptj-single-item",!this.store.settings.fields){this.store.settings.fields=[];for(let t in this.store.fields)this.store.settings.fields.push(t)}this._main_model&&(this.store.next=()=>{this._main_model.change_intention={state:"getprimary",key:this.key,target:0,model:this._name}})},post:()=>{if(this.store.component=this._states.login?"ptj-account-handler":"ptj-form",this.store.index=this._name+"-post",this.store.actions=[],this._states.login&&this.store.actions.push({r:this.buildlink("login"),n:this._states.post.actions.login}),this.store.next=()=>{this.buildIntention("get")},!this.store.settings.fields){this.store.settings.fields=[];for(let t of this._states.post.fields)this.store.settings.fields.push(t)}this.store.addKeys=t=>{t[this._parent_key]=this._key_states.parent_key},this.store.resolveKeys=t=>{this._key_states.primary_key=t[this._primary_key]}},put:()=>{if(this.store.component="ptj-form",this.store.index=this._name+"-put",this.store.actions=[],this.store.next=()=>{this._states.getprimary?this.buildIntention("getprimary"):this.buildIntention("get")},!this.store.settings.fields){this.store.settings.fields=[];for(let t of this._states.put.fields)this.store.settings.fields.push(t)}this.store.addKeys=t=>{t[this._primary_key]=this._key_states.primary_key}},login:()=>{if(this.store.component="ptj-account-handler",this.store.index=this._name+"-login",this.store.actions=[],this._states.post&&this.store.actions.push({r:this.buildlink("post"),n:this._states.login.actions.post}),!this.store.settings.fields){this.store.settings.fields=[];for(let t of this._states.login.fields)this.store.settings.fields.push(t)}this.store.method="post",this.store.submiturl+="-login",this.store.next=null}}[this._active_state]();for(let t in this.store.fields)this.store.fields[t].on=!1;for(let t of this.store.settings.fields)this.store.fields[t].on=!0}}var X={encodeParams:function(t){let e={},s=[];for(let r in t)"object"==typeof t[r]&&t[r]||Array.isArray(t[r])?e[r]=t[r]:s.push(r+"="+encodeURIComponent(t[r]));return Object.keys(e).length>0&&s.push("graph="+encodeURIComponent(JSON.stringify(e))),s.join("&")},decodeParams:function(){const t=new URLSearchParams(window.location.search);let e={};return t.forEach((function(t,s){if("graph"==s){let s=JSON.parse(decodeURIComponent(t));e={...e,...s}}else e[s]=t})),e},mapParams:function(t,e){for(let s in e){const r=new RegExp("${"+s+"}","g");t=t.replace(r,e[s])}return t}};const Y={post:"-create",put:"-update",delete:"-delete",login:"-login",logout:"-logout",getprimary:"-primary",get:""};class ${constructor(){this._model,this._state="",this._key=0,this._to}set model(t){this._model=t}set state(t){this._state=t}set key(t){this._key=t}set to(t){this._to=t}get model(){return this._model}get state(){return this._state}get key(){return this._key}get to(){return this._to}swap(t){this._model=t.model,this._state=t.state,this._key=t.key,this._to=t.to}convertToURL(){let t=this._model,e=this._state,s=this._key,r=this._to,i=t+Y[e];return s&&(i+="-"+s),r&&(i+="-to-"+r),i}convertFromURL(t){if(!t)return;let e=t.split("-to-");e.length>1&&(this._to=e[1],t=e[0]),e=t.split("-");let s=parseInt(e[e.length-1]);if(isNaN(s)?this._key=0:(e.pop(),this._key=s),0==e.length)throw new Error("Can't convert this url string: "+t);for(let t in Y)if(Y[t]=="-"+e[e.length-1]){this._state=t,e.pop();break}this._model=e.join("-")}}let W=[],G=null,Q="",Z={};function tt(){let t=new $;return W.push(t),t}var et={trigger:function(t){G=t},resetMaps:function(){W=[]},createMap:tt,convertToURL:function(){let t=[];for(let e of W)t.push(e.convertToURL());let e=Q+"/"+t.join("/");const s=X.encodeParams(Z);return s&&(e+="?"+s),e},convertFromURL:function(t){let e=(t=(t=t.replace(Q,"")).replace(/^\/+|\/+$/g,"")).split("/");W=[];for(let t in e){tt().convertFromURL(e[t])}G&&G()},setBase:function(t){t=t.replace(/^\/+|\/+$/g,""),Q="/"+t},getMaps:function(){return W}};let st;function rt(t){t||(t=window.location.pathname),st&&st(t)}window.onpopstate=function(){rt(document.location.pathname)};var it={setRoute:function(t,e=""){window.history.pushState({name:t},document.title,t),rt(t)},hardSetRoute:function(t){window.location=t},runRoute:rt,regCallback:function(t){st=t}};let at=e({models:[],profile:null}),ot={},lt=[],nt=-1;function pt(t,e){let s=t.model?"/route-"+t.model:"/route-core-default",r={};return t.to&&(r.__to=t.to),V.get(s,r).then((s=>{if("SUCCESS"!=s.__status)throw new Error(s);let r=s.model,i=new J;return i.to=t.to,ot[r]&&i.injectCustomSettings(ot[r]),i.mapResponse(s),i.state=t.state,i.key=t.key,i.stage=e,lt[e]=i,i})).then((t=>t.load()))}function ht(){nt=-1;let t=et.getMaps();if(0==t.length)throw new Error("Error with controller run, no maps created");at.models=[];let e=[];lt.length>t.length&&lt.splice(t.length,lt.length-t.length);for(let s in t){const r=t[s];let i,a;s>=lt.length||lt[s].name!=r.model?a=pt(r,s):(i=lt[s],i.state==r.state&&i.key==r.key||(i.state=r.state,i.key=r.key),a=lt[s].load().catch((t=>console.log(t)))),e.push(a)}Promise.all(e).then((()=>{for(let t of lt)at.models.push(t)})).catch((t=>{console.log(t)}))}et.trigger((()=>{ht()})),it.regCallback(et.convertFromURL);var dt={store:at,models:lt,setSettings:function(t){if(t.client){if(V.setURL(t.client.url),t.client.custom_headers)for(let e in t.client.custom_headers)V.regCustomHeader(e,t.client.custom_headers[e]);t.client.debug&&V.regDebug(!0),V.regStatusHandler(403,(function(){alert("Page not found")}))}t.mapper&&t.mapper.base&&et.setBase(t.mapper.base),t.models&&(ot=t.models)},initProfile:function(){return V.get("/core-check-user").then((t=>(at.profile=t.__profile,at.profile)))},assumeRole:function(t){return V.post("/core-assume-role",{role:t}).then((t=>(at.profile=t.__profile,at.profile)))},removeRole:function(){return V.post("/core-remove-role").then((t=>(at.profile=t.__profile,at.profile)))},run:ht,buildModel:pt,buildLink:function(){et.resetMaps();let t=[],e=[];for(let s in lt){let r=lt[s];t.push(r.map),e.push(r.change_intention)}for(let s=0,r=e.length;s<r;++s){let r=e[s];if(!r)continue;let i=s+r.target;if(i<0?t.unshift({...t[s]}):i>=t.length&&t.push({...t[t.length-1]}),r.model&&(t[i].model=r.model),r.state&&(t[i].state=r.state),r.to&&(t[i].to=r.to),r.key&&(t[i].key=r.key),r.end){t.splice(i+1,t.length);break}}for(const e of t){let t=et.createMap();for(let s in e)t[s]=e[s]}let s=et.convertToURL();it.setRoute(s)},runLink:function(){et.runRoute()},runData:function(t=null){t||(t=window.location.pathname),et.convertFromURL(t)},reloadFromBase:function(){et.resetMaps();let t=et.convertToURL();it.setRoute(t)},getStore:function(){return at.models[nt].store},next:function(){++nt}};let ct={"ptj-account-details-logout":"ptj-account-details-logout","ptj-account-handler":"ptj-account-handler","ptj-breadcrumbs":"ptj-breadcrumbs","ptj-card":"ptj-card","ptj-card-row":"ptj-card-row","ptj-card-label":"ptj-card-label","ptj-card-value":"ptj-card-value","ptj-form":"ptj-form","ptj-form-title":"ptj-form-title","ptj-form-error":"ptj-form-error","ptj-form-group":"ptj-form-group","ptj-form-submit":"ptj-form-submit","ptj-root":"ptj-root","ptj-tabs":"ptj-tabs","ptj-tabs-card":"ptj-tabs-card","ptj-tabs-tab":"ptj-tabs-tab","ptj-repo":"ptj-repo","ptj-nav":"ptj-nav","ptj-nav-link":"ptj-nav-link","ptj-single-item":"ptj-single-item","ptj-single-item-row":"ptj-single-item-row","ptj-single-item-label":"ptj-single-item-label","ptj-single-item-value":"ptj-single-item-value","ptj-single-item-actions":"ptj-single-item-actions","ptj-single-item-children":"ptj-single-item-children","ptj-widget-window":"ptj-widget-window","ptj-widget-window-header":"ptj-widget-window-header","ptj-widget-window-title":"ptj-widget-window-title","ptj-widget-window-toggle":"ptj-widget-window-toggle","ptj-widget-window-body":"ptj-widget-window-body","ptj-repo-header-title":"ptj-repo-header-title","ptj-repo-header-actions":"ptj-repo-header-actions","ptj-tree":"ptj-tree","ptj-form-row":"ptj-form-row","ptj-form-input-row":"ptj-form-input-row","ptj-form-input-label":"ptj-form-input-label","ptj-form-input":"ptj-form-input","ptj-table":"ptj-table","ptj-table-header":"ptj-table-header","ptj-table-header-cell":"ptj-table-header-cell","ptj-table-row":"ptj-table-row","ptj-table-cell":"ptj-table-cell","ptj-table-cell-sortable":"ptj-table-cell-sortable","ptj-form-confirm-row":"ptj-form-confirm-row","ptj-form-confirm-label":"ptj-form-confirm-label","ptj-form-confirm":"ptj-form-confirm","ptj-pagination":"ptj-pagination","ptj-filter-form":"ptj-filter-form","ptj-filter-form-group":"ptj-filter-form-group","ptj-filter-form-submit":"ptj-filter-form-submit","ptj-form-select-row":"ptj-form-select-row","ptj-form-select-label":"ptj-form-select-label","ptj-form-select":"ptj-form-select","ptj-tree-node":"ptj-tree-node","ptj-tree-node-row":"ptj-tree-node-row","ptj-selectfields":"ptj-selectfields","ptj-selectfields-checkbox":"ptj-selectfields-checkbox","ptj-selectfields-label":"ptj-selectfields-label","ptj-form-radio-row":"ptj-form-radio-row","ptj-form-radio-label":"ptj-form-radio-label","ptj-form-radio-option-label":"ptj-form-radio-option-label","ptj-checkbox-row":"ptj-checkbox-row","ptj-checkbox-label":"ptj-checkbox-label","ptj-checkbox":"ptj-checkbox","ptj-form-textarea-row":"ptj-form-textarea-row","ptj-form-textarea-label":"ptj-form-textarea-label","ptj-form-textarea":"ptj-form-textarea","ptj-form-asset-row":"ptj-form-asset-row","ptj-form-asset-label":"ptj-form-asset-label","ptj-form-asset":"ptj-form-asset","ptj-progress-bar-wrapper":"ptj-progress-bar-wrapper","ptj-progress-bar-holder":"ptj-progress-bar-holder","ptj-progress-bar":"ptj-progress-bar","ptj-error":"ptj-error","ptj-filter-form-time-row":"ptj-filter-form-time-row","ptj-filter-form-time-label":"ptj-filter-form-time-label","ptj-filter-form-time-1":"ptj-filter-form-time-1","ptj-filter-form-time-2":"ptj-filter-form-time-2","ptj-filter-form-checkbox-row":"ptj-filter-form-checkbox-row","ptj-filter-form-checkbox-label":"ptj-filter-form-checkbox-label","ptj-filter-form-checkbox":"ptj-filter-form-checkbox","ptj-account-details-logout":"ptj-account-details-logout","ptj-accounthandler":"ptj-accounthandler","ptj-list":"ptj-list"};var ut={regClass:function(t,e){ct[t]=e},getClass:function(t){return ct[t]}},ft=r({name:"ptj-error",props:{error:String},setup:()=>({Class:ut})});function mt(t,e){void 0===e&&(e={});var s=e.insertAt;if(t&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===s&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))}}mt("\n.error {\r\n  color : red;\n}\r\n"),ft.render=function(t,e,s,r,n,p){return i(),a("p",{class:o(t.Class.getClass("ptj-error"))},l(t.error),3)},ft.__file="presstojam/src/components/ptj-error.vue";var _t=r({name:"ptj-input",props:{field:Object},setup:()=>({Class:ut}),components:{"ptj-error":ft}});const gt=["name","type","readonly"];_t.render=function(t,e,s,r,m,_){const g=n("ptj-error");return i(),a("div",{class:o(t.Class.getClass("ptj-form-row")+" "+t.Class.getClass("ptj-form-input-row")+" "+t.field.name)},["hidden"!=t.field.atts.type?(i(),a("label",{key:0,class:o(t.Class.getClass("ptj-form-input-label"))},l(t.field.label),3)):p("v-if",!0),h(d("input",{class:o(t.Class.getClass("ptj-form-input")),name:t.field.name,type:t.field.atts.type,"onUpdate:modelValue":e[0]||(e[0]=e=>t.field.val=e),onBlur:e[1]||(e[1]=e=>t.field.validateon=!0),readonly:t.field.readonly},null,42,gt),[[c,t.field.val]]),h(u(g,{error:t.field.error},null,8,["error"]),[[f,t.field.showError]])],2)},_t.__file="presstojam/src/components/ptj-form-input.vue";var jt=r({name:"ptj-confirm",props:{field:Object},data:()=>({cval:""}),setup:()=>({Class:ut}),computed:{name(){return this.field.name+"_confirm"},error(){if(this.isvalidateon)return this.field.val==this.cval?"":"Doesn't match "+this.field.name}},components:{"ptj-error":ft}});const bt=["name","type"];jt.render=function(t,e,s,r,p,m){const _=n("ptj-error");return i(),a("div",{class:o(t.Class.getClass("ptj-form-row")+" "+t.Class.getClass("ptj-form-confirm-row"))},[d("label",{class:o(t.Class.getClass("ptj-form-confirm-label"))},l(t.field.label),3),h(d("input",{class:o(t.Class.getClass("ptj-form-confirm")),name:t.name,type:t.field.atts.type,"onUpdate:modelValue":e[0]||(e[0]=e=>t.cval=e),onBlur:e[1]||(e[1]=e=>t.field.setValidateOn())},null,42,bt),[[c,t.cval]]),h(u(_,{error:t.error},null,8,["error"]),[[f,t.error]])],2)},jt.__file="presstojam/src/components/ptj-form-confirm.vue";var yt=r({props:{field:Object},setup:t=>({Class:ut}),components:{"ptj-error":ft}});const vt=["readonly","name","multiple"],kt=d("option",{value:"0"},"Select Option",-1),Ct=["value"];yt.render=function(t,e,s,r,p,c){const j=n("ptj-error");return i(),a("div",{class:o(t.Class.getClass("ptj-form-row")+" "+t.Class.getClass("ptj-form-select-row"))},[d("label",{class:o(t.Class.getClass("ptj-form-select-label"))},l(t.field.label),3),h(d("select",{class:o(t.Class.getClass("ptj-form-select")),"onUpdate:modelValue":e[0]||(e[0]=e=>t.field.val=e),readonly:t.field.readonly,name:t.field.name,multiple:t.field.multiple},[kt,(i(!0),a(m,null,_(t.field.options,(t=>(i(),a("option",{key:t.key,value:t.key},l(t.value),9,Ct)))),128))],10,vt),[[g,t.field.val]]),h(u(j,{error:t.field.error},null,8,["error"]),[[f,t.field.showError]])],2)},yt.__file="presstojam/src/components/ptj-form-select.vue";var wt=r({name:"ptj-radio",props:{field:Object},setup:()=>({Class:ut}),data:()=>({isvalidateon:!1}),methods:{setValidateOn(){this.isvalidateon=!0}},components:{"ptj-error":ft}});const xt=["name","value"];wt.render=function(t,e,s,r,p,c){const g=n("ptj-error");return i(),a("div",{class:o(t.Class.getClass("ptj-form-row")+" "+t.Class.getClass("ptj-form-radio-row"))},[d("label",{class:o(t.Class.getClass("ptj-form-radio-label"))},l(t.field.label),3),(i(!0),a(m,null,_(t.field.options,(s=>(i(),a("div",{key:s},[d("label",{class:o(t.Class.getClass("ptj-form-radio-option-label"))},l(s.option),3),h(d("input",{name:t.cfield.name,type:"radio",value:s.value,"onUpdate:modelValue":e[0]||(e[0]=e=>t.field.val=e)},null,8,xt),[[j,t.field.val]])])))),128)),h(u(g,{error:t.field.error},null,8,["error"]),[[f,t.field.error]])],2)},wt.__file="presstojam/src/components/ptj-form-radio.vue";var St=r({name:"ptj-checkbox",props:{field:Object},setup:()=>({Class:ut}),components:{"ptj-error":ft}});const Et=["name"];St.render=function(t,e,s,r,p,c){const m=n("ptj-error");return i(),a("div",{class:o(t.Class.getClass("ptj-form-row")+" "+t.Class.getClass("ptj-checkbox-row"))},[d("label",{class:o(t.Class.getClass("ptj-checkbox-label"))},l(t.field.label),3),h(d("input",{class:o(t.Class.getClass("ptj-checkbox")),type:"checkbox","true-value":1,"false-value":0,name:t.field.name,"onUpdate:modelValue":e[0]||(e[0]=e=>t.field.val=e)},null,10,Et),[[b,t.field.val]]),h(u(m,{error:t.field.error},null,8,["error"]),[[f,t.field.showError]])],2)},St.__file="presstojam/src/components/ptj-form-checkbox.vue";var Dt=r({name:"ptj-textarea",props:{field:Object},setup:()=>({Class:ut}),components:{"ptj-error":ft}});const Ot=["name","readonly","data-html"];Dt.render=function(t,e,s,r,p,c){const m=n("ptj-error");return i(),a("div",{class:o(t.Class.getClass("ptj-form-row")+" "+t.Class.getClass("ptj-form-textarea-row")+" "+t.field.name.replace("_","-"))},[d("label",{class:o(t.Class.getClass("ptj-form-textarea-label"))},l(t.field.label),3),h(d("textarea",{class:o(t.Class.getClass("ptj-form-textarea")),name:t.field.name,"onUpdate:modelValue":e[0]||(e[0]=e=>t.field.val=e),readonly:t.field.readonly,"data-html":t.field.atts.html},null,10,Ot),[[y,t.field.val]]),h(u(m,{error:t.field.error},null,8,["error"]),[[f,t.field.error]])],2)},Dt.__file="presstojam/src/components/ptj-form-textarea.vue";var Rt=r({name:"ptj-asset-field",props:{field:{type:Object,required:!0}},setup:()=>({Class:ut}),methods:{setFile(t){t.target.files.length>0?this.field.val=t.target.files[0]:this.field.val=null,this.field.validateon=!0}},components:{"ptj-error":ft}});const At=["name"];Rt.render=function(t,e,s,r,p,c){const m=n("ptj-error");return i(),a("div",{class:o(t.Class.getClass("ptj-form-row")+" "+t.Class.getClass("ptj-form-asset-row"))},[d("label",{class:o(t.Class.getClass("ptj-form-asset-label"))},l(t.field.label),3),d("input",{class:o(t.Class.getClass("ptj-form-asset")),ref:"input",onChange:e[0]||(e[0]=(...e)=>t.setFile&&t.setFile(...e)),name:t.field.name,type:"file"},null,42,At),h(u(m,{error:t.field.error},null,8,["error"]),[[f,t.field.showError]])],2)},Rt.__file="presstojam/src/components/ptj-form-asset.vue";var Ut=r({name:"ptj-progress-bar",props:{total:Number,progress:Number},setup:()=>({Class:ut}),computed:{num(){let t=Math.floor(this.progress/this.total*100);return isNaN(t)?0:t},style(){return"width:"+this.num+"%;"}}});mt("\n.ptj-progress-holder[data-v-460b10ff] {\r\n     width : 100%;\r\n     min-height : 10px;\r\n     position : relative;\r\n     display : flex;\r\n     align-items: stretch;\r\n     padding : 2px;\n}\n.ptj-bar[data-v-460b10ff] {\r\n     width : 0;\r\n     height : 100%;\r\n     position : relative;\r\n     line-height : 100%;\n}\r\n\r\n\r\n"),Ut.render=function(t,e,s,r,n,p){return i(),a("div",{class:o(t.Class.getClass("ptj-progress-bar-wrapper"))},[d("div",{class:o(t.Class.getClass("ptj-progress-bar-holder")+" ptj-progress-holder")},[d("div",{class:o(t.Class.getClass("ptj-progress-bar")+" ptj-bar"),style:v(t.style)}," ",6)],2),d("span",null,l(t.num)+"%",1)],2)},Ut.__scopeId="data-v-460b10ff",Ut.__file="presstojam/src/components/ptj-progress-bar.vue";var Lt=r({name:"ptj-form",data:()=>({fstate:0,progress:0,globalerror:""}),setup:()=>({store:dt.getStore(),Class:ut}),methods:{clearErrors(){this.globalerror="";for(let t in this.store.fields)this.store.fields[t].error=0},saveAsset(t){const e=this.store.data[t.name];if(!e)return Promise.resolve();asset.saveFile(e,this._key,(()=>++this.progress)),this.total+=asset.num_chunks},submit(t){this.fstate=this.total>0?1:2,this.clearErrors();let e={};for(let t in this.store.fields)this.store.fields[t].on&&(e[t]=this.store.fields[t].val);return this.store.addKeys(e),V[this.store.method](this.store.submiturl,e).then((t=>{if("SUCCESS"!=t.__status)throw{message:t.statusText};this.store.resolveKeys(t)})).then((()=>{let t=[];for(let e in this.store.fields)if("asset"==this.store.fields[e].type){let s=this.store.fields[e].saveAsset(this.store.primarykey()).then((()=>{++this.progress})).catch((t=>{this.fstate=0,this.progress=0,this.store.fields[e].error=t}));t.push(s)}return Promise.all(t)})).then((()=>{this.store.next(),dt.buildLink()})).catch((t=>{if(this.fstate=0,console.log(t),"string"==typeof t)this.globalerror=t;else for(let e in t)0!==e.indexOf("__")&&this.store.fields[e]&&(this.store.fields[e].error=M.getError(t[e]))}))}},computed:{total(){let t=0;for(let e in this.store.fields)"asset"==this.store.fields[e].type&&++t;return t}},components:{"ptj-input":_t,"ptj-confirm":jt,"ptj-select":yt,"ptj-radio":wt,"ptj-checkbox":St,"ptj-textarea":Dt,"ptj-asset-field":Rt,"ptj-progress-bar":Ut}});const It={key:6};Lt.render=function(t,e,s,r,c,g){const j=n("ptj-select"),b=n("ptj-radio"),y=n("ptj-checkbox"),v=n("ptj-textarea"),w=n("ptj-asset-field"),x=n("ptj-input"),S=n("ptj-confirm"),E=n("ptj-progress-bar");return i(),a(m,null,[h(d("form",{onSubmit:e[0]||(e[0]=k(((...e)=>t.submit&&t.submit(...e)),["prevent"])),class:o(t.Class.getClass("ptj-form")+" "+t.store.classes)},[h(d("div",{class:o(t.Class.getClass("ptj-form-error"))},l(t.globalerror),3),[[f,t.globalerror]]),(i(!0),a(m,null,_(t.store.fields,(e=>h((i(),a("div",{key:e.name,class:o(t.Class.getClass("ptj-form-group"))},["select"==e.type?(i(),C(j,{key:0,field:e,stores:t.store},null,8,["field","stores"])):"radio"==e.type?(i(),C(b,{key:1,field:e,stores:t.store},null,8,["field","stores"])):"checkbox"==e.type?(i(),C(y,{key:2,field:e,stores:t.store},null,8,["field","stores"])):"textarea"==e.type?(i(),C(v,{key:3,field:e,stores:t.store},null,8,["field","stores"])):"asset"==e.type?(i(),C(w,{key:4,field:e,stores:t.store},null,8,["field","stores"])):(i(),C(x,{key:5,field:e,stores:t.store},null,8,["field","stores"])),e.confirm?(i(),a("div",It,[u(S,{field:e,stores:t.store},null,8,["field","stores"])])):p("v-if",!0),p(" REMOVED: ")],2)),[[f,e.on]]))),128)),d("input",{type:"submit",value:"Submit",class:o(t.Class.getClass("ptj-form-submit"))},null,2)],34),[[f,0==t.fstate]]),h(u(E,{total:t.total,progress:t.progress},null,8,["total","progress"]),[[f,1==t.fstate]])],64)},Lt.__file="presstojam/src/components/ptj-form.vue";var zt=r({name:"ptj-nav",props:{actions:Array,classes:{type:String,default:""}},setup:()=>({Class:ut}),methods:{setRoute(t){t.r(),dt.buildLink()}}});const Nt=["onClick"];zt.render=function(t,e,s,r,n,p){return i(),a("span",{class:o(t.Class.getClass("ptj-nav")+" "+t.classes)},[(i(!0),a(m,null,_(t.actions,(e=>(i(),a("a",{key:e,onClick:s=>{t.setRoute(e)},class:o(t.Class.getClass("ptj-nav-link"))},l(e.n),11,Nt)))),128))],2)},zt.__file="presstojam/src/components/ptj-nav.vue";var Bt=r({name:"ptj-time-range",props:{field:Object},setup:()=>({Class:ut}),components:{"ptj-error":ft}});Bt.render=function(t,e,s,r,p,c){const m=n("ptj-error");return i(),a("div",{class:o(t.Class.getClass("ptj-form-row")+" "+t.Class.getClass("ptj-filter-form-time-row"))},[d("label",{class:o(t.Class.getClass("ptj-filter-form-time-label"))},l(t.field.label),3),h(d("input",{class:o(t.Class.getClass("ptj-filter-form-time-1")),type:"date","onUpdate:modelValue":e[0]||(e[0]=e=>t.field.val1=e)},null,2),[[y,t.field.val1]]),h(d("input",{class:o(t.Class.getClass("ptj-filter-form-time-2")),type:"date","onUpdate:modelValue":e[1]||(e[1]=e=>t.field.val2=e)},null,2),[[y,t.field.val2]]),h(u(m,{error:t.field.error},null,8,["error"]),[[f,t.field.error]])],2)},Bt.__file="presstojam/src/components/ptj-filter-form-time.vue";var Pt=r({name:"ptj-checkbox",props:{field:Object},setup:()=>({Class:ut})});const Vt=["name"],Tt=[d("option",{value:""},l("All"),-1),d("option",{value:"1"},l("Checked"),-1),d("option",{value:"0"},l("Unchecked"),-1)];Pt.render=function(t,e,s,r,n,p){return i(),a("div",{class:o(t.Class.getClass("ptj-form-row")+" "+t.Class.getClass("ptj-filter-form-checkbox-row"))},[d("label",{class:o(t.Class.getClass("ptj-filter-form-checkbox-label"))},l(t.field.label),3),h(d("select",{name:t.field.name,"onUpdate:modelValue":e[0]||(e[0]=e=>t.field.val=e),class:o(t.Class.getClass("ptj-filter-form-checkbox"))},Tt,10,Vt),[[g,t.field.val]])],2)},Pt.__file="presstojam/src/components/ptj-filter-form-checkbox.vue";var Mt=r({props:{title:String,active:{type:Boolean,default:!1},classes:{type:String,default:""}},setup:()=>({Class:ut}),data(){return{show:this.active}},methods:{toggleWidget(){this.show=!this.show}}});const Ft=[d("span",{class:"material-icons"},"more_horiz",-1)],Kt={class:"Class.getClass('ptj-widget-window-body')"};Mt.render=function(t,e,s,r,n,p){return i(),a("div",{class:o(t.Class.getClass("ptj-widget-window")+" "+t.classes)},[d("div",{class:o(t.Class.getClass("ptj-widget-window-header"))},[d("h1",{class:o(t.Class.getClass("ptj-widget-window-title"))},[w(l(t.title)+" ",1),d("a",{class:o(t.Class.getClass("ptj-widget-window-toggle")),onClick:e[0]||(e[0]=(...e)=>t.toggleWidget&&t.toggleWidget(...e))},Ft,2)],2)],2),h(d("div",Kt,[x(t.$slots,"default")],512),[[f,t.show]])],2)},Mt.__file="presstojam/src/components/ptj-widget-window.vue";var qt=r({name:"ptj-filter-form",setup:()=>({store:dt.getStore(),Class:ut}),methods:{submit(){this.store.reload()}},components:{"ptj-input":_t,"ptj-select":yt,"ptj-checkbox":St,"ptj-time-range":Bt,"ptj-filter-checkbox":Pt,"ptj-widget":Mt}});mt("\n.error[data-v-71ada21d] {\r\n  color : red;\n}\r\n\r\n"),qt.render=function(t,e,s,r,h,c){const u=n("ptj-select"),f=n("ptj-filter-checkbox"),g=n("ptj-time-range"),j=n("ptj-input"),b=n("ptj-widget");return i(),C(b,{title:"search"},{default:S((()=>[d("form",{onSubmit:e[0]||(e[0]=k(((...e)=>t.submit&&t.submit(...e)),["prevent"])),class:o(t.Class.getClass("ptj-filter-form"))},[d("h1",null,"Search "+l(t.store.title),1),(i(!0),a(m,null,_(t.store.fields,(e=>(i(),a("div",{key:e.name,class:o(t.Class.getClass("ptj-filter-form-group"))},["select"==e.type?(i(),C(u,{key:0,field:e,multiple:!0,stores:t.store},null,8,["field","stores"])):"checkbox"==e.type?(i(),C(f,{key:1,field:e,stores:t.store},null,8,["field","stores"])):"datetime"==e.atts.type?(i(),C(g,{key:2,field:e,stores:t.store},null,8,["field","stores"])):(i(),C(j,{key:3,field:e,stores:t.store},null,8,["field","stores"])),p(" REMOVED: ")],2)))),128)),d("input",{type:"submit",value:"Submit",class:o(t.Class.getClass("ptj-filter-form-submit"))},null,2)],34)])),_:1})},qt.__scopeId="data-v-71ada21d",qt.__file="presstojam/src/components/ptj-filter-form.vue";var Ht=r({props:{max_page_limit:Number},setup:t=>({groups:Math.ceil(t.pages/t.max_page_limit),current_group:0,Class:ut}),computed:{firstindex(){return this.current_group*this.max_options},maxoptions:()=>[]},methods:{showPages(t){let e=Controller.current_route.value,s=e+"#";e.query&&(s+=e.query+"&"),s+="__page="+(this.firstindex+t),Router.setRoute(s)}}});const Jt=["onClick"];Ht.render=function(t,e,s,r,n,p){return i(),a("div",{class:o(t.Class.getClass("ptj-pagination"))},[h(d("a",{onClick:e[0]||(e[0]=e=>{t.showPages(-1)})},"<<",512),[[f,t.optiongroup>0]]),(i(!0),a(m,null,_(t.maxoptions,(e=>(i(),a("a",{key:e,onClick:s=>t.page(e)},l(t.firstindex+e),9,Jt)))),128)),h(d("a",{onClick:e[1]||(e[1]=e=>t.showPages(1))},">>",512),[[f,t.current_group<t.groups-1]])],2)},Ht.__file="presstojam/src/components/ptj-pagination.vue";var Xt=r({setup:()=>({store:dt.getStore(),Class:ut}),components:{"ptj-widget":Mt}});const Yt=["onUpdate:modelValue"];Xt.render=function(t,e,s,r,p,c){const u=n("ptj-widget");return i(),C(u,{title:"select fields",classes:t.Class.getClass("ptj-selectfields")},{default:S((()=>[(i(!0),a(m,null,_(t.store.fields,((e,s)=>(i(),a("div",{key:s},[h(d("input",{type:"checkbox","onUpdate:modelValue":t=>e.on=t,class:o(t.Class.getClass("ptj-selectfields-checkbox"))},null,10,Yt),[[b,e.on]]),d("label",{class:o(t.Class.getClass("ptj-selectfields-label"))},l(e.name),3)])))),128))])),_:1},8,["classes"])},Xt.__file="presstojam/src/components/ptj-selectfields.vue";var $t=r({name:"ptj-header",setup:()=>({store:dt.getStore(),Class:ut}),components:{"ptj-nav":zt,"ptj-filter-form":qt,"ptj-pagination":Ht,"ptj-selectfields":Xt}});$t.render=function(t,e,s,r,h,c){const f=n("ptj-nav"),_=n("ptj-filter-form"),g=n("ptj-selectfields");return i(),a(m,null,[d("h1",{class:o(t.Class.getClass("ptj-repo-header-title"))},l(t.store.title),3),u(f,{actions:t.store.actions,class:o(t.Class.getClass("ptj-repo-header-actions"))},null,8,["actions","class"]),1!=t.store.disable_filter?(i(),C(_,{key:0})):p("v-if",!0),1!=t.store.disable_selectfields?(i(),C(g,{key:1})):p("v-if",!0)],64)},$t.__file="presstojam/src/components/ptj-repo-header.vue";var Wt=r({name:"ptj-tree-node",props:{branch:{type:Object,required:!0},draggable:Boolean,ischild:{type:Boolean,default:!1}},data:()=>({toggle_state:{}}),setup:()=>({store:dt.getStore(),Class:ut}),methods:{toggle(t){this.toggle_state[t]=!this.toggle_state[t]},setDraggable(t){t.target.closest(".ptj-draggable").setAttribute("draggable",!0)},endDraggable(t){t.target.closest(".ptj-draggable").setAttribute("draggable",!1)},selectRow(t){this.store.next(t),dt.buildLink()},getRowClass(){let t=[];for(let e of this.store.groups)t.push(this.store.model+"-"+e.replace("_","-")+"-"+this.branch[e]);return t.join(" ")}},computed:{sortable:()=>!0,children(){let t=[];this.store.circular&&this.branch[this.store.model]&&(t=this.branch[this.store.model]);for(let e in this.store.activechildren)this.branch[this.store.activechildren[e]]&&(t=t.concat(this.branch[this.store.activechildren[e]]));return t}},components:{}});const Gt=t=>(E("data-v-1dcaa9f5"),t=t(),D(),t),Qt=["id"],Zt=[Gt((()=>d("span",{class:"material-icons"},"subdirectory_arrow_right",-1)))],te=[Gt((()=>d("span",{class:"material-icons"},"keyboard_arrow_right",-1)))],ee={key:0},se=[Gt((()=>d("span",{class:"material-icons"},"drag_handle",-1)))];mt("\n.model-tree.branch[data-v-1dcaa9f5] {\r\n  padding-left: 8px;\r\n  padding-right: 8px;\r\n  margin: 6px 0;\r\n  background-color:#111111;\n}\n.tree .ide-block[data-v-1dcaa9f5] {\r\n\tdisplay : none;\n}\n.dragArea[data-v-1dcaa9f5] {\r\n  min-height: 50px;\r\n  outline: 1px solid #777777;\n}\r\n\r\n\r\n"),Wt.render=function(t,e,s,r,c,u){const g=n("ptj-tree-node",!0);return i(),a("div",{class:o(t.Class.getClass("ptj-tree-node")+" ptj-draggable"+this.getRowClass()),id:t.branch[t.store.primarykeyname],draggable:"false"},[d("div",{class:o(t.Class.getClass("ptj-tree-node-row")),onClick:e[5]||(e[5]=e=>{t.selectRow(t.branch[t.store.primarykeyname])})},[d("div",null,[t.ischild?(i(),a("a",{key:0,"data-action":"more",class:"button",onClick:e[0]||(e[0]=k((e=>t.toggle(t.branch[t.store.primarykeyname],!1)),["prevent","stop"]))},Zt)):(i(),a("a",{key:1,"data-action":"more",class:"button",onClick:e[1]||(e[1]=k((e=>t.toggle(t.branch[t.store.primarykeyname],!0)),["prevent","stop"]))},te))]),t.sortable?(i(),a("div",ee,[d("a",{"data-action":"more",class:"button",onClick:e[2]||(e[2]=(...e)=>t.prevent.stop&&t.prevent.stop(...e)),onMousedown:e[3]||(e[3]=(...e)=>t.setDraggable&&t.setDraggable(...e)),onMouseup:e[4]||(e[4]=(...e)=>t.endDraggable&&t.endDraggable(...e))},se,32)])):p("v-if",!0),(i(!0),a(m,null,_(t.store.fields,((e,s)=>h((i(),a("div",{key:s},[d("span",null,l(e.label)+": "+l(t.branch[e.name].display),1)])),[[f,e.on]]))),128))],2),(i(!0),a(m,null,_(t.children,((e,s)=>h((i(),C(g,{branch:e,ischild:!0,key:s,store:t.store},null,8,["branch","store"])),[[f,t.toggle_state[t.branch[t.store.primarykeyname]]]]))),128))],10,Qt)},Wt.__scopeId="data-v-1dcaa9f5",Wt.__file="presstojam/src/components/ptj-tree-node.vue";class re{constructor(t={}){this._handle=t.handle,this._drop_target=t.drop_target,this._drag_target=t.drag_target,this._call_back=t.callback,this._x=0,this._y=0,this._offset_x=0,this._offset_y=0,this._judder=t.judder?t.judder:5,this._drag_node,this._drop_node,this._tree=t.tree}isJudder(t,e){const s=t-this._x,r=e-this._y;return!(s<-5||s>5)&&!(r<-5||r>5)}getDirection(t,e){return{x:t==this._x?0:t>this._x?1:-1,y:e==this._y?0:e>this._y?1:-1}}offset(t){var e=t.getBoundingClientRect(),s=t.ownerDocument.defaultView;return{top:e.top+s.pageYOffset,left:e.left+s.pageXOffset}}insertAfter(){let t=this._drag_node.getAttribute("id"),e=this._drop_node.getAttribute("id"),s=0,r=0;if(this._drop_node.nextElementSibling){for(let t in this._tree){let i=this._tree[t];if(i.id==e){s=i.circular,r=i.sort;break}}for(let e in this._tree){let i=this._tree[e];i.id==t?(i.circular=s,i.sort=r+1):i.circular==s&&i.sort>r&&++i.sort}}else for(let e in this._tree){let r=this._tree[e];r.id==t&&(r.circular=s,r.sort=0)}}insertBefore(){let t=this._drag_node.getAttribute("id"),e=this._drop_node.getAttribute("id"),s=0,r=0;for(let t in this._tree){let i=this._tree[t];if(i.id==e){s=i.circular,r=i.sort,++i.sort;break}}for(let e in this._tree){let i=this._tree[e];i.id==t?(i.circular=s,i.sort=r):i.circular==s&&i.sort>r&&++i.sort}}dragStart(t){const e=t.target.closest("[id]");this._drag_node=e;const{top:s,left:r}=this.offset(e);t.dataTransfer.dropEffect="move",this._x=t.clientX,this._y=t.clientY,this._offset_x=t.clientX-r,this._offset_y=t.clientY-s}isDroppable(t){return!!t.target.closest(this._drop_target)}dragEnter(t){if(!this.isDroppable(t))return!0;if(t.preventDefault(),t.dataTransfer.dropEffect="move",this._drop_node=t.target.closest(this._drag_target),!this._drop_node||this._drop_node.getAttribute("id")==this._drag_node.getAttribute("id"))return;const e=this.getDirection(t.clientX,t.clientY);1==e.y?this.insertAfter():-1==e.y&&this.insertBefore(),this._x=t.clientX,this._y=t.clientY}dragOver(t){if(!this.isDroppable(t))return!0;t.preventDefault(),t.dataTransfer.dropEffect="move"}dragEnd(){this._drag_node&&this._drag_node.setAttribute("draggable",!1),this._drag_node=null}drop(t){if(!this._drop_node)return!0;t.preventDefault(),this._call_back&&this._call_back(this._tree)}}var ie={initDD:function(t){let e=new re(t);if(document.querySelectorAll(t.handle).forEach((t=>t.addAttribute("draggable",!0))),t.handle){document.querySelectorAll(t.handle).forEach((e=>{e.addEventListener("mousedown",(e=>{e.target.closest(t.drag_target).addAttribute("draggable",!0)}))}))}t.main.addEventListener("dragstart",(t=>e.dragStart(t))),t.main.addEventListener("dragenter",(t=>e.dragEnter(t))),t.main.addEventListener("dragover",(t=>e.dragOver(t))),t.main.addEventListener("drop",(t=>e.drop(t))),t.main.addEventListener("dragend",(t=>e.dragEnd(t)))}},ae=r({name:"ptj-tree",setup(e){let s={store:dt.getStore(),treeroot:t(null),Class:ut};return O((()=>{ie.initDD({handle:".ptj-drag-handle",drag_target:".ptj-draggable",drop_target:".ptj-drop-target",main:s.treeroot.value,tree:s.store.data,callback:s.store.saveSort})})),s},components:{"ptj-nav":zt,"ptj-tree-node":Wt,"ptj-filter-form":qt,"ptj-selectfields":Xt}});ae.render=function(t,e,s,r,l,p){const h=n("ptj-tree-node");return i(),a("div",{class:o(t.Class.getClass("ptj-tree")+" "+t.store.classes+" ptj-drop-target"),ref:"treeroot"},[(i(!0),a(m,null,_(t.store.data,((t,e)=>(i(),C(h,{key:e,branch:t},null,8,["branch"])))),128))],2)},ae.__file="presstojam/src/components/ptj-tree.vue";var oe=r({name:"ptj-table",setup:()=>({store:dt.getStore(),Class:ut}),methods:{next(t){this.store.next(t),dt.buildLink()},orderBy(t,e){let s={};s[t.name]=e,this.store.orderby=s,this.store.pages>0?this.store.load():e?this.store.data.sort((function(e,s){let r=e[t.name],i=s[t.name];return r<i?-1:r>i?1:0})):this.store.data.sort((function(e,s){let r=e[t.name],i=s[t.name];return r<i?1:r>i?-1:0}))},getRowClass(t){let e=[];for(let s of this.store.groups)e.push(this.store.model+"-"+s.replace("_","-")+"-"+t[s]);return e.join(" ")}},computed:{sortable(){return!!this.store.sort},overlimit:()=>!1,rowclass(){}},components:{"ptj-pagination":Ht}});const le=["onClick"],ne=["onClick"],pe={key:0},he=["onClick"],de=[(t=>(E("data-v-15ab9672"),t=t(),D(),t))((()=>d("span",{class:"material-icons"},"drag",-1)))];mt("\n.table[data-v-15ab9672], .thead[data-v-15ab9672], .tbody[data-v-15ab9672], .tr[data-v-15ab9672] {\r\n    width : 100%;\n}\r\n\r\n\r\n"),oe.render=function(t,e,s,r,c,u){const g=n("ptj-pagination");return i(),a(m,null,[d("table",{class:o(t.Class.getClass("ptj-table")+" "+t.store.classes)},[d("thead",null,[d("tr",{class:o(t.Class.getClass("ptj-table-header"))},[(i(!0),a(m,null,_(t.store.fields,((e,s)=>h((i(),a("th",{key:e.name,class:o(t.Class.getClass("ptj-table-header-cell")+" "+e.name.replace("_","-"))},[w(l(e.label)+" ",1),0==t.sortable?(i(),a("span",{key:0,class:"material-icons",onClick:s=>{t.orderBy(e,!1)}},"keyboard_arrow_up",8,le)):p("v-if",!0),0==t.sortable?(i(),a("span",{key:1,class:"material-icons",onClick:s=>{t.orderBy(e,!0)}},"keyboard_arrow_down",8,ne)):p("v-if",!0)],2)),[[f,t.store.fields[s].on]]))),128)),t.sortable?(i(),a("th",pe," ")):p("v-if",!0)],2)]),d("tbody",null,[(i(!0),a(m,null,_(t.store.data,((s,r)=>(i(),a("tr",{key:r,class:o(t.Class.getClass("ptj-table-row")+" "+this.getRowClass(s)),onClick:e=>{t.next(s[t.store.primarykeyname])}},[(i(!0),a(m,null,_(t.store.fields,((e,r)=>h((i(),a("td",{key:r,class:o(t.Class.getClass("ptj-table-cell")+" "+e.name.replace("_","-"))},l(s[e.name].display),3)),[[f,t.store.fields[r].on]]))),128)),t.sortable?(i(),a("td",{key:0,class:o(t.Class.getClass("ptj-table-cell-sortable"))},[d("a",{"data-action":"more",class:"button",onClick:e[0]||(e[0]=k(((...e)=>t.toggle&&t.toggle(...e)),["prevent"])),draggable:"true"},de)],2)):p("v-if",!0)],10,he)))),128))])],2),t.overlimit?(i(),C(g,{key:0})):p("v-if",!0)],64)},oe.__scopeId="data-v-15ab9672",oe.__file="presstojam/src/components/ptj-table.vue";var ce=r({name:"ptj-list",setup:()=>({store:dt.getStore(),Class:ut}),methods:{next(t){this.store.next(t),dt.buildLink()},getCombinations(t,e,s){const r=[];if(0==s.length)for(let t in e)r.push({tags:[e[t].display],data:e[t].contains});else for(let t of s)for(let s in e){let i=t.tags;i.push(s.display),r.push({tags:i,data:t.data.filter((t=>e[s].contains.includes(t)))})}return r}},computed:{getIndexCombinations(){let t=[];for(let e in this.store.indexes)t=this.getCombinations(e,this.store.indexes[e],t);return console.log(t),t}}});const ue=["onClick"];ce.render=function(t,e,s,r,n,p){return i(),a("div",{class:o(t.Class.getClass("ptj-list")+" "+t.store.classes)},[(i(!0),a(m,null,_(t.getIndexCombinations,((e,s)=>(i(),a("div",{key:s},[d("h3",null,[(i(!0),a(m,null,_(e.tags,((t,e)=>(i(),a("span",{key:e},l(t)+" ",1)))),128))]),d("ul",null,[(i(!0),a(m,null,_(e.data,(e=>(i(),a("li",{key:e},[d("a",{onClick:s=>t.next(t.store.data[e][t.store.primarykeyname])},[(i(!0),a(m,null,_(t.store.fields,(s=>h((i(),a("span",{key:s.name},l(t.store.data[e][s.name].display)+" ",1)),[[f,s.on]]))),128))],8,ue)])))),128))])])))),128))],2)},ce.__file="presstojam/src/components/ptj-list.vue";var fe=r({name:"ptj-repo",setup:()=>({store:dt.getStore(),Class:ut}),components:{"ptj-repo-header":$t,"ptj-tree":ae,"ptj-table":oe,"ptj-list":ce}});mt("\n.table[data-v-1c7fb47e], .thead[data-v-1c7fb47e], .tbody[data-v-1c7fb47e], .tr[data-v-1c7fb47e] {\r\n    width : 100%;\n}\n.ptj-data-row[data-v-1c7fb47e]:nth-child(odd) {background : #CCC}\r\n\r\n"),fe.render=function(t,e,s,r,l,p){const h=n("ptj-repo-header");return i(),a("div",{class:o(t.Class.getClass("ptj-repo")+" "+t.store.classes)},[u(h),(i(),C(R(t.store.rawcomponent),{key:t.store.key}))],2)},fe.__scopeId="data-v-1c7fb47e",fe.__file="presstojam/src/components/ptj-repo.vue";var me=r({name:"ptj-single-item",props:{active:{type:Boolean,default:!1}},setup:()=>({store:dt.getStore(),Class:ut}),computed:{editnav(){return this.store.actions.put},delnav(){return this.store.actions.delete},title(){return this.store.title+" "+this.store.summary()}},methods:{runDel(){this.store.runDelete()}},components:{"ptj-nav":zt,"ptj-widget":Mt}});const _e=w(" ");me.render=function(t,e,s,r,p,h){const c=n("ptj-nav");return i(),a(m,null,[d("div",{class:o(t.Class.getClass("ptj-single-item")+" "+t.store.classes)},[d("h1",null,l(t.store.title),1),u(c,{actions:t.store.actions,class:o(t.Class.getClass("ptj-single-item-actions"))},null,8,["actions","class"]),(i(!0),a(m,null,_(t.store.fields,((e,s)=>(i(),a("div",{key:s,class:o(t.Class.getClass("ptj-single-item-row")+" "+e.name)},[d("span",{class:o(t.Class.getClass("ptj-single-item-label"))},l(e.label),3),_e,d("span",{class:o(t.Class.getClass("ptj-single-item-value"))},l(e.val),3)],2)))),128))],2),u(c,{actions:t.store.children,class:o(t.Class.getClass("ptj-single-item-children"))},null,8,["actions","class"])],64)},me.__file="presstojam/src/components/ptj-single-item.vue";var ge=r({name:"ptj-login",setup(){let t=dt.getStore();return t.next=()=>{dt.reloadFromBase()},{store:t,Class:ut}},components:{"ptj-form":Lt,"ptj-nav":zt}});ge.render=function(t,e,s,r,p,h){const c=n("ptj-form"),f=n("ptj-nav");return i(),a("div",{class:o(t.Class.getClass("ptj-accounthandler"))},[d("h1",null,l(t.store.title),1),u(c),u(f,{action:t.store.actions},null,8,["action"])],2)},ge.__file="presstojam/src/components/ptj-accounthandler.vue";var je=r({name:"ptj-card",props:{store:Object,active:{type:Boolean,default:!1}},methods:{next(){this.store.next(),dt.buildLink()}},computed:{title(){return this.store.title},classes(){return ut.getClass("ptj-card")+" "+this.store.classes},rowclass:()=>ut.getClass("ptj-card-row"),labelclass:()=>ut.getClass("ptj-card-label"),valueclass:()=>ut.getClass("ptj-card-value")},components:{"ptj-widget":Mt}});const be=[d("span",{class:"material-icons"},"view_carousel",-1)],ye=w(" ");je.render=function(t,e,s,r,p,h){const c=n("ptj-widget");return i(),C(c,{title:t.title,active:t.active},{default:S((()=>[d("div",{class:o(t.classes)},[d("a",{onClick:e[0]||(e[0]=(...e)=>t.next&&t.next(...e))},be),(i(!0),a(m,null,_(t.store.fields,((e,s)=>(i(),a("div",{key:s,class:o(t.rowclass+" "+e.name)},[d("span",{class:o(t.labelclass)},l(e.label),3),ye,d("span",{class:o(t.rowclass)},l(e.val),3)],2)))),128))],2)])),_:1},8,["title","active"])},je.__file="presstojam/src/components/ptj-card.vue";var ve=r({props:{index:{type:Boolean}},setup:t=>(t.index&&dt.next(),{store:dt.getStore(),Class:ut}),computed:{parents(){return this.store.parent_models.slice().reverse()}},components:{"ptj-form":Lt,"ptj-nav":zt,"ptj-single-item":me,"ptj-account-handler":ge,"ptj-repo":fe,"ptj-card":je}});ve.render=function(t,e,s,r,l,p){const h=n("ptj-card");return i(),a("div",{class:o(t.Class.getClass("ptj-tabs"))},[(i(!0),a(m,null,_(t.parents,(e=>(i(),a("div",{class:o(t.Class.getClass("ptj-tabs-card")),key:e.name+"-parent"},[u(h,{store:e.store},null,8,["store"])],2)))),128)),d("div",{class:o(t.Class.getClass("ptj-tabs-tab"))},[(i(),C(R(t.store.component),{key:t.store.index}))],2)],2)},ve.__file="presstojam/src/components/ptj-tabs.vue";var ke=r({setup:()=>({Class:ut}),methods:{logout(){V.post("/core-logout").then((()=>{dt.reloadFromBase()}))}}});ke.render=function(t,e,s,r,a,l){return i(),C(A,{to:"#ptj-accountdetails"},[d("a",{class:o(t.Class.getClass("ptj-account-details-logout")),onClick:e[0]||(e[0]=(...e)=>t.logout&&t.logout(...e))},"Logout",2)])},ke.__file="presstojam/src/components/ptj-account-details.vue";var Ce=r({name:"ptj-root",setup:()=>({Class:ut}),computed:{groups:()=>dt.store.models,isaccount:()=>"public"!=dt.store.profile},components:{"ptj-tabs":ve,"ptj-account-details":ke}});Ce.render=function(t,e,s,r,l,h){const d=n("ptj-account-details"),c=n("ptj-tabs");return i(),a(m,null,[t.isaccount?(i(),C(d,{key:0})):p("v-if",!0),(i(!0),a(m,null,_(t.groups,(e=>(i(),a("div",{class:o(t.Class.getClass("ptj-root")),key:e.index},[u(c,{index:!0})],2)))),128))],64)},Ce.__file="presstojam/src/components/ptj-root.vue";var we={Ctrl:dt,runApp:function(t){const e=U(Ce);return e.mount(t),e}};export{we as default};
//# sourceMappingURL=ptj.esm.js.map
