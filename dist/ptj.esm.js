import{ref as e,computed as t,openBlock as l,createElementBlock as s,Fragment as i,createElementVNode as a,renderSlot as r,createBlock as n,Teleport as o,unref as c,withDirectives as d,normalizeClass as p,normalizeStyle as u,vShow as h,reactive as f,renderList as m,createTextVNode as _,toDisplayString as g,vModelText as y,pushScopeId as v,popScopeId as b,onMounted as k,mergeProps as j,vModelSelect as w,vModelDynamic as x,createVNode as S,withCtx as C,resolveComponent as O,withModifiers as A,createCommentVNode as E,vModelCheckbox as P,inject as U,isRef as L,Suspense as R,resolveDynamicComponent as T,createApp as V}from"vue";var N={props:{location:{default:"body"},relative:{default:!1},cls:String},setup(f){const m=f;let _=e(!1);function g(){_.value=!_.value}let y=t((()=>{if(m.relative){let e=function(e){let t={left:0,top:0,width:e.offsetWidth,height:e.offsetHeight,wrapper:0};for(;!e.classList.contains("ptj-table-wrapper");)t.left+=e.offsetLeft,t.top+=e.offsetTop,e=e.parentNode;return t.wrapper=e.offsetWidth,t}(m.relative);return e.wrapper,e.left,e.width,"position:absolute;top:"+(e.top+e.height)+"px;right:0px;"}return""})),v=t((()=>!m.location)),b=t((()=>"body"==m.location?"ptj-modal-backdrop-full":""));return(e,t)=>(l(),s(i,null,[a("a",{onClick:g,class:"ptj-modal-button"},[r(e.$slots,"button")]),(l(),n(o,{disabled:c(v),to:f.location},[d(a("div",{class:p(["ptj-modal-backdrop",c(b)]),style:u(c(y))},[a("div",{class:p(["ptj-modal",f.cls])},[a("header",null,[a("button",{type:"button",class:"btn-close",onClick:g}," x ")]),r(e.$slots,"default",{toggleShow:g})],2)],6),[[h,c(_)]])],8,["disabled","to"]))],64))}};function D(e,t){void 0===t&&(t={});var l=t.insertAt;if(e&&"undefined"!=typeof document){var s=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===l&&s.firstChild?s.insertBefore(i,s.firstChild):s.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}D("\n.ptj-modal-backdrop-full {\r\n    position : absolute;\r\n    top : 0;\r\n    left : 0;\r\n    height : 100vh;\r\n    width : 100vw;\n}\r\n"),N.__file="presstojam/src/components/ptj-modal.vue";let M,I={};var B={initSettings(e){if(M=e.url,e.custom_headers)for(let t in e.custom_headers)I[t]=e.custom_headers[t]},run(e,t,l,s){const i=new Headers;l&&(i.set("Content-Type","application/json"),s=l);for(let e in I)i.set(e,I[e]);return fetch(M+t,{method:e,mode:"cors",cache:"no-cache",credentials:"include",headers:i,body:s}).then((e=>{if(e.ok)return e.json();throw e}))},get(e,t){if(t){const l=new URLSearchParams;for(let e in t)Array.isArray(t[e])||"object"==typeof t[e]&&null!==t[e]?l.append(e,JSON.stringify(t[e])):l.append(e,t[e]);-1==e.indexOf("?")?e+="?":e+="&",e+=l.toString()}return this.run("GET",e)},getprimary(e,t){return this.get(e,t)},post(e,t){return this.run("POST",e,JSON.stringify(t))},put(e,t){return this.run("PUT",e,JSON.stringify(t))},patch(e,t){return this.run("PATCH",e,null,t)},delete(e,t){return this.run("DELETE",e,JSON.stringify(t))}};const F=new class{constructor(){this._route="",this._model="",this._state="",this._key=0,this._to="",this._params={},this._base="/",this._default=!1;Object.keys(this).forEach((e=>{"_"==e[0]&&Object.defineProperty(this,e.substring(1),{get:function(){return this[e]},set:function(t){t!=this[e]&&(this[e]=t)}})})),this.action_map={post:"-create",put:"-update",delete:"-delete",login:"-login",logout:"-logout",primary:"-primary",parent:"-parent",get:""}}get id(){return this.model+"-"+this.state+"-"+this.to}reset(){this.route="",this.model="",this.state="",this.key=0,this.to="",this.params={}}convertToURL(){let e=this._base+this.route+"/"+this.model+this.action_map[this.state];this.key&&(e+="-"+this.key),this.to&&(e+="-to-"+this.to);let t=new URLSearchParams;for(const e in this.params)t.append(e,this.params[e]);return t.length>0&&(e+="?"+t.toString()),e}initSettings(e){e&&(this._base=e.base),this.convertFromURL()}convertFromURL(){let e=new URL(window.location.href),t=e.pathname.replace(this.base,"");if(t=t.replace(/^\/+|\/+$/g,""),!t)return;let l=t.split("/");l.length>=2&&(this.route=l[0],t=l[1]);const s=this;e.searchParams.forEach((function(e,t){s.params[t]=e.indexOf(",")>-1?e.split(","):e})),l=t.split("-to-"),l.length>1&&(this.to=l[1],t=l[0]),l=t.split("-");let i=l[l.length-1];if("first"==i?(this.key=i,l.pop()):isNaN(i)||(this.key=parseInt(i),l.pop()),0==l.length)throw new Error("Can't convert this url string: "+t);this.state="get";for(let e in this.action_map)if(this.action_map[e]=="-"+l[l.length-1]){this.state=e,l.pop();break}this.model=l.join("-"),this.route||(this.route=this.model)}getAll(){return{route:this.route,model:this.model,state:this.state,key:this.key,to:this.to,params:this.params,base:this.base,default:this.default}}apply(e){for(let t in e)this[t]=e[t]}};let z={};function $(e,t,l){if(!z.fields[e])return l;const s=z.fields[e];return s[t]?s[t]:l}let X={};window.onpopstate=function(){F.reset(),F.convertFromURL(),G()};const H=f({component:"",title:"",name:"",route:{children:[],parent:null,perms:[]},slug:[]});function J(){return X[F.model]&&X[F.model][F.state]?X[F.model][F.state]:{}}function Y(){return H.component="",B.get("/nav/route-points/"+F.route+"/"+F.model).then((e=>{var t;H.route.children=e.children,H.route.perms=e.perms,H.route.parent=e.parent,H.title=e.title,H.name=e.name,t=e.dictionary,z=t,"get"==F.state||"parent"==F.state?H.component="ptj-repo":"primary"==F.state?H.component="ptj-primary":"login"==F.state&&(H.component="ptj-account-handler")})).then((e=>{})).catch((e=>console.log(e)))}function q(){H.slug=[];let e={};if(F.key)return"parent"==F.state?e["--parentid"]=F.key:"primary"==F.state&&(e["--id"]=F.key),B.get("/slug/"+F.route+"/"+F.model,e).then((e=>{H.slug=e;for(let e in H.slug)e=parseInt(e),H.slug[e].route=e>0?{model:H.slug[e].model,state:"parent",key:H.slug[e].id}:{model:H.slug[e].model,state:"get",key:0}}))}function K(){location.href==F.base?location.reload():location.href=F.base}function W(){Z(),G()}function Z(){const e=window.location.protocol+"//"+window.location.host+F.convertToURL(),t=new URL(e);window.history.pushState({name:t.pathname},document.title,t)}function G(){Y(),q()}var Q={props:{route:Object},setup(e){const t=e;function i(){for(let e in t.route)F[e]=t.route[e];F.params={},W()}return(t,a)=>(l(),s("a",{class:"ptj-button",key:e.route,onClick:i},[r(t.$slots,"default")]))},__file:"presstojam/src/components/ptj-button.vue"};const ee={class:"ptj-multiple-select"},te={class:"ptj-multiple-select-display"},le={class:"ptj-multiple-select-values"},se=["onClick"],ie=[(e=>(v("data-v-51b18f4e"),e=e(),b(),e))((()=>a("span",{class:"material-icons"},"close",-1)))];var ae={props:{field:Object},setup(t){const r=t,n=e("");function o(){r.field.change1=n.value,n.value=""}return(e,c)=>(l(),s("div",ee,[a("div",te,[a("div",le,[(l(!0),s(i,null,m(t.field.change1,(e=>(l(),s("div",{class:"ptj-multiple-select-val",key:e},[_(g(e)+" ",1),a("a",{class:"ptj-multiple-select-val-remove",onClick:t=>{return l=e,void(r.field.change=r.field.change.filter((function(e){return e!==l})));var l}},ie,8,se)])))),128))]),d(a("input",{type:"text","onUpdate:modelValue":c[0]||(c[0]=e=>n.value=e)},null,512),[[y,n.value]]),a("a",{onClick:o,class:"ptj-multiple-select-add"},"add")])]))}};D("\n.ptj-multiple-select-val[data-v-51b18f4e] {\r\n    display : inline-block;\r\n    border : 1px solid green;\r\n    margin-left : 2px;\r\n    margin-right : 2px;\r\n    padding : 2px;\r\n    background-color : green;\n}\n.ptj-multiple-select-val-remove[data-v-51b18f4e] {\r\n    color : red;\n}\n.ptj-multiple-select-display[data-v-51b18f4e] {\r\n    position :relative;\r\n    background-color : #fff;\r\n    border : 1px solid #cdcdcd;\r\n    min-height : 35px;\n}\r\n\r\n"),ae.__scopeId="data-v-51b18f4e",ae.__file="presstojam/src/components/ptj-multiple-input.vue";const re={class:"ptj-multiple-select"},ne={class:"ptj-multiple-select-display"},oe={class:"ptj-multiple-select-values"},ce=["onClick"],de=[(e=>(v("data-v-5b05457d"),e=e(),b(),e))((()=>a("span",{class:"material-icons"},"close",-1)))],pe={class:"material-icons"},ue=["data-key"];var he={props:{field:Object},setup(e){const t=e;k((()=>{if(t.field.reference){let e="/reference/"+F.model+"/"+t.field.name;t.field.setReferenceOptions(e,{"--parentid":F.key})}}));const r=f({display:!1,symbol:"keyboard_arrow_down"});function n(){r.display?(r.display=!1,r.symbol="keyboard_arrow_down"):(r.display=!0,r.symbol="keyboard_arrow_up")}function o(e){t.field.change1=e.target.getAttribute("data-key"),n()}return(p,u)=>(l(),s("div",re,[a("div",ne,[a("div",oe,[(l(!0),s(i,null,m(e.field.change,(i=>(l(),s("div",{class:"ptj-multiple-select-val",key:i},[_(g(e.field.getOption(i))+" ",1),a("a",{class:"ptj-multiple-select-val-remove",onClick:e=>{return l=i,void(t.field.change=t.field.change.filter((function(e){return e!==l})));var l}},de,8,ce)])))),128))]),a("a",{class:"ptj-multiple-select-arrow",onClick:n},[a("span",pe,g(c(r).symbol),1)])]),d(a("ul",{class:"ptj-multiple-select-options",onClick:o},[(l(!0),s(i,null,m(e.field.options,(e=>(l(),s("li",{key:e.key,"data-key":e.key},g(e.value),9,ue)))),128))],512),[[h,c(r).display]])]))}};D("\n.ptj-multiple-select-val[data-v-5b05457d] {\r\n    display : inline-block;\r\n    border : 1px solid green;\r\n    margin-left : 2px;\r\n    margin-right : 2px;\r\n    padding : 2px;\r\n    background-color : green;\n}\n.ptj-multiple-select-val-remove[data-v-5b05457d] {\r\n    color : red;\n}\n.ptj-multiple-select-arrow[data-v-5b05457d] {\r\n    position :absolute;\r\n    right : 2px;\r\n    top : 3px;\n}\n.ptj-multiple-select-display[data-v-5b05457d] {\r\n    position :relative;\r\n    background-color : #fff;\r\n    border : 1px solid #cdcdcd;\r\n    min-height : 35px;\n}\n.ptj-multiple-select-options li[data-v-5b05457d] {\r\n    list-style: none;\r\n    cursor: pointer;\r\n    margin-top : 2px;\r\n    border : 1px solid #cdcdcd;\r\n    background-color : #fff;\n}\n.ptj-multiple-select-options li[data-v-5b05457d]:hover {\r\n    background-color : #f9f9fb;\r\n    transition : background-color .2s ease-out,border .2s ease-out;\n}\r\n"),he.__scopeId="data-v-5b05457d",he.__file="presstojam/src/components/ptj-multiple-select.vue";const fe=["name"],me={key:1},_e=["name"],ge=a("option",{value:"",selected:"",disabled:""},"Select Option",-1),ye=["value"],ve=["name"],be={key:6},ke={key:7};var je={props:{field:{type:Object,required:!0},type:{type:String,default:"view"}},setup(e){const a=e;let r=t((()=>"edit"==a.type&&a.field.immutable?"view":a.type));const o=t((()=>function(e){if(0==e.length)return null;let t=[];const l=new RegExp(/^[a-zA-Z]+[a-zA-Z0-9._]+$/);for(let s of e)if(s){if(!l.test(s))return null;t.push(s)}return t}(a.field.contains)?"select":a.field.encrypted?"input":a.field.html||a.field.max>300?"textarea":"input")),p=t((()=>{let e=[];for(let t of a.field.contains)e.push({key:t,value:t});return e})),u=t((()=>{let e={};return a.field.encrypted&&(e.type="password"),a.field.atts.readonly&&(e.readonly=!0),a.field.atts.placeholder&&(e.placeholder=field.meta.placeholder),a.field.atts.html&&(e["data-html"]=1),e}));return(t,a)=>"textarea"==c(o)&&"edit"==c(r)?d((l(),s("textarea",j({key:0},c(u),{name:e.field.name,"onUpdate:modelValue":a[0]||(a[0]=t=>e.field.change=t)}),null,16,fe)),[[y,e.field.change]]):"textarea"==c(o)&&"view"==c(r)?(l(),s("div",me,g(e.field.val),1)):"select"==c(o)&&"filter"==c(r)?(l(),n(he,{key:2,field:e.field},null,8,["field"])):"select"==c(o)&&"edit"==c(r)?d((l(),s("select",j({key:3,"onUpdate:modelValue":a[1]||(a[1]=t=>e.field.change=t),name:e.field.name},c(u),{onBlur:a[2]||(a[2]=t=>e.field.validateon=!0)}),[ge,(l(!0),s(i,null,m(c(p),(e=>(l(),s("option",{key:e.key,value:e.key},g(e.value),9,ye)))),128))],16,_e)),[[w,e.field.change]]):"edit"==c(r)?d((l(),s("input",j({key:4},c(u),{name:e.field.name,"onUpdate:modelValue":a[3]||(a[3]=t=>e.field.change=t),onBlur:a[4]||(a[4]=t=>e.field.validateon=!0)}),null,16,ve)),[[x,e.field.change]]):"filter"==c(r)?(l(),n(ae,{key:5,field:e.field},null,8,["field"])):"view"==c(r)&&e.field.reference?(l(),s("span",be,[S(Q,{route:{model:e.field.reference,key:e.field.val,state:"primary"}},{default:C((()=>[_(g(e.field.val),1)])),_:1},8,["route"])])):(l(),s("span",ke,g(e.field.val),1))},__file:"presstojam/src/components/ptj-string.vue"};const we=f({init:!1,login:!1,user:"public"}),xe=f({cats:{},routes:[]});function Se(){B.post("/core/logout").then((()=>{K()}))}function Ce(){B.get("/core/check-user").then((e=>{if(e.is_expired)return B.put("/core/switch-tokens").then((()=>{Ce()}))})).then((e=>{"public"!=we.user&&setTimeout(Ce,6e5)})).catch((e=>{we.login=!0}))}function Oe(){return xe.cats={},xe.routes=[],B.get("/nav/site-map").then((e=>{for(let t in e)for(let l in e[t]){const s={model:l,state:e[t][l].state};e[t][l].default&&(s.default=!0),s.route=l,xe.routes.push(s),xe.cats[t]||(xe.cats[t]=[]),xe.cats[t].push(s)}})).then((()=>(F.model||F.apply(function(){for(let e in xe.cats)for(let t of xe.cats[e])if(t.default)return t}()),!0))).catch((e=>{console.log(e)}))}const Ae={class:"ptj-slug-trail"};var Ee={setup:e=>(e,t)=>(l(),s("div",Ae,[(l(!0),s(i,null,m(c(H).slug,(e=>(l(),n(Q,{key:e.id,route:e.route},{default:C((()=>[_(g(e.model),1)])),_:2},1032,["route"])))),128))])),__file:"presstojam/src/components/ptj-slug-trail.vue"};class Pe{constructor(e={}){this._handle=e.handle,this._drop_target=e.drop_target,this._drag_target=e.drag_target,this._call_back=e.callback,this._x=0,this._y=0,this._offset_x=0,this._offset_y=0,this._judder=e.judder?e.judder:5,this._drag_node,this._drop_node,this._tree=e.tree}isJudder(e,t){const l=e-this._x,s=t-this._y;return!(l<-5||l>5)&&!(s<-5||s>5)}getDirection(e,t){return{x:e==this._x?0:e>this._x?1:-1,y:t==this._y?0:t>this._y?1:-1}}offset(e){var t=e.getBoundingClientRect(),l=e.ownerDocument.defaultView;return{top:t.top+l.pageYOffset,left:t.left+l.pageXOffset}}insertAfter(){let e=this._drag_node.getAttribute("id"),t=this._drop_node.getAttribute("id"),l=0,s=0;if(this._drop_node.nextElementSibling){for(let e in this._tree){let i=this._tree[e];if(i.id==t){l=i.circular,s=i.sort;break}}for(let t in this._tree){let i=this._tree[t];i.id==e?(i.circular=l,i.sort=s+1):i.circular==l&&i.sort>s&&++i.sort}}else for(let t in this._tree){let s=this._tree[t];s.id==e&&(s.circular=l,s.sort=0)}}insertBefore(){let e=this._drag_node.getAttribute("id"),t=this._drop_node.getAttribute("id"),l=0,s=0;for(let e in this._tree){let i=this._tree[e];if(i.id==t){l=i.circular,s=i.sort,++i.sort;break}}for(let t in this._tree){let i=this._tree[t];i.id==e?(i.circular=l,i.sort=s):i.circular==l&&i.sort>s&&++i.sort}}dragStart(e){const t=e.target.closest("[id]");this._drag_node=t;const{top:l,left:s}=this.offset(t);e.dataTransfer.dropEffect="move",this._x=e.clientX,this._y=e.clientY,this._offset_x=e.clientX-s,this._offset_y=e.clientY-l}isDroppable(e){return!!e.target.closest(this._drop_target)}dragEnter(e){if(!this.isDroppable(e))return!0;if(e.preventDefault(),e.dataTransfer.dropEffect="move",this._drop_node=e.target.closest(this._drag_target),!this._drop_node||this._drop_node.getAttribute("id")==this._drag_node.getAttribute("id"))return;const t=this.getDirection(e.clientX,e.clientY);1==t.y?this.insertAfter():-1==t.y&&this.insertBefore(),this._x=e.clientX,this._y=e.clientY}dragOver(e){if(!this.isDroppable(e))return!0;e.preventDefault(),e.dataTransfer.dropEffect="move"}dragEnd(){this._drag_node&&this._drag_node.setAttribute("draggable",!1),this._drag_node=null}drop(e){if(!this._drop_node)return!0;e.preventDefault(),this._call_back&&this._call_back(this._tree)}}var Ue={initDD:function(e){let t=new Pe(e);if(document.querySelectorAll(e.handle).forEach((e=>e.addAttribute("draggable",!0))),e.handle){document.querySelectorAll(e.handle).forEach((t=>{t.addEventListener("mousedown",(t=>{t.target.closest(e.drag_target).addAttribute("draggable",!0)}))}))}e.main.addEventListener("dragstart",(e=>t.dragStart(e))),e.main.addEventListener("dragenter",(e=>t.dragEnter(e))),e.main.addEventListener("dragover",(e=>t.dragOver(e))),e.main.addEventListener("drop",(e=>t.drop(e))),e.main.addEventListener("dragend",(e=>t.dragEnd(e)))}};const Le=0,Re=1,Te=2,Ve=3,Ne=4;class De{constructor(e,l=null){this._name=e,this._type="",this._atts={},this._confirm=!1,this._reference="",this._label="",this._store=f({summary:0,options:[]}),this._default_val=null,this._immutable=!1,this._encrypted=!1,this._min=null,this._max=null,this._contains=[],this._notcontains=[],this._recursive=!1,this._error={OK:0,MIN_VALUE:1,MAX_VALUE:2,HAS:3,HAS_NOT:4};if(Object.keys(this).forEach((e=>{"_store"!=e&&"_"==e[0]&&Object.defineProperty(this,e.substring(1),{get:function(){return this[e]},set:function(t){"_type"==e?this._type=t.toLowerCase():this[e]=t}})})),this.summary=t({get:()=>this._store.summary,set:e=>{this._store.summary=e?1:0}}),this.options=t({get:()=>this._store.options,set:e=>{this._store.options=e}}),l){for(let e in l)if("summary"==e)this.summary=l[e]?1:0;else{if("validation"==e)continue;"type"==e?this.type=l[e].toLowerCase():this["_"+e]=l[e]}this._min=l.validation.min,this._max=l.validation.max,l.validation.contains&&(this._contains=l.validation.contains.split("|")),l.validation.notcontains&&(this._notcontains=l.validation.notcontains.split("|"))}}getOption(e){for(let t of this._store.options)if(t.key==e)return t.value}setReferenceOptions(e,t){return this._store.options=[],B.get(e,t).then((e=>{for(let t in e){let l=e[t]["--id"],s=[];for(let l in e[t])"--id"!=l&&s.push(e[t][l]);this._store.options.push({key:l,value:s.join(" ",s)})}})).catch((e=>{console.log(e)}))}clean(e){return"checkbox"==this._type?e?1:0:e}calcValue(e){return e||""}validateSize(e){return e<this._min?Re:e>this._max?Te:Le}validate(e){if(null===e)return;let t;if(isNaN(e)){const l=e?e.length:0;t=this.validateSize(l)}else t=this.validateSize(e);if(t!=Le)return t;for(let t of this._notcontains)if(e.match(t))return Ne;if(0==this._contains.length)return Le;for(let t of this._contains)if(e.match(t))return Le;return Ve}}class Me{constructor(){this._cells={},this._children={},this._states={},this._active=0,this._init=!1,this._store=f({index:null});Object.keys(this).forEach((e=>{"_"==e[0]&&Object.defineProperty(this,e.substring(1),{get:function(){return this[e]},set:function(t){this[e]=t}})}))}addChild(e,t){this._children[e]=t}addState(e,t){this._actions[e]=t}resetSummary(e){for(let e in this._cells)this._cells[e].summary=!1;for(let t in e)this._cells[e[t]]&&(this._cells[e[t]].summary=!0)}mapField(e,t){this._cells[e]=new De(e,t),this._cells[e].recursive&&(this._store.index=e)}map(e,t=[]){if(t.length>0)for(let l of t)this.mapField(l,e[l]);else for(let t in e)this.mapField(t,e[t])}getCellByType(e){let t={};for(let l in this._cells)this._cells[l].type==e&&(t[l]=this._cells[l]);return t}}class Ie{constructor(e){this._meta=e,this._store=f({value:null,change:null,display:null,error:0,is_validate_on:!1});const l=Object.getOwnPropertyNames(this._meta),s=Object.keys(this);l.forEach((e=>{"_"==e[0]||s.includes(e)||Object.defineProperty(this,e,{get:function(){return this._meta[e]},set:function(t){this._meta[e]=t}})})),this.error=t({get:()=>{this._store.error},set:e=>{this._store.error=e}}),this.showError=t((()=>!(!this._store.is_validate_on||!this._store.error))),this._meta.default_val?this._store.value=this._meta.default_val:"select"==this._meta.type&&(this._store.value=0),this.val=t({get:()=>this._store.value,set:e=>{this._store.value=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.change=t({get:()=>null==this._store.change?this._store.value:this._store.change,set:e=>{this._store.change=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.addParam=e=>{this._store.value&&(e[this.name]=this._store.value)},"time"==this.type?(this.change1=t({get:()=>(null==this._store.change&&(this._store.change=this._store.value),this._store.change?this._store.change.min:""),set:e=>{this._store.change||(this._store.change={min:null,max:null}),this._store.change.min=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.change2=t({get:()=>(null==this._store.change&&(this._store.change=this._store.value),this._store.change?this._store.change.max:""),set:e=>{this._store.change||(this._store.change={min:null,max:null}),this._store.change.max=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.filter=t({get:()=>this._store.value,set:e=>{e&&(this._store.value=e)}}),this.addAPIParam=e=>{let t={};this._store.value&&(this._store.value.min&&(t.min=this._store.value.min),this._store.value.max&&(t.max=this._store.value.max),Object.keys(t).length>0&&(e[this.name]=t))}):"flag"==this.type?(this.change1=t({get:()=>(null==this._store.change&&(this._store.change=this._store.value),null==this._store.change?0:this._store.change?this._store.change:2),set:e=>{0!=e?(2==e&&(e=0),this._store.change=this._meta.clean(e),this._store.error=this._meta.validate(e)):this._store.change=null}}),this.filter=t({get:()=>this._store.value,set:e=>{this._store.value=e}}),this.addAPIParam=e=>{this._store.value&&(e[this.name]=this._store.value)}):"id"==this.type?(this.change1=t({get:()=>(null==this._store.change&&(this._store.change=this._store.value),null==this._store.change?[]:this._store.change),set:e=>{null==this._store.change&&(this._store.change=[]),this._store.change.includes(e)||(this._store.change.push(this._meta.clean(e)),this._store.error=this._meta.validate(e))}}),this.filter=t({get:()=>this._store.value,set:e=>{this._store.value=e}}),this.addAPIParam=e=>{null!=this._store.value&&(e[this.name]=this._store.value)}):"number"==this.type?(this.change1=t({get:()=>(null==this._store.change&&(this._store.change=this._store.value),this._store.change?this._store.change.min:""),set:e=>{this._store.change||(this._store.change={min:null,max:null}),this._store.change.min=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.filter=t({get:()=>this._store.value,set:e=>{this._store.value=e}}),this.change2=t({get:()=>(null==this._store.change&&(this._store.change=this._store.value),this._store.change?this._store.change.max:""),set:e=>{this._store.change||(this._store.change={min:null,max:null}),this._store.change.max=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.addAPIParam=e=>{null!=this._store.value&&(e[this.name]=this._store.value)}):"string"==this.type&&(this.change=t({get:()=>null==this._store.change?"":this._store.change,set:e=>{this._store.change=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.change1=t({get:()=>(null==this._store.change&&(this._store.change=this._store.value),null==this._store.change?[]:this._store.change),set:e=>{null==this._store.change&&(this._store.change=[]),this._store.change.push(this._meta.clean(e)),this._store.error=this._meta.validate(e)}}),this.filter=t({get:()=>this._store.value,set:e=>{Array.isArray(e)?this._store.value=e:e&&(this._store.value=[e])}}),this.addAPIParam=e=>{if(this._store.value){let t=[];for(let e in this._store.value)this._store.value[e]&&t.push("%"+this._store.value[e]+"%");t.length>0&&(e[this.name]=t)}})}get meta(){return this._meta}set validateon(e){this._store.is_validate_on=e}set display(e){this._store.display=e}get display(){return this._store.display?this._store.display:this._store.value}get store(){return this._store}toString(){return this._store.display}isSummary(){return this._meta.summary}setReferenceOptions(e,t){this._meta.setReferenceOptions(e,t)}reset(){this._store.change=null,this._store.value=null}getOption(e){return"string"==this._meta.type?e:this._meta.getOption(e)}}class Be{constructor(e){this._metarow=e,this._cells=f({}),this._children={},this._ids=f({}),e&&this.applyMetaRow(e),this.cells=t((()=>this._cells))}set children(e){this._children=e}get children(){return this._children}get primary(){return this._ids["--id"]}get parent(){return this._ids["--parentid"]}clone(){const e=new Be(this._metarow);let t={};for(let e in this._cells)t[e].val=this._cells[e].val;let l={};for(let t in e.children)l[t]=e.children[t].clone();return e.children=l,e}applyMetaRow(e){for(const t in e.cells){const l=e.cells[t];this._cells[l.name]=new Ie(l)}for(const t in e.children)this._children[t]=e.children[t]}addChild(e,t){this._children[e]||(this._children[e]=[]),this._children[e].push(t)}set row(e){if(e){e["--id"]&&(this._ids["--id"]=e["--id"]),e["--parentid"]&&(this._ids["--parentid"]=e["--parentid"]);for(let t in this._cells)e.hasOwnProperty(t)&&(this._cells[t].val=e[t]);for(let t in this._children)this._children[t].row=e[t]}}set filter(e){if(e)for(let t in this._cells)e.hasOwnProperty(t)&&(this._cells[t].filter=e[t])}getSummary(){let e=[];for(let t in this._cells){const l=this._cells[t];if(l.isSummary()){const t=l.display;e.push(t)}}return e.join(" ")}toString(){let e=[];for(let t in this._cells)e.push(this._cells[t].display);return e.join(" ")}serialize(e=!1){let t={};for(let l in this._cells)e?this._cells[l].change!=this._cells[l].val&&(t[l]=this._cells[l].change):null!=this._cells[l].change&&(t[l]=this._cells[l].change);return t}getCellByType(e){let t={};for(let l in this._cells)this._cells[l].type==e&&(t[l]=this._cells[l]);return t}clearErrors(){for(let e in this._cells)this._cells[e].error=0}reset(){for(let e in this._cells)this._cells[e].error=0,this._cells[e].change=null}setErrors(e){for(let t in e)0!==t.indexOf("__")&&this._cells[t]&&(this._cells[t].error=e[t])}convertToParams(){let e={};for(let t in this._cells)this._cells[t].addParam(e);return e}convertToAPIParams(){let e={};for(let t in this._cells)"asset"!=this._cells[t].type&&this._cells[t].addAPIParam(e);return e}applyChangeData(){for(let e in this._cells)this._cells[e].val=this._cells[e].change}}const Fe=f({meta:new Me,data:[],indexes:{},search:new Be});function ze(){Fe.indexes={};for(const e in Fe.data){let t=Fe.data[e].cells[Fe.meta.store.index].val;Fe.indexes[t]||(Fe.indexes[t]=[]),Fe.indexes[t].push(e)}}function $e(e){Fe.data=[];for(const t in e){let l=new Be(Fe.meta);l.row=e[t],Fe.data.push(l)}}const Xe=async()=>{let e=J();Fe.meta=new Me,Fe.data=[],Fe.indexes={},Fe.search=new Be,Fe.component="",Fe.max_pages=0;let t=function(e){let t={};return t||(t={}),F.to&&(t.__to=F.to),e.to&&(t.__to=e.to),F.key&&(t["--parentid"]=F.key),e.limit&&(t.__limit=e.limit),e.fields&&(t.__fields=e.fields),e.group&&(t.group=e.group),F.params._page&&(t.__limit=(F.params._page-1)*t.__limit+","+t.__limit),t}(e),l="/"+F.route+"/"+F.model;return"parent"==F.state&&(l+="/parent"),B.get("/route"+l,t).then((t=>{Fe.meta.map(t.fields,e.fields),Fe.search.applyMetaRow(Fe.meta),Fe.search.filter=F.params,Fe.meta.init=!0,e.component?Fe.component=e.component:Fe.meta.cells?Fe.component=Fe.meta.store.index||Fe.meta.children.length>0?"tree":"table":Fe.component=""})).then((()=>(t={...t,...Fe.search.convertToAPIParams()},e.limit>0?B.get("/count/"+F.route+"/"+F.model,t).then((t=>{Fe.max_pages=Math.ceil(t.count/e.limit),console.log("Max pages is",Fe.max_pages)})).then((()=>B.get("/data"+l,t))).then((e=>($e(e),Fe.meta.store.index&&ze(),e))):B.get("/data"+l,t).then((e=>($e(e),Fe.meta.store.index&&ze(),e)))))).catch((e=>console.log(e)))},He=e=>(v("data-v-1dcaa9f5"),e=e(),b(),e),Je=["id"],Ye={class:"ptj-tree-node-row"},qe=[He((()=>a("span",{class:"material-icons"},"subdirectory_arrow_right",-1)))],Ke=[He((()=>a("span",{class:"material-icons"},"keyboard_arrow_right",-1)))],We={key:0},Ze=[He((()=>a("span",{class:"material-icons"},"drag_handle",-1)))],Ge=He((()=>a("span",{class:"material-icons"},"arrow_forward_ios",-1)));var Qe={props:{row:{type:[String,Number],required:!0},draggable:Boolean,ischild:{type:Boolean,default:!1}},setup(e){const r=e,o=f({toggle_state:{},branch:null});function p(){const e=o.branch.primary;o.toggle_state[e]=!o.toggle_state[e]}const u=t((()=>{if(!o.branch)return[];const e=o.branch.primary;return Fe.indexes[e]?Fe.indexes[e]:[]})),_=t((()=>o.branch?o.branch.primary:0)),y=t((()=>o.branch?o.branch.getSummary():""));return k((()=>{o.branch=Fe.data[r.row]})),(t,r)=>{const f=O("ptj-tree-node",!0);return l(),s("div",{class:"ptj-tree-node ptj-draggable",id:c(_),draggable:"false"},[a("div",Ye,[a("div",null,[e.ischild?(l(),s("a",{key:0,"data-action":"more",class:"button",onClick:r[0]||(r[0]=A((e=>p()),["prevent","stop"]))},qe)):(l(),s("a",{key:1,"data-action":"more",class:"button",onClick:r[1]||(r[1]=A((e=>p()),["prevent","stop"]))},Ke))]),c(Fe).meta.sortable?(l(),s("div",We,[a("a",{"data-action":"more",class:"button",onClick:r[2]||(r[2]=(...e)=>t.prevent.stop&&t.prevent.stop(...e)),onMousedown:r[3]||(r[3]=(...e)=>t.setDraggable&&t.setDraggable(...e)),onMouseup:r[4]||(r[4]=(...e)=>t.endDraggable&&t.endDraggable(...e))},Ze,32)])):E("v-if",!0),a("div",null,g(c(y)),1),S(Q,{route:{state:"primary",key:c(_)}},{default:C((()=>[Ge])),_:1},8,["route"])]),(l(!0),s(i,null,m(c(u),((e,t)=>d((l(),n(f,{row:e,ischild:!0,key:t},null,8,["row"])),[[h,c(o).toggle_state[c(_)]]]))),128))],8,Je)}}};D("\n.model-tree.branch[data-v-1dcaa9f5] {\r\n  padding-left: 8px;\r\n  padding-right: 8px;\r\n  margin: 6px 0;\r\n  background-color:#111111;\n}\n.tree .ide-block[data-v-1dcaa9f5] {\r\n\tdisplay : none;\n}\n.dragArea[data-v-1dcaa9f5] {\r\n  min-height: 50px;\r\n  outline: 1px solid #777777;\n}\r\n\r\n\r\n"),Qe.__scopeId="data-v-1dcaa9f5",Qe.__file="presstojam/src/components/ptj-tree-node.vue";const et={class:"ptj-tree ptj-drop-target'",ref:"treeroot"};var tt={setup(e){function t(){}return k((()=>{Fe.meta.sortable&&Ue.initDD({handle:".ptj-drag-handle",drag_target:".ptj-draggable",drop_target:".ptj-drop-target",callback:t})})),(e,t)=>(l(),s("div",et,[(l(!0),s(i,null,m(c(Fe).indexes[0],((e,t)=>(l(),n(Qe,{key:t,row:e},null,8,["row"])))),128))],512))},__file:"presstojam/src/components/ptj-tree.vue"};const lt=["name"],st={key:1},it=["name"],at=_(" - "),rt=["name"],nt={key:2};var ot={props:{field:Object,type:{type:String,default:"view"}},setup:e=>(t,i)=>"edit"==e.type?d((l(),s("input",j({key:0,class:"ptj-form-number",name:e.field.name,type:"number","onUpdate:modelValue":i[0]||(i[0]=t=>e.field.change=t)},e.field.atts,{onBlur:i[1]||(i[1]=t=>e.field.validateon=!0)}),null,16,lt)),[[y,e.field.change]]):"filter"==e.type?(l(),s("div",st,[d(a("input",j({class:"ptj-form-filter-number ptj-min",name:e.field.name,type:"number","onUpdate:modelValue":i[2]||(i[2]=t=>e.field.change1=t)},e.field.atts,{onBlur:i[3]||(i[3]=t=>e.field.validateon=!0)}),null,16,it),[[y,e.field.change1]]),at,d(a("input",j({class:"ptj-form-filter-number ptj-max",name:e.field.name,type:"number","onUpdate:modelValue":i[4]||(i[4]=t=>e.field.change2=t)},e.field.atts,{onBlur:i[5]||(i[5]=t=>e.field.validateon=!0)}),null,16,rt),[[y,e.field.change2]])])):(l(),s("span",nt,g(e.field.val),1)),__file:"presstojam/src/components/ptj-number.vue"};const ct=["name"],dt=["name"],pt=[a("option",{value:0},g("All"),-1),a("option",{value:1},g("Checked"),-1),a("option",{value:2},g("Unchecked"),-1)],ut={class:"material-icons"};var ht={props:{field:Object,type:{type:String,default:"view"}},setup(e){const i=e;let r=t((()=>"edit"==i.type&&i.field.immutable?"view":i.type));let n=t((()=>1==i.field.val?"check_circle_outline":"highlight_off"));return(t,o)=>"edit"==c(r)?d((l(),s("input",{key:0,class:"ptj-checkbox",type:"checkbox","true-value":1,"false-value":0,name:e.field.name,"onUpdate:modelValue":o[0]||(o[0]=t=>e.field.change=t)},null,8,ct)),[[P,e.field.change]]):"filter"==c(r)?d((l(),s("select",{key:1,name:e.field.name,"onUpdate:modelValue":o[1]||(o[1]=t=>e.field.change1=t),class:"ptj-filter-form-checkbox"},pt,8,dt)),[[w,e.field.change1]]):(l(),s("a",{key:2,onClick:o[2]||(o[2]=e=>function(){let e={};return e["--id"]=F.key,e[i.field.name]=1==i.field.val?0:1,F.key&&(e["--id"]=F.key),B.put("/data/"+F.route+"/"+F.model,e).then((()=>{i.field.val=1==i.field.val?0:1})).catch((e=>{console.log(e)}))}())},[a("span",ut,g(c(n)),1)]))},__file:"presstojam/src/components/ptj-flag.vue"};const ft=["name"],mt=a("option",{value:"0",selected:""},"Select Option",-1),_t=["value"],gt={key:2};var yt={props:{field:Object,type:{default:"view",type:String}},setup(e){const a=e;let r=t((()=>"edit"==a.type&&a.field.immutable?"view":a.type));return t((()=>a.field.options)),(t,a)=>"edit"==c(r)?d((l(),s("select",j({key:0,"onUpdate:modelValue":a[0]||(a[0]=t=>e.field.change=t)},e.field.atts,{name:e.field.name,onBlur:a[1]||(a[1]=t=>e.field.validateon=!0)}),[mt,(l(!0),s(i,null,m(e.field.options,(e=>(l(),s("option",{key:e.key,value:e.key},g(e.value),9,_t)))),128))],16,ft)),[[w,e.field.change]]):"filter"==c(r)?(l(),n(he,{key:1,field:e.field},null,8,["field"])):(l(),s("span",gt,g(e.field.getOption(e.field.val)),1))},__file:"presstojam/src/components/ptj-id.vue"};const vt=["name"],bt={key:1},kt=["name"],jt=_(" - "),wt=["name"],xt={key:2};var St={props:{field:Object,type:{default:"view",type:String}},setup(e){const i=e;let r=t((()=>"edit"==i.type&&i.field.immutable?"view":i.type));return(t,i)=>"edit"==c(r)?d((l(),s("input",j({key:0,name:e.field.name,type:"datetime-local","onUpdate:modelValue":i[0]||(i[0]=t=>e.field.change=t)},e.field.atts,{onBlur:i[1]||(i[1]=t=>e.field.validateon=!0)}),null,16,vt)),[[y,e.field.change]]):"filter"==c(r)?(l(),s("div",bt,[d(a("input",j({type:"datetime-local",name:e.field.name+"min"},e.field.atts,{"onUpdate:modelValue":i[2]||(i[2]=t=>e.field.change1=t)}),null,16,kt),[[y,e.field.change1]]),jt,d(a("input",j({type:"datetime-local",name:e.field.name+"max"},e.field.atts,{"onUpdate:modelValue":i[3]||(i[3]=t=>e.field.change2=t)}),null,16,wt),[[y,e.field.change2]])])):(l(),s("span",xt,g(e.field.val),1))},__file:"presstojam/src/components/ptj-time.vue"};const Ct=["name"],Ot={key:1};var At={props:{field:Object,type:{type:String,default:"view"}},setup:e=>(t,i)=>"edit"==e.type?(l(),s("input",{key:0,class:"ptj-form-asset",ref:"input",onChange:i[0]||(i[0]=(...e)=>t.setFile&&t.setFile(...e)),name:e.field.meta.name,type:"file"},null,40,Ct)):(l(),s("span",Ot,g(e.field.val),1)),__file:"presstojam/src/components/ptj-asset.vue"};const Et=["onUpdate:modelValue"],Pt={class:"ptj-selectfields-label"};var Ut={setup:e=>(e,t)=>(l(!0),s(i,null,m(c(Fe).meta.cells,((e,t)=>(l(),s("div",{key:t},[d(a("input",{type:"checkbox","onUpdate:modelValue":t=>e.summary=t,"true-value":1,"false-value":0,class:"ptj-selectfields-checkbox"},null,8,Et),[[P,e.summary]]),a("label",Pt,g(c($)(e.name,"label",e.name)),1)])))),128)),__file:"presstojam/src/components/ptj-selectfields.vue"};const Lt=e=>(v("data-v-15ab9672"),e=e(),b(),e),Rt={class:"ptj-table-wrapper"},Tt=["onClick"],Vt={key:0,class:"material-icons"},Nt={key:1,class:"material-icons"},Dt={class:"ptj-actions"},Mt=Lt((()=>a("span",{class:"material-icons"},"add",-1))),It={class:"ptj-actions"},Bt=Lt((()=>a("span",{class:"material-icons"},"arrow_forward_ios",-1)));var Ft={setup(t){let r=J(),o=f({name:"",dir:""});const u=e(null);return(e,t)=>(l(),s("div",Rt,[a("table",{class:p(["ptj-table",Map.model])},[a("thead",null,[a("tr",{class:"ptj-table-header",ref_key:"tableheader",ref:u},[(l(!0),s(i,null,m(c(Fe).meta.cells,(e=>d((l(),s("th",{key:e.name,class:p(["ptj-table-header-cell",e.name]),onClick:t=>{!function(e){if(Fe.meta.pages>0){o.dir=!o.name!=e||"desc"==o.dir?"asc":"desc",o.name=e;let t=[];t[o.name]=o.dir,Fe.meta.sort=t,load()}else o.name!=e||"desc"==o.dir?(Fe.data.sort((function(t,l){let s=t.getCell(e).toVal(),i=l.getCell(e).toVal();return s<i?-1:s>i?1:0})),o.name=e,o.dir="asc"):(Fe.data.sort((function(t,l){let s=t.getCell(e).toVal(),i=l.getCell(e).toVal();return s<i?1:s>i?-1:0})),o.name=e,o.dir="desc")}(e.name)}},[_(g(e.label)+" ",1),c(o).name==e.name&&"asc"==c(o).dir?(l(),s("span",Vt,"keyboard_arrow_up")):E("v-if",!0),c(o).name==e.name&&"desc"==c(o).dir?(l(),s("span",Nt,"keyboard_arrow_down")):E("v-if",!0)],10,Tt)),[[h,e.summary]]))),128)),a("th",Dt,[1!=c(r).disable_selectfields?(l(),n(N,{key:0,location:!1,relative:u.value},{button:C((()=>[Mt])),default:C((()=>[S(Ut)])),_:1},8,["relative"])):E("v-if",!0)])],512)]),a("tbody",null,[(l(!0),s(i,null,m(c(Fe).data,((e,t)=>(l(),s("tr",{key:t,class:"ptj-table-row"},[(l(!0),s(i,null,m(e.cells,((e,t)=>d((l(),s("td",{key:t,class:p(["ptj-table-cell",e.meta.name])},["asset"==e.type?(l(),n(At,{key:0,field:e},null,8,["field"])):"number"==e.type?(l(),n(ot,{key:1,field:e},null,8,["field"])):"flag"==e.type?(l(),n(ht,{key:2,field:e},null,8,["field"])):"id"==e.type?(l(),n(yt,{key:3,field:e},null,8,["field"])):"time"==e.type?(l(),n(St,{key:4,field:e},null,8,["field"])):"string"==e.type?(l(),n(je,{key:5,field:e},null,8,["field"])):E("v-if",!0)],2)),[[h,e.summary]]))),128)),a("td",It,[S(Q,{route:{state:"primary",key:e.primary}},{default:C((()=>[Bt])),_:2},1032,["route"])])])))),128))])],2)]))}};D("\ntable[data-v-15ab9672], thead[data-v-15ab9672], tbody[data-v-15ab9672], tr[data-v-15ab9672] {\r\n    width : 100%;\n}\n.ptj-table-wrapper[data-v-15ab9672] {\r\n    position : relative;\n}\r\n\r\n"),Ft.__scopeId="data-v-15ab9672",Ft.__file="presstojam/src/components/ptj-table.vue";var zt={setup(e){U("data"),U("indexes");const r=t((()=>{let e=[];for(let t in indexes)e=this.getCombinations(t,indexes[t],e);return e}));return(e,t)=>(l(!0),s(i,null,m(c(r),((t,r)=>(l(),s("div",{key:r},[a("h3",null,[(l(!0),s(i,null,m(t.tags,((e,t)=>(l(),s("span",{key:t},g(e)+" ",1)))),128))]),a("ul",null,[(l(!0),s(i,null,m(t.data,(t=>(l(),s("li",{key:t},[S(Q,{route:e.route},{default:C((()=>[_(g(e.data[t].getSummary()),1)])),_:2},1032,["route"])])))),128))])])))),128))},__file:"presstojam/src/components/ptj-list.vue"};const $t={class:"ptj-error"};var Xt={props:{error:[Number,String,Object]},setup:e=>(t,i)=>(l(),s("p",$t,g(e.error),1))};D("\n.ptj-error {\r\n  color : red;\n}\r\n"),Xt.__file="presstojam/src/components/ptj-error.vue";const Ht={class:"ptj-form-label"};var Jt={props:{field:[Object,Function]},setup:e=>(t,i)=>(l(),s("div",{class:p(["ptj-form-row",e.field.name])},[a("label",Ht,g(c($)(e.field.name,"label",e.field.label)),1),r(t.$slots,"default"),d(S(Xt,{error:e.field.error},null,8,["error"]),[[h,e.field.showError]])],2)),__file:"presstojam/src/components/ptj-form-row.vue"};const Yt=["onSubmit"],qt=(e=>(v("data-v-71ada21d"),e=e(),b(),e))((()=>a("h3",null,"Select Filters",-1))),Kt=["onClick"];var Wt={setup(e){function t(){Fe.search.applyChangeData(),F.params=Fe.search.convertToParams(),Z(),Xe()}return(e,r)=>(l(),s("form",{onSubmit:A(t,["prevent"]),class:"ptj-filter-form"},[qt,(l(!0),s(i,null,m(c(Fe).search.cells,(e=>d((l(),n(Jt,{key:e.name,field:e},{default:C((()=>["id"==e.type?(l(),n(yt,{key:0,type:"filter",field:e},null,8,["field"])):"flag"==e.type?(l(),n(ht,{key:1,type:"filter",field:e},null,8,["field"])):"number"==e.type?(l(),n(ot,{key:2,type:"filter",field:e},null,8,["field"])):"time"==e.type?(l(),n(St,{key:3,type:"filter",field:e},null,8,["field"])):"string"==e.type?(l(),n(je,{key:4,type:"filter",field:e},null,8,["field"])):E("v-if",!0),a("a",{class:"ptj-filter-form-reset",onClick:t=>e.reset()},"x",8,Kt)])),_:2},1032,["field"])),[[h,"id"!=e.type||Object.keys(e.options).length>0]]))),128)),a("input",{type:"submit",value:"Submit",class:"ptj-filter-form-submit",onClick:r[0]||(r[0]=t=>{e.$emit("close")})})],40,Yt))}};D("\n.error[data-v-71ada21d] {\r\n  color : red;\n}\r\n\r\n"),Wt.__scopeId="data-v-71ada21d",Wt.__file="presstojam/src/components/ptj-filter-form.vue";const Zt={class:"ptj-pagination"},Gt=["onClick"];var Qt={setup(e){function t(e){return e==F.params._page??1?"ptj-pagination-active":""}return(e,a)=>(l(),s("div",Zt,[(l(!0),s(i,null,m(c(Fe).max_pages,(e=>(l(),s("a",{key:e,onClick:t=>{return l=e,F.params._page=l,Z(),void Xe();var l},class:p(t(e))},g(e),11,Gt)))),128))]))},__file:"presstojam/src/components/ptj-pagination.vue"};const el={class:"ptj-progress-bar-wrapper"},tl={class:"ptj-progress-holder"};var ll={props:{total:Number,progress:Number},setup(e){const i=e,r=t((()=>{let e=Math.floor(i.progress/i.total*100);return isNaN(e)?0:e}));return(e,t)=>(l(),s("div",el,[a("div",tl,[a("div",{class:"ptj-progress-bar",style:u("width:"+c(r)+"px")}," ",4)]),a("span",null,g(c(r))+"%",1)]))}};D("\n.ptj-progress-holder[data-v-460b10ff] {\r\n     width : 100%;\r\n     min-height : 10px;\r\n     position : relative;\r\n     display : flex;\r\n     align-items: stretch;\r\n     padding : 2px;\n}\n.ptj-progress-bar[data-v-460b10ff] {\r\n     width : 0;\r\n     height : 100%;\r\n     position : relative;\r\n     line-height : 100%;\n}\r\n\r\n\r\n"),ll.__scopeId="data-v-460b10ff",ll.__file="presstojam/src/components/ptj-progress-bar.vue";const sl=["onSubmit"],il=a("input",{type:"submit",value:"Submit",class:"ptj-form-submit"},null,-1);var al={emits:["close"],setup(t,{emit:r}){let o=e("");const u=f(new Be),_=f({total:0,progress:0});let y=0;function v(){y=_.total>0?1:2,u.clearErrors();let e=u.serialize();return F.key&&(e["--parentid"]=F.key),B.post("/data/"+F.route+"/"+F.model,e).then((e=>{let t=[],l=u.getCellByType("asset");_.total=0;for(let s in l){if(!l[s].val)continue;++_.total;const i=new Asset;i.url="/asset/"+F.model+"/"+s+"/"+e["--id"];let a=i.saveFile(l[s].val).then((()=>{++_.progress}));t.push(a)}return Promise.all(t)})).then((()=>{u.reset(),Xe(),r("close")})).catch((e=>{console.log(e),y=0,"string"==typeof e?o=e:u.setErrors(e)}))}return k((async()=>{await(async()=>B.post("/route/"+F.route+"/"+F.model).then((e=>{const t=new Me;t.map(e.fields),u.applyMetaRow(t);let l=[];for(let e in t.cells)if("id"==t.cells[e].type&&t.cells[e].reference){let s="/reference/"+F.model+"/"+e;l.push(t.cells[e].setReferenceOptions(s,{"--parentid":F.key}))}return Promise.all(l)})).catch((e=>console.log(e))))()})),(e,t)=>d((l(),s("form",{onSubmit:A(v,["prevent"]),class:p(["ptj-form",F.model+" "+F.state])},[d(a("div",{class:"ptj-form-error"},g(c(o)),513),[[h,c(o)]]),(l(!0),s(i,null,m(c(u).cells,(e=>(l(),n(Jt,{key:e.name,field:e},{default:C((()=>["asset"==e.type?(l(),n(At,{key:0,type:"edit",field:e},null,8,["field"])):"number"==e.type?(l(),n(ot,{key:1,type:"edit",field:e},null,8,["field"])):"flag"==e.type?(l(),n(ht,{key:2,type:"edit",field:e},null,8,["field"])):"id"==e.type?(l(),n(yt,{key:3,type:"edit",field:e},null,8,["field"])):"time"==e.type?(l(),n(St,{key:4,type:"edit",field:e},null,8,["field"])):"string"==e.type?(l(),n(je,{key:5,type:"edit",field:e},null,8,["field"])):E("v-if",!0)])),_:2},1032,["field"])))),128)),il,d(S(ll,{total:c(_).total,progress:c(_).progress},null,8,["total","progress"]),[[h,1==c(y)]])],42,sl)),[[h,0==c(y)]])},__file:"presstojam/src/components/ptj-create-form.vue"};const rl=e=>(v("data-v-1c7fb47e"),e=e(),b(),e),nl=_(" Create "),ol=_(" Search "),cl=rl((()=>a("span",{class:"material-icons"},"search",-1)));var dl={setup(e){let t=J();return k((async()=>{await Xe()})),(e,i)=>(l(),s("div",{class:p([Map.model,Map.state])},[S(N,null,{button:C((()=>[nl])),default:C((e=>[S(al,{onClose:e.toggleShow},null,8,["onClose"])])),_:1}),1!=c(t).disable_filter?(l(),n(N,{key:0},{button:C((()=>[ol,cl])),default:C((e=>[S(Wt,{onClose:e.toggleShow},null,8,["onClose"])])),_:1})):E("v-if",!0),"tree"==c(Fe).component?(l(),n(tt,{key:1})):"list"==c(Fe).component?(l(),n(zt,{key:2})):"table"==c(Fe).component?(l(),n(Ft,{key:3})):E("v-if",!0),c(Fe).max_pages>0?(l(),n(Qt,{key:4})):E("v-if",!0)],2))}};D("\n.table[data-v-1c7fb47e], .thead[data-v-1c7fb47e], .tbody[data-v-1c7fb47e], .tr[data-v-1c7fb47e] {\r\n    width : 100%;\n}\r\n\r\n"),dl.__scopeId="data-v-1c7fb47e",dl.__file="presstojam/src/components/ptj-repo.vue";const pl=["placeholder"],ul=["disabled"];var hl={props:{check_str:{type:String,default:"delete"},parentid:{default:0}},emits:["close"],setup(t,{emit:r}){const n=t;let o=e(""),p=e(!0);function u(){p.value=o.value!=n.check_str}function h(){B.delete("/data/"+F.route+"/"+F.model,{"--id":F.key}).then((e=>{F.state="parent",F.key=n.parentid.val,W()})).catch((e=>console.log(e)))}return(e,r)=>(l(),s(i,null,[a("p",null,"Are you sure you want to permanently delete this record? Type "+g(t.check_str)+" in the box below to continue.",1),d(a("input",{type:"text",placeholder:t.check_str,onKeyup:u,"onUpdate:modelValue":r[0]||(r[0]=e=>L(o)?o.value=e:o=e)},null,40,pl),[[y,c(o)]]),a("button",{disabled:c(p),onClick:h},"Delete",8,ul)],64))},__file:"presstojam/src/components/ptj-delete.vue"};const fl=_(" delete "),ml={class:"ptj-children"};var _l={setup(e){const r=f({data:new Be,fstate:0,type:"view",show_def:!1,progress:{total:0,progress:0}});function o(){r.type="view"==r.type?"edit":"view"}let d=t((()=>"edit"==r.type?"view":"edit"));const u=async()=>{let e=J(),t=function(e){let t={};return F.to&&(t.__to=F.to),F.key&&("first"==F.key?t.__limit=1:t["--id"]=F.key),e.fields&&(t.__fields=e.fields),console.log("Params is ",t),t}(e);return B.get("/route/"+F.route+"/"+F.model+"/primary",t).then((t=>{const l=new Me;l.map(t.fields,e.fields??[]),r.data.applyMetaRow(l)})).then((()=>B.get("/data/"+F.route+"/"+F.model+"/primary",t))).then((e=>{r.data.row=e;for(let e in r.data.cells)r.data.cells[e].change=r.data.cells[e].val})).then((e=>{for(let e in r.data.cells)if("id"==r.data.cells[e].type&&r.data.cells[e].reference){let t="/reference/"+F.model+"/"+e;r.data.cells[e].setReferenceOptions(t,{"--id":F.key})}})).catch((e=>console.log(e)))};function h(){r.fstate=r.progress.total>0?1:2,r.data.clearErrors();let e=r.data.serialize(!0);if(0!=Object.keys(e).length)return e["--id"]=F.key,B.put("/data/"+F.route+"/"+F.model,e).then((e=>{let t=[],l=r.data.getCellByType("asset");r.progress.total=0;for(let s in l){if(!l[s].val)continue;++r.progress.total;const i=new Asset;i.url="/asset/"+F.model+"/"+s+"/"+e["--id"];let a=i.saveFile(l[s].val).then((()=>{++r.progress.progress}));t.push(a)}return Promise.all(t)})).then((()=>{for(let e in r.data.cells)r.data.cells[e].val=r.data.cells[e].change})).then((()=>{o()})).catch((e=>{r.fstate=0,"string"==typeof e?globalerror=e:r.data.setErrors(e)}));o()}return k((async()=>{await u()})),(e,t)=>(l(),s(i,null,[c(H).route.perms.includes("put")?(l(),s("button",{key:0,onClick:o},g(c(d)),1)):E("v-if",!0),c(H).route.perms.includes("delete")?(l(),n(N,{key:1,cls:"ptj-del-modal"},{button:C((()=>[fl])),default:C((e=>[S(hl,{parentid:c(r).data.parent,onClose:e.toggleShow},null,8,["parentid","onClose"])])),_:1})):E("v-if",!0),a("div",{class:p(["ptj-primary",F.model])},[(l(!0),s(i,null,m(c(r).data.cells,(e=>(l(),n(Jt,{key:e.name,field:e},{default:C((()=>["asset"==e.meta.type?(l(),n(At,{key:0,type:c(r).type,field:e},null,8,["type","field"])):"number"==e.meta.type?(l(),n(ot,{key:1,type:c(r).type,field:e},null,8,["type","field"])):"flag"==e.meta.type?(l(),n(ht,{key:2,type:c(r).type,field:e},null,8,["type","field"])):"id"==e.meta.type?(l(),n(yt,{key:3,type:c(r).type,field:e},null,8,["type","field"])):"time"==e.meta.type?(l(),n(St,{key:4,type:c(r).type,field:e},null,8,["type","field"])):"string"==e.meta.type?(l(),n(je,{key:5,type:c(r).type,field:e},null,8,["type","field"])):E("v-if",!0)])),_:2},1032,["field"])))),128)),"edit"==c(r).type?(l(),s("input",{key:0,type:"submit",value:"Submit",class:"ptj-form-submit",onClick:h})):E("v-if",!0)],2),a("div",ml,[(l(!0),s(i,null,m(c(H).route.children,(e=>(l(),n(Q,{key:e,route:{model:e,state:"parent",key:F.key}},{default:C((()=>[_(g(e),1)])),_:2},1032,["route"])))),128))])],64))},__file:"presstojam/src/components/ptj-primary.vue"};const gl={class:"ptj-account-handler"},yl=["onSubmit"],vl=a("input",{type:"submit",value:"Submit",class:"ptj-form-submit"},null,-1),bl=["onSubmit"],kl=a("input",{type:"submit",value:"Submit",class:"ptj-form-submit"},null,-1);var jl={props:{actions:[]},setup(e){const t=f({state:"login",active:!0,login_data:new Be,register_data:new Be,globalerror:""});function r(){return t.active=!1,t.globalerror="","login"==t.state?B.post("/data/"+F.route+"/"+F.model+"/login",t.login_data.serialize("login")).then((e=>{K()})).catch((e=>{t.globalerror="Incorrect username / password"})):B.post("/data/"+F.route+"/"+F.model,t.register_data.serialize("post")).then((e=>{K()})).catch((e=>{t.register_data.applyErrors(e)}))}return B.post("/route/"+F.route+"/"+F.model).then((e=>{let l=new Me;l.map(e.fields),t.register_data.applyMetaRow(l)})),B.post("/route/"+F.route+"/"+F.model+"/login").then((e=>{let l=new Me;l.map(e.fields),t.login_data.applyMetaRow(l)})),(e,o)=>(l(),s("div",gl,[d(a("form",{onSubmit:A(r,["prevent"]),class:"ptj-login"},[d(a("div",{class:"ptj-form-error"},g(c(t).globalerror),513),[[h,c(t).globalerror]]),(l(!0),s(i,null,m(c(t).login_data.cells,(e=>(l(),n(Jt,{key:e.meta.name,field:e},{default:C((()=>[S(je,{type:"edit",field:e},null,8,["field"])])),_:2},1032,["field"])))),128)),vl],40,yl),[[h,"login"==c(t).state]]),d(a("form",{onSubmit:A(r,["prevent"]),class:"ptj-register"},[d(a("div",{class:"ptj-form-error"},g(c(t).globalerror),513),[[h,c(t).globalerror]]),(l(!0),s(i,null,m(c(t).register_data.cells,(e=>(l(),n(Jt,{key:e.meta.name,field:e},{default:C((()=>["number"==e.meta.type?(l(),n(ot,{key:0,type:"edit",field:e},null,8,["field"])):"flag"==e.meta.type?(l(),n(ht,{key:1,type:"edit",field:e},null,8,["field"])):"time"==e.meta.type?(l(),n(St,{key:2,type:"edit",field:e},null,8,["field"])):"string"==e.meta.type?(l(),n(je,{key:3,type:"edit",field:e},null,8,["field"])):E("v-if",!0)])),_:2},1032,["field"])))),128)),kl],40,bl),[[h,"create"==c(t).state]])]))},__file:"presstojam/src/components/ptj-account-handler.vue"};const wl=a("div",null,"Loading ...",-1);var xl={setup(e){const r=t((()=>H.component?"ptj-primary"==H.component?_l:"ptj-repo"==H.component?dl:"ptj-account-handler"==H.component?jl:void 0:null));return k((()=>(q(),Y()))),(e,t)=>(l(),s(i,null,[S(Ee),(l(),n(R,null,{default:C((()=>[a("div",{class:p([Map.model,Map.state])},[a("h1",null,g(c(H).title),1),c(r)?(l(),n(T(c(r)),{key:0})):E("v-if",!0)],2)])),fallback:C((()=>[wl])),_:1}))],64))},__file:"presstojam/src/components/ptj-router.vue"};const Sl={class:"ptj-account-details"},Cl={class:"ptj-nav"},Ol={key:0};var Al={setup:e=>(e,t)=>(l(),s(i,null,[a("div",Sl,["public"!=c(we).user?(l(),s("a",{key:0,class:"ptj-account-details-logout",onClick:t[0]||(t[0]=(...e)=>c(Se)&&c(Se)(...e))},"Logout")):E("v-if",!0)]),a("div",Cl,[(l(!0),s(i,null,m(c(xe).cats,((e,t)=>(l(),s("div",{key:t},[e.length>1?(l(),s("span",Ol,g(t),1)):E("v-if",!0),(l(!0),s(i,null,m(e,(e=>(l(),n(Q,{route:{route:e.route,model:e.model,state:e.state,key:0},key:e.route},{default:C((()=>[_(g(e.route),1)])),_:2},1032,["route"])))),128))])))),128))]),S(xl),c(we).login?(l(),n(N,{key:0})):E("v-if",!0)],64))};function El(e={}){if(e||(e={}),!e.client)throw"Must set client settings";if(!e.client.url)throw"No URL defined for client";return B.initSettings(e.client),e.map&&F.initSettings(e.map),function(e){e&&(X=e)}(e.models),function(e=""){return B.get("/core/check-user").then((e=>e.is_expired?B.put("/core/switch-tokens").then((()=>B.get("/core/check-user"))):e)).then((t=>{if(we.user=t.user,we.role=t.role,we.init=!0,we.role!=e){let t="/core/change-role";return e&&(t+="/"+e),B.post(t).then((t=>{we.role=e}))}})).then((()=>{Ce()})).catch((e=>console.log(e)))}(e.user&&e.user.role?e.user.role:"")}function Pl(e,t){El(t).then((()=>Oe())).then((()=>{const t=V(Al);return t.mount(e),t})).catch((e=>{console.log(e)}))}function Ul(e,t){El(t).then((()=>{const t=V(xl);return t.mount(e),t})).catch((e=>{console.log(e)}))}function Ll(e){if(!e.client)throw"Must set client settings";if(!e.client.url)throw"No URL defined for client";return B.initSettings(e.client),B}Al.__file="presstojam/src/components/ptj-user.vue";export{Ll as getClient,Pl as runApp,Ul as runRoute};
//# sourceMappingURL=ptj.esm.js.map
