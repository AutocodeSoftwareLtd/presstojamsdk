"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("vue");let t,s,r,a={},l={},o=!0;var n={regCustomHeader(e,t){a[e]=t},regStatusHandler(e,t){l[e]=t},setURL(e){t=e},regDebug(e){o=e},run:(e,i)=>(i.mode="cors",i.cache="no-cache",i.credentials="include",i["Content-Type"]="application/json",i.headers=a,fetch(t+e,i).then((e=>{if(s=e.status,r=e.ok,!l[e.status])return 401==e.status?e.status:e.json();l[e.status](e)})).then((a=>{if(!r)throw a;if(401==s){let s=i.method;return i.method="PUT",fetch(t+"/core-switch-tokens",i).then((r=>{if(r.ok)return i.method=s,fetch(t+e,i).then((e=>{if(401==e.status)throw new Error("Issue with refresh token");if(e.ok)return e.json()}))}))}return a})).catch((e=>{throw o&&console.log(e),e}))),setDebug:e=>(e?e.__debug=!0:e={__debug:!0},e),get(e,t){if(o&&(t=this.setDebug(t)),t){const s=new URLSearchParams;let r={};for(let e in t)Array.isArray(t[e])||"object"==typeof t[e]&&null!==t[e]?r[e]=t[e]:s.append(e,t[e]);r&&s.append("graph",JSON.stringify(r)),-1==e.indexOf("?")?e+="?":e+="&",e+=s.toString()}let s={method:"GET"};return this.run(e,s)},getprimary(e,t){return this.get(e,t)},post(e,t){o&&(t=this.setDebug(t));let s={method:"POST"};return s.body=JSON.stringify(t),this.run(e,s)},put(e,t){o&&(t=this.setDebug(t));let s={method:"PUT"};return s.body=JSON.stringify(t),this.run(e,s)},patch(e,t){o&&(t=this.setDebug(t));let s={method:"PATCH"};return s.body=JSON.stringify(t),this.run(e,s)},delete(e,t){o&&(t=this.setDebug(t));let s={method:"DELETE"};return s.body=JSON.stringify(t),this.run(e,s)}};const p={1:"too small",2:"too large",3:"contains incorrect characters",4:"doesn't contain required characters",5:"not unique"};var c={getError:function(e){return p[e]}};class d{constructor(){this._min,this._max,this._has=[],this._has_not=[],this._errors={OK:0,MIN_VALUE:1,MAX_VALUE:2,HAS:3,HAS_NOT:4}}set min(e){this._min=e}set max(e){this._max=e}set has(e){this._has.push(e)}set nothas(e){this._has_not.push(e)}validateSize(e){return e<this._min?this._errors.MIN_VALUE:e>this._max?this._errors.MAX_VALUE:this._errors.OK}validate(e){let t;if(isNaN(e)){const s=e?e.length:0;t=this.validateSize(s)}else t=this.validateSize(e);if(t!=this._errors.OK)return t;for(let t of this._has_not)if(e.match(t))return this._errors.HAS_NOT;if(0==this._has.length)return this._errors.OK;for(let t of this._has)if(e.match(this._has))return this._errors.OK;return this._errors.HAS}}class m{constructor(t,s=null){if(this._name=t,this._type="",this._is_primary=!1,this._is_parent=!1,this._valid=1,this._atts={},this._confirm=!1,this._readonly=!1,this._placeholder="",this._conditions,this._link="",this._reference="",this._error=0,this._label="",this._store=e.reactive({summary:0,options:[]}),this._default=null,this._validator=new d,this._multiple=!1,this._encrypted=!1,this.summary=e.computed({get:()=>this._store.summary,set:e=>{this._store.summary=e}}),this.options=e.computed({get:()=>this._store.options,set:e=>{this._store.options=e}}),s){for(let e in s)if("summary"==e)this._store.summary=s[e];else{if("validation"==e)continue;this[e]=s[e]}if(s.validation)for(let e in s.validation)this._validator[e]=s.validation[e]}if(!this._reference&&"select"==this._type){this._store.options=[];try{for(let e of this._atts.options)this._store.options.push({key:e,value:e})}catch(e){console.log("options not set for ",this._name)}}}set confirm(e){this._confirm=e}set readonly(e){this._readonly=e}set placeholder(e){this._placeholder=e}set atts(e){this._atts=e}set default(e){this._default=e}set asset(e){this._asset=e}set conditions(e){this._conditions=e}set link(e){this._link=e}set name(e){this._name=e}set type(e){this._type=e.toLowerCase()}set multiple(e){this._multiple=e}set is_primary(e){this._is_primary=e}set is_parent(e){this._is_parent=e}set reference(e){this._reference=e}set error(e){this._error=e}set label(e){this._label=e}set encrypted(e){this._encrypted=e}get name(){return this._name}get type(){return this._type}get isprimary(){return this._is_primary}get required(){return this._min>0}get readonly(){return this._readonly}get placeholder(){return this._placeholder}get default(){return this._default}get atts(){return this._atts}get conditions(){return this._conditions}get link(){return this._link}get isparent(){return this._is_parent}get multiple(){return this._multiple}get confirm(){return this._confirm}get reference(){return this._reference}get asset(){return this._asset}get encrypted(){return this._encrypted}get error(){return this._error?isNaN(this._error)?this._error:c.getError(this._error):""}get validator(){return this._validator}get label(){return this._label}isSummary(){return this._store.summary}saveAsset(e){if(this._asset){if(this.val)return this._asset.saveFile(this.val,e)}return Promise.resolve()}setReferenceOptions(e,t){return this._store.options=[],n.get(e,t).then((e=>{for(let t in e.__data)0!==t.indexOf("__")&&this._store.options.push({key:e.__data[t].key,value:e.__data[t].value})})).catch((e=>{console.log(e)}))}clean(e){return"checkbox"==this._type?e?1:0:e}validate(e){return this._validator.validate(e)}exp(){return{name:this._name,type:this._type,atts:this._atts}}calcValue(e){return e||""}}class h{constructor(){this._fields={},this._primary,this._parent,this._children={}}set field(e){this._fields[e.name]=e}get fields(){return this._fields}addChild(e,t){this._children[e]=t}get children(){return this._children}get parent(){return this._parent}get primary(){return this._primary}map(e){for(let t in e)e[t].is_primary?this._primary=new m(t,e[t]):e[t].is_parent?this._parent=new m(t,e[t]):this._fields[t]=new m(t,e[t])}exportFields(e,t){let s=this._states[e].fields;t.fields=[];for(let e in s)(0==this._limit_fields.length||this._limit_fields.contains(e))&&t.fields.push(s[e])}exportToStore(e){e.fields=this._fields}getCellByType(e){let t={};for(let s in this._fields)this._fields[s].type==e&&(t[s]=this._fields[s]);return t}}class _{constructor(t){this._meta=t,this._store=e.reactive({value:null,display:null,error:0,is_validate_on:!1}),this.val=e.computed({get:()=>this._store.value,set:e=>{this._store.value=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.error=e.computed({get:()=>this._store.error,set:e=>{this._store.error=e}}),this.showError=e.computed((()=>!(!this._store.is_validate_on||!this._store.error))),this._meta.default?this._store.value=this._meta.default:"select"==this._meta.type&&(this._store.value=0)}get meta(){return this._meta}set validateon(e){this._store.is_validate_on=e}set display(e){this._store.display=e}get display(){return this._store.display?this._store.display:this._store.value}toString(){return this._store.display}toVal(){return this._store.value}setVal(e){this._store.value=e}}class u extends _{constructor(t){super(t),"datetime"==this._meta.atts.type?(this._store.value={min:null,max:null},this.val=e.computed({get:()=>this._store.value,set:e=>{e.min&&(this._store.value.min=this._meta.clean(e.min)),e.max&&(this._store.value.max=this._meta.clean(e.max)),this._store.error=this._meta.validate(e)}}),this.val1=e.computed({get:()=>this._store.value.min,set:e=>{this._store.value.min=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.val2=e.computed({get:()=>this._store.value.max,set:e=>{this._store.value.max=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.addParam=e=>{let t={};this._store.value.min&&(t.min=this._store.value.min),this._store.value.max&&(t.max=this._store.value.max),Object.keys(t).length>0&&(e[this._meta.name]=t)}):"checkbox"==this._meta.type?(this._store.value=0,this.addParam=e=>{1==this._store.value?e[this._meta.name]=1:2==this._store.value&&(e[this._meta.name]=0)}):"select"==this._meta.type?(this._store.value=[],this.addParam=e=>{this._store.value.length>0&&(e[this._meta.name]=this._store.value)}):this.addParam=e=>{this._store.value&&(e[this._meta.name]=["%"+this._store.value+"%"])}}}class f{constructor(e){this._cells={},this._primary,this._parent,this._limit=0,this._page=0,this._fields=[],this._sort={},this._groups=[],this._children=[],this._active,this._max_pages=0,this._count=0,e&&this.applyMetaRow(e)}applyMetaRow(e){e.primary&&(this._primary=new _(e.primary)),e.parent&&(this._parent=new _(e.parent));for(const t in e.fields){const s=e.fields[t];this._cells[s.name]=new u(s)}}get cells(){return this._cells}initField(e){this._data.initField(e)}set fields(e){this._fields=e}get fields(){return this._fields}set limit(e){this._limit=e}get limit(){return this._limit}set sort(e){this._sort=e}get sort(){return this._sort}set page(e){this._page=e}get page(){return this._page}set groups(e){this._groups=e}get groups(){return this._groups}set children(e){this._children=e}get children(){return this._children}get primary(){return this._primary}get parent(){return this._parent}get active(){return this._active}set active(e){this._active=e}get max_pages(){return this._max_pages}set max_pages(e){this._max_pages=e}get count(){return this._count}set count(e){this._count=e}convertToParams(){let e={};this._limit&&(e._limit=this._limit),this._page&&(e._page=this._page),this._fields.length>0&&(e._fields=this._fields),Object.keys(this._sort).length>0&&(e._sort=this._sort);for(let t in this._cells){let s=this._cells[t].toVal();s&&(e[t]=s)}return JSON.stringify(e)}convertDataToParams(){let e={};for(let t in this._cells)e[t]=this._cells[t].toVal();return Object.keys(e).length>0?JSON.stringify(e):null}convertFromParams(e){const t=JSON.parse(e);t._limit&&(this._limit=t._limit),t._fields&&(this._fields=t._fields),t.hasOwnProperty("_page")&&(this._page=t._page),t.hasOwnProperty("_sort")&&(this._sort=t._sort);for(const e in this._cells)t.hasOwnProperty(e)&&this._cells[e].setVal(t[e])}convertToAPIParams(e){let t={};this._limit&&(t.__limit=this._limit),this._page&&(t.__page=this._page*this._limit),this._fields.length>0&&(t.__fields=this._fields),Object.keys(this._sort).length>0&&(t.__sort=this._sort);for(let e in this._cells)this._cells[e].addParam(t);return"parent"==e||"post"==e?this._parent&&this._parent.toVal()&&(t[this._parent.meta.name]=this._parent.toVal()):"login"!=e&&(t[this._primary.meta.name]=this._primary.toVal()),Object.keys(t).length?t:null}}class g{constructor(e){this._cells={},this._references={},this._children={},this._parent,this._primary,e&&this.applyMetaRow(e)}applyMetaRow(e){e.primary&&(this._primary=new _(e.primary)),e.parent&&(this._parent=new _(e.parent));for(const t in e.fields){const s=e.fields[t];this._cells[s.name]=new _(s)}for(const t in e.references)this._references[t]=new g(e.references[t]);for(const t in e.children)this._children[t]=e.children[t]}appendPrimary(e){this._primary=new _(e)}addChild(e,t){this._children[e]||(this._children[e]=[]),this._children[e].push(t)}set row(e){if(e){this._primary&&e[this._primary.meta.name]&&this._primary.setVal(e[this._primary.meta.name]),this._parent&&e[this._parent.meta.name]&&this._parent.setVal(e[this._parent.meta.name]);for(let t in this._cells)e[t]&&this._cells[t].setVal(e[t]);for(let t in this._references)this._references[t].row=e[t];for(let t in this._children)this._children[t].row=e[t];this._parent&&this._references[this._parent.meta.reference]&&(this._parent.display=this._references[this._parent.meta.reference].getSummary());for(let e in this._cells){let t=this._cells[e].meta;t.reference&&this._references[t.reference]&&(this._cells[e].display=this._references[t.reference].getSummary())}}}get cells(){return this._cells}get parent(){return this._parent}get primary(){return this._primary}get children(){return this._children}getCell(e){return this._primary&&this._primary.meta.name==e?this._primary:this._parent&&this._parent.meta.name==e?this._parent:this._cells[e]}getSummary(){let e=[];for(let t in this._cells){const s=this._cells[t];if(s.meta.isSummary()){const t=s.display;e.push(t)}}return e.join(" ")}toString(){let e=[];for(let t in this._cells)e.push(this._cells[t].display);return e.join(" ")}serialize(e){let t={};"post"==e?this._parent&&(t[this._parent.meta.name]=this._parent.toVal()):"put"!=e&&"delete"!=e||(t[this._primary.meta.name]=this._primary.toVal());for(let e in this._cells)t[e]=this._cells[e].toVal();return t}getCellByType(e){let t={};for(let s in this._cells)this._cells[s].meta.type==e&&(t[s]=this._cells[s]);return t}}let v={orig:0,target:0,state:null,key:null,to:null,model:null,end:null,param_str:{}};var k={updateIntention:function(e,t){!function(){for(let e in v)v[e]=null}(),v.orig=parseInt(e);for(let e in t)v[e]=t[e]},convertMaps:function(e){let t=v.orig+v.target;t<0?e.unshift({...e[i]}):t>=e.length&&e.push({...e[e.length-1]});for(let s in v)null!==v[s]&&("_end"==s?e.splice(t+1,e.length):e[t][s]=v[s])}};class j{constructor(t,s){this._map=t,this._stage=s,this._label="",this._title="",this._component="",this._rawcomponent="",this._actions={},this._next=null,this._index=0,this._primary_key_name="",this._parent_key_name="",this._circular="",this._siblings=[],this._children=[],this._groups=[],this._classes="",this._settings={hide_actions:{}},this._meta_row=new h,this._global_meta_row=new h,this._data_template=null,this._data=null,this._global_data,this._store=e.reactive({}),this._back}get map(){return this._map}get stage(){return this.store.stage}injectCustomSettings(e){this._settings=e,this._settings.hide_actions||(this._settings.hide_actions={})}init(){let e=this._map.model?"/route-"+this._map.model:"/route-core-default",t="get";"primary"==this._map.state||"parent"==this._map.state?e+="-"+this._map.state:"login"==this._map.state?(e+="-"+login,t="post"):"put"!=this._map.state&&"post"!=this._map.state||(t=this._map.state);let s={};return this._settings&&this._settings.to?s.__to=this._settings.to:this._map.to&&(s.__to=this._map.to),n[t](e,s).then((e=>{if("SUCCESS"!=e.__status)throw new Error(e);return e})).then((e=>{this._map.state=e.state,this._map.model=e.model,this._label=e.label,this._title=e.title,this._back=e.back;for(let t in e.children)this._children.push({name:t,label:e.children[t]});for(let t in e.siblings)this._siblings.push({name:t,label:e.siblings[t]});for(let t in e.fields)e.fields[t].circular&&(this._circular=t);this._actions=e.actions,this.buildMetaRow(e)})).catch((e=>console.log(e)))}get fields(){return this._fields}get classes(){return this._name.replace("_","-")+" "+this._map.state}snakeCase(e){return e.replace("-","_")}buildMetaRow(e){this._meta_row=new h,this._meta_row.map(e.fields);let t={};for(let s in e.fields)(e.fields[s].is_primary||e.fields[s].is_parent)&&(t[s]=e.fields[s]);this._global_meta_row.map(t)}loadURL(e){let t="/"+this._map.model;return"primary"==e||"put"==e?t+="-primary":"parent"==e&&(t+="-parent"),t}saveURL(){return"/"+this._map.model}initDataTemplate(){this._data_template=new f(this._meta_row),"get"==this._map.state||"parent"==this._map.state?"first"==this._map.key?this._data_template.limit=1:this._map.key&&this._data_template.parent.setVal(this._map.key):"post"==this._map.state?(this._global_data=new g(this._global_meta_row),this._map.key&&(this._data_template.parent.setVal(this._map.key),this._global_data.parent.setVal(this._map.key))):"login"!=this._map.state&&this._data_template.primary.setVal(this._map.key),this._map.param_str&&this._data_template.convertFromParams(this._map.param_str),this._settings.groups&&(this._data_template.groups=this._settings.groups),this._settings.limit&&(this._data_template.limit=this._settings.limit)}load(){if(this.initDataTemplate(),"get"==this._map.state||"parent"==this._map.state){let e=this._data_template.convertToAPIParams(this._map.state);return e||(e={}),this._settings&&this._settings.to?e.__to=this._settings.to:this._map.to&&(e.__to=this._map.to),this._settings.fields&&(e||(e={}),e.__fields=this._settings.fields),console.log(e),this._data_template.limit>0?n.get(this.loadURL(this._map.state)+"-count",e).then((e=>{this._data_template.count=e.count,this._data_template.max_pages=Math.ceil(e.count/this._data_template.limit)})).then((()=>n.get(this.loadURL(this._map.state),e))).then((e=>{if("SUCCESS"!=e.__status)throw new Error(e);return this._data=[],this.mapRepoData(e),e})):n.get(this.loadURL(this._map.state),e).then((e=>{if("SUCCESS"!=e.__status)throw new Error(e);return this._data_template.count=e.__data.length,this._data=[],this.mapRepoData(e),e}))}if("primary"==this._map.state||"put"==this._map.state){let e=this._data_template.convertToAPIParams(this._map.state);return this._map.to&&(e.__to=this._map.to),n.get(this.loadURL(this._map.state),e).then((e=>{if("SUCCESS"!=e.__status)throw new Error(e);return this._data={},this.mapData(e),e})).then((e=>{if(this._global_data=new g(this._global_meta_row),this._global_data.row=e,"put"==this._map.state)return this.setReferences()}))}return"post"==this._map.state?(this._data=new g(this._meta_row),this._data_template.parent&&this._data.parent.setVal(this._data_template.parent.toVal()),this.setReferences()):(this._data=new g(this._meta_row),Promise.resolve())}reload(){this._data_template.page=0;let e=this._data_template.convertToAPIParams("get");return this._map.to&&(e.__to=this._map.to),n.get(this.loadURL("get")+"-count",e).then((e=>{this._data_template.count=e.count,this._data_template.max_pages=Math.ceil(e.count/this._data_template.limit)})).then((()=>n.get(this.loadURL("get"),e))).then((e=>{if("SUCCESS"!=e.__status)throw new Error(e);return this._data=[],this.mapRepoData(e),e})).then((()=>{this._store.data=this._data,this._store.data_template=this._data_template.count}))}rLoadObj(e){let t=new g(this._meta_row);if(t.row=e,this._circular&&e[this._map.model])for(const s in e[this._map.model])t.addChild(this._map.model,this.rLoadObj(e[this._map.model][s]));for(const s in this._active_children){const r=this._active_children[s];if(e[r])for(const s in e[r])t.addChild(r,this.rLoadObj(e[r][s]))}return t}indexData(e){let t={};for(const s in e){const r=e[s];for(let e of this._data_template.groups){e=this.snakeCase(e),t[e]||(t[e]={});let a=r.getCell(e).toVal();t[e][a]||(t[e][a]={display:"",contains:[]},t[e][a].display=r.getCell(e).display),t[e][a].contains.push(s)}}return t}import(e){return new Promise(((t,s)=>{var r=new FileReader;r.onload=()=>{t(r.result)},r.onerror=s,r.readAsText(e.blob)})).then((e=>{const t={};for(let s in e[0])t[e[0][s]]=s;for(let t=1;t<e.length;++t);}))}submit(){let e=0,t=this._data.serialize(this._map.state);return n[this._map.state](this.saveURL(),t).then((t=>{if("SUCCESS"!=t.__status)throw{message:t.statusText};"post"==this._map.state&&(e=t.__key)})).then((()=>{let e=[],t=this._store.data.getCellByType("asset");this._store.progress.total=0;for(let s in t){if(!t[s].toVal())continue;++this._store.progress.total;const r=new Asset;r.url=this.saveURL()+"-"+s,r.keyfield=this._store.data.primary.name;let a=r.saveFile(t[s].toVal(),this._store.data.primary.toVal()).then((()=>{++this._store.progress.progress}));e.push(a)}return Promise.all(e)})).then((()=>e))}setReferences(){let e=[];const t=this._meta_row.getCellByType("id");for(let s in t)if(t[s].reference||t[s].circular){let r={};this._global_meta_row.parent&&(r[this._global_meta_row.parent.name]=this._global_data.parent.toVal()),e.push(t[s].setReferenceOptions("/"+this._map.model+"-"+s.replace("_","-")+"-reference",r))}return Promise.all(e)}mapRepoData(e){this._data=[];for(const t in e.__data){const s=this.rLoadObj(e.__data[t]);this._data.push(s)}this._data_template.groups.length>0&&(this._indexes=this.indexData(this._data))}mapData(e){this._data=new g(this._meta_row),this._data.row=e}buildLink=e=>t=>{t&&(e.key=t);for(let t in this._settings.change_intention)e[t]=this._settings.change_intention[t];return k.updateIntention(this._stage,e),Promise.resolve()};exportToStore(){if(this._store.actions=[],this._store.stage=this._stage,this._store.component="",this._store.rawcomponent="",this._store.title=this._title,this._store.label=this._label,this._store.action=this._map.state,this._store.method=this._store.action,this._store.submiturl=this.saveurl,this._store.model=this._map.model,this._store.classes=this._map.model+" "+this._map.state,this._store.groups=this._data_template.groups,this._store.settings||(this._store.settings={}),this._settings.disable_filter&&(this._store.disable_filter=!0),this._settings.disable_selectfields&&(this._store.disable_selectfields=!0),"get"==this._map.state||"parent"==this._map.state){if(this._store.rawcomponent=this._data_template.groups.length>0?"ptj-list":this._circular||this._data_template.children.length>0?"ptj-tree":"ptj-table",this._store.component="ptj-repo",this._store.index=this._map.model+"-get",this._store.submiturl=this.loadurl,this._store.count=this._data_template.count,this._store.reload=()=>{this.buildLink({param_str:this._data_template.convertToParams()})().then((()=>{this.reload()}))},this._back&&!this._settings.hide_actions.parent&&this._store.actions.push({r:this.buildLink({model:this._back.model,state:"primary",key:this._data_template.parent.toVal()}),n:"go back"}),this._actions.post&&!this._settings.hide_actions.post&&this._store.actions.push({r:this.buildLink({state:"post"}),n:this._actions.post}),this._actions.primary?this._store.next=this.buildLink({param_str:"",state:"primary"}):this._actions.put&&(this._store.next=this.buildLink({param_str:"",state:"put"})),this._store.siblings=[],!this._settings.hide_actions.children)for(let e of this._siblings)this._store.siblings.push({r:this.buildLink({model:e.name,param_str:""}),n:e.label});this._data_template.limit>0&&(this._store.setPage=e=>{this._store.data_template.page=e,this.buildLink({param_str:this._data_template.convertToParams()})().then((()=>{this.reload()}))})}else if("primary"==this._map.state){if(this._store.component="ptj-single-item",this._store.actions=[],this._store.index=this._map.model+"-primary",this._back&&this._settings.hide_actions.parent,this._actions.put&&!this._settings.hide_actions.put&&this._store.actions.push({r:this.buildLink({state:"put"}),n:this._actions.put}),this._actions.delete&&!this._settings.hide_actions.delete&&this._store.actions.push({r:()=>{if(confirm("Are you sure you want to delete this record and all associated children?")){let e={};return e[this._meta_row.primary.name]=this._data.primary.toVal(),n.delete(this.saveURL(),e).then((()=>{let e={state:"get"};return this._global_data.parent&&(e.key=this._global_data.parent.toVal()),this.buildLink(e)()}))}return Promise.reject("Delete cancelled")},n:this._actions.delete}),this._store.children=[],!this._settings.hide_actions.children)for(let e of this._children)this._store.children.push({r:this.buildLink({state:"parent",model:e.name}),n:e.label})}else if("post"==this._map.state)this._store.component=this._actions.login?"ptj-account-handler":"ptj-form",this._store.index=this._map.model+"-post",this._store.progress={total:0,progress:0},this._store.actions=[],this._actions.login&&this._store.actions.push({r:this.buildLink({state:"login"}),n:this._actions.login}),this._store.next=e=>{let t="";return this._actions.parent?t="parent":this._actions.get?t="get":this._actions.primary&&(t="primary"),this.buildLink({state:t,active:e})()},this._store.submit=()=>this.submit("post");else if("put"==this._map.state){if(this._store.component="ptj-form",this._store.progress={total:0,progress:0},this._store.index=this._map.model+"-put",this._store.actions=[],this._actions.primary)this._store.next=this.buildLink({state:"primary"});else{let e={state:"get"};this._global_data.parent&&(e.key=this._global_data.parent.toVal()),this._store.next=this.buildLink(e)}this._store.submit=()=>this.submit("put")}else"login"==this._map.state&&(this._store.component="ptj-account-handler",this._store.index=this._map.model+"-login",this._store.progress={total:0,progress:0},this._store.submit=()=>{let e=this._data.serialize("login");return n.post(this.saveURL()+"-login",e).then((e=>{if("SUCCESS"!=e.__status)throw{message:e.statusText};return e}))},this._store.actions=[],this._actions.post&&this._store.actions.push({r:this.buildLink({state:"post"}),n:this._actions.post}));return this._store.data=this._data,this._store.indexes=this._indexes,this._store.data_template=this._data_template,this._meta_row.exportToStore(this._store),this._store}}const y={post:"-create",put:"-update",delete:"-delete",login:"-login",logout:"-logout",primary:"-primary",parent:"-parent",get:""};class b{constructor(){this._model,this._state="",this._key=0,this._to,this._param_str}set model(e){this._model=e}get model(){return this._model}set state(e){this._state=e}get state(){return this._state}set key(e){this._key=e}get key(){return this._key}set to(e){this._to=e}get to(){return this._to}set param_str(e){this._param_str=e}get param_str(){return this._param_str}copy(){return{model:this._model,state:this._state,key:this._key,to:this._to,param_str:this._param_str}}matches(e){return this._model==e.model&&(this._state==e.state&&this._to==e.to)}convertToURL(){let e=this._model,t=this._state,s=this._key,r=this._to,a=e+y[t];return s&&(a+="-"+s),r&&(a+="-to-"+r),a}convertFromURL(e){if(!e)return;let t=e.split("-to-");t.length>1&&(this._to=t[1],e=t[0]),t=e.split("-");let s=t[t.length-1];if("first"==s?(this._key=s,t.pop()):isNaN(s)||(this._key=s,t.pop()),0==t.length)throw new Error("Can't convert this url string: "+e);this._state="get";for(let e in y)if(y[e]=="-"+t[t.length-1]){this._state=e,t.pop();break}this._model=t.join("-")}}let C=[],B=null,w="/";function E(){let e=new b;return C.push(e),e}var x={trigger:function(e){B=e},resetMaps:function(){C=[]},createMap:E,convertToURL:function(){let e=[];for(let t of C)e.push(t.convertToURL());const t=new URL(window.location.protocol+"//"+window.location.host+w),s=e.join("/"),r=new URL(s,t);for(let e in C)C[e].param_str&&r.searchParams.set("stage_"+e,C[e].param_str);return r},convertFromURL:function(e){let t=e.pathname.replace(w,"");t=t.replace(/^\/+|\/+$/g,"");let s=t.split("/");C=[];for(let e in s){E().convertFromURL(s[e])}const r=e.searchParams;for(let e in C){const t=r.get("stage_"+e);t&&(C[e].param_str=t)}B&&B()},setBase:function(e){e=e.replace(/^\/+|\/+$/g,""),w="/"+e+"/"},getMaps:function(){return C}};let S;function V(e){e||(e=new URL(window.location.href)),S&&S(e,window.location.search)}window.onpopstate=function(e){V(new URL(document.location.href))};var N={setRoute:function(e,t=""){window.history.pushState({name:e.pathname},document.title,e),V(e)},hardSetRoute:function(e){window.location=e},runRoute:V,regCallback:function(e){S=e},softRoute:function(e,t=""){window.history.pushState({name:e.pathname},document.title,e)}};let D=e.reactive({models:[],profile:null}),L={},z=[],R=-1;function U(){R=-1;let e=x.getMaps();if(0==e.length)throw new Error("Error with controller run, no maps created");D.models=[];let t=[];z.length>e.length&&z.splice(e.length,z.length-e.length);for(let s in e){const r=e[s];if(s>=z.length||!r.matches(z[s].map)){const e=new j(r.copy(),s);z[s]=e,console.log("Settings are ",L,r),L&&L[r.model]&&L[r.model][r.state]&&e.injectCustomSettings(L[r.model][r.state]),t.push(e.init().then((()=>e.load())))}else t.push(z[s].load())}Promise.all(t).then((()=>{for(let e of z)D.models.push(e.exportToStore())})).catch((e=>{console.log(e)}))}x.trigger((()=>{U()})),N.regCallback(x.convertFromURL);var T={store:D,models:z,setSettings:function(e){if(e.client){if(n.setURL(e.client.url),e.client.custom_headers)for(let t in e.client.custom_headers)n.regCustomHeader(t,e.client.custom_headers[t]);e.client.debug&&n.regDebug(!0),n.regStatusHandler(403,(function(){alert("Page not found")}))}e.mapper&&e.mapper.base&&x.setBase(e.mapper.base),e.models&&(L=e.models)},initProfile:function(){return n.get("/core-check-user").then((e=>(D.profile=e.__profile,D.profile)))},assumeRole:function(e){return n.post("/core-assume-role",{role:e}).then((e=>(D.profile=e.__profile,D.profile)))},removeRole:function(){return n.post("/core-remove-role").then((e=>(D.profile=e.__profile,D.profile)))},run:U,buildLink:function(e=!1){x.resetMaps();let t=[];for(let e in z){let s=z[e];t.push({...s.map})}k.convertMaps(t);for(const e of t){let t=x.createMap();for(let s in e)t[s]=e[s]}let s=x.convertToURL();e?N.softRoute(s):N.setRoute(s)},runLink:function(){x.runRoute()},runData:function(e=null){e||(e=new URL(window.location.href)),x.convertFromURL(e)},reloadFromBase:function(){x.resetMaps();let e=x.convertToURL();N.setRoute(e)},getStore:function(){return D.models[R]},next:function(){++R},runRoute:function(e,t,s){return n[e](t,s)}};let O={"ptj-account-details-logout":"ptj-account-details-logout","ptj-account-handler":"ptj-account-handler","ptj-breadcrumbs":"ptj-breadcrumbs","ptj-card":"ptj-card","ptj-card-row":"ptj-card-row","ptj-card-label":"ptj-card-label","ptj-card-value":"ptj-card-value","ptj-form":"ptj-form","ptj-form-title":"ptj-form-title","ptj-form-error":"ptj-form-error","ptj-form-group":"ptj-form-group","ptj-form-submit":"ptj-form-submit","ptj-root":"ptj-root","ptj-tabs":"ptj-tabs","ptj-tabs-card":"ptj-tabs-card","ptj-tabs-tab":"ptj-tabs-tab","ptj-repo":"ptj-repo","ptj-nav":"ptj-nav","ptj-nav-link":"ptj-nav-link","ptj-single-item":"ptj-single-item","ptj-single-item-row":"ptj-single-item-row","ptj-single-item-label":"ptj-single-item-label","ptj-single-item-value":"ptj-single-item-value","ptj-single-item-actions":"ptj-single-item-actions","ptj-single-item-children":"ptj-single-item-children","ptj-widget-window":"ptj-widget-window","ptj-widget-window-header":"ptj-widget-window-header","ptj-widget-window-title":"ptj-widget-window-title","ptj-widget-window-toggle":"ptj-widget-window-toggle","ptj-widget-window-body":"ptj-widget-window-body","ptj-repo-header-title":"ptj-repo-header-title","ptj-repo-header-actions":"ptj-repo-header-actions","ptj-tree":"ptj-tree","ptj-form-row":"ptj-form-row","ptj-form-input-row":"ptj-form-input-row","ptj-form-input-label":"ptj-form-input-label","ptj-form-input":"ptj-form-input","ptj-table":"ptj-table","ptj-table-header":"ptj-table-header","ptj-table-header-cell":"ptj-table-header-cell","ptj-table-row":"ptj-table-row","ptj-table-cell":"ptj-table-cell","ptj-table-cell-sortable":"ptj-table-cell-sortable","ptj-form-confirm-row":"ptj-form-confirm-row","ptj-form-confirm-label":"ptj-form-confirm-label","ptj-form-confirm":"ptj-form-confirm","ptj-pagination":"ptj-pagination","ptj-filter-form":"ptj-filter-form","ptj-filter-form-group":"ptj-filter-form-group","ptj-filter-form-submit":"ptj-filter-form-submit","ptj-form-select-row":"ptj-form-select-row","ptj-form-select-label":"ptj-form-select-label","ptj-form-select":"ptj-form-select","ptj-tree-node":"ptj-tree-node","ptj-tree-node-row":"ptj-tree-node-row","ptj-selectfields":"ptj-selectfields","ptj-selectfields-checkbox":"ptj-selectfields-checkbox","ptj-selectfields-label":"ptj-selectfields-label","ptj-form-radio-row":"ptj-form-radio-row","ptj-form-radio-label":"ptj-form-radio-label","ptj-form-radio-option-label":"ptj-form-radio-option-label","ptj-checkbox-row":"ptj-checkbox-row","ptj-checkbox-label":"ptj-checkbox-label","ptj-checkbox":"ptj-checkbox","ptj-form-textarea-row":"ptj-form-textarea-row","ptj-form-textarea-label":"ptj-form-textarea-label","ptj-form-textarea":"ptj-form-textarea","ptj-form-asset-row":"ptj-form-asset-row","ptj-form-asset-label":"ptj-form-asset-label","ptj-form-asset":"ptj-form-asset","ptj-progress-bar-wrapper":"ptj-progress-bar-wrapper","ptj-progress-bar-holder":"ptj-progress-bar-holder","ptj-progress-bar":"ptj-progress-bar","ptj-error":"ptj-error","ptj-filter-form-time-row":"ptj-filter-form-time-row","ptj-filter-form-time-label":"ptj-filter-form-time-label","ptj-filter-form-time-1":"ptj-filter-form-time-1","ptj-filter-form-time-2":"ptj-filter-form-time-2","ptj-filter-form-checkbox-row":"ptj-filter-form-checkbox-row","ptj-filter-form-checkbox-label":"ptj-filter-form-checkbox-label","ptj-filter-form-checkbox":"ptj-filter-form-checkbox","ptj-account-details-logout":"ptj-account-details-logout","ptj-accounthandler":"ptj-accounthandler","ptj-list":"ptj-list"};var P={regClass:function(e,t){O[e]=t},getClass:function(e){return O[e]}},A=e.defineComponent({name:"ptj-progress-bar",props:{total:Number,progress:Number},setup:()=>({Class:P}),computed:{num(){let e=Math.floor(this.progress/this.total*100);return isNaN(e)?0:e},style(){return"width:"+this.num+"%;"}}});function M(e,t){void 0===t&&(t={});var s=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===s&&r.firstChild?r.insertBefore(a,r.firstChild):r.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}M("\n.ptj-progress-holder[data-v-460b10ff] {\r\n     width : 100%;\r\n     min-height : 10px;\r\n     position : relative;\r\n     display : flex;\r\n     align-items: stretch;\r\n     padding : 2px;\n}\n.ptj-bar[data-v-460b10ff] {\r\n     width : 0;\r\n     height : 100%;\r\n     position : relative;\r\n     line-height : 100%;\n}\r\n\r\n\r\n"),A.render=function(t,s,r,a,l,o){return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(t.Class.getClass("ptj-progress-bar-wrapper"))},[e.createElementVNode("div",{class:e.normalizeClass(t.Class.getClass("ptj-progress-bar-holder")+" ptj-progress-holder")},[e.createElementVNode("div",{class:e.normalizeClass(t.Class.getClass("ptj-progress-bar")+" ptj-bar"),style:e.normalizeStyle(t.style)},"Â ",6)],2),e.createElementVNode("span",null,e.toDisplayString(t.num)+"%",1)],2)},A.__scopeId="data-v-460b10ff",A.__file="presstojam/src/components/ptj-progress-bar.vue";var F=e.defineComponent({name:"ptj-error",props:{error:[Number,String]},setup:()=>({Class:P})});M("\n.error {\r\n  color : red;\n}\r\n"),F.render=function(t,s,r,a,l,o){return e.openBlock(),e.createElementBlock("p",{class:e.normalizeClass(t.Class.getClass("ptj-error"))},e.toDisplayString(t.error),3)},F.__file="presstojam/src/components/ptj-error.vue";var I=e.defineComponent({props:{field:Object},setup:e=>({Class:P}),computed:{classes(){return P.getClass("ptj-form-row")+" "+this.field.meta.type}},components:{"ptj-error":F}});I.render=function(t,s,r,a,l,o){const i=e.resolveComponent("ptj-error");return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(t.classes)},[e.createElementVNode("label",{class:e.normalizeClass(t.Class.getClass("ptj-form-label"))},e.toDisplayString(t.field.meta.label),3),e.renderSlot(t.$slots,"default"),e.withDirectives(e.createVNode(i,{error:t.field.error},null,8,["error"]),[[e.vShow,t.field.showError]])],2)},I.__file="presstojam/src/components/ptj-form-row.vue";var H=e.defineComponent({name:"ptj-number",props:{field:Object,editable:{type:Boolean,default:!1},filter:{type:Boolean,default:!1}},setup:()=>({Class:P})});const J=["name","readonly"],q={key:1},X=["name","readonly"],W=e.createTextVNode(" - "),$=["name","readonly"],K={key:2};H.render=function(t,s,r,a,l,o){return t.editable?e.withDirectives((e.openBlock(),e.createElementBlock("input",{key:0,class:e.normalizeClass(t.Class.getClass("ptj-form-number")),name:t.field.meta.name,type:"number","onUpdate:modelValue":s[0]||(s[0]=e=>t.field.val=e),onBlur:s[1]||(s[1]=e=>t.field.validateon=!0),readonly:t.field.meta.readonly},null,42,J)),[[e.vModelText,t.field.val]]):t.filter?(e.openBlock(),e.createElementBlock("div",q,[t.editable?e.withDirectives((e.openBlock(),e.createElementBlock("input",{key:0,class:e.normalizeClass(t.Class.getClass("ptj-form-number")),name:t.field.meta.name,type:"number","onUpdate:modelValue":s[2]||(s[2]=e=>t.field.val=e),onBlur:s[3]||(s[3]=e=>t.field.validateon=!0),readonly:t.field.meta.readonly},null,42,X)),[[e.vModelText,t.field.val]]):e.createCommentVNode("v-if",!0),W,t.editable?e.withDirectives((e.openBlock(),e.createElementBlock("input",{key:1,class:e.normalizeClass(t.Class.getClass("ptj-form-number")),name:t.field.meta.name,type:"number","onUpdate:modelValue":s[4]||(s[4]=e=>t.field.val=e),onBlur:s[5]||(s[5]=e=>t.field.validateon=!0),readonly:t.field.meta.readonly},null,42,$)),[[e.vModelText,t.field.val]]):e.createCommentVNode("v-if",!0)])):(e.openBlock(),e.createElementBlock("span",K,e.toDisplayString(t.field.val),1))},H.__file="presstojam/src/components/ptj-number.vue";var Y=e.defineComponent({name:"ptj-flag",props:{field:Object,editable:{type:Boolean,default:!1},filter:{type:Boolean,default:!1}},data:()=>({cval:""}),setup:()=>({Class:P})});const Z=["name"],G=["name"],Q=[e.createElementVNode("option",{value:0},e.toDisplayString("All"),-1),e.createElementVNode("option",{value:1},e.toDisplayString("Checked"),-1),e.createElementVNode("option",{value:2},e.toDisplayString("Unchecked"),-1)],ee={key:2};Y.render=function(t,s,r,a,l,o){return t.editable?e.withDirectives((e.openBlock(),e.createElementBlock("input",{key:0,class:e.normalizeClass(t.Class.getClass("ptj-checkbox")),type:"checkbox","true-value":1,"false-value":0,name:t.field.meta.name,"onUpdate:modelValue":s[0]||(s[0]=e=>t.field.val=e)},null,10,Z)),[[e.vModelCheckbox,t.field.val]]):t.filter?e.withDirectives((e.openBlock(),e.createElementBlock("select",{key:1,name:t.field.meta.name,"onUpdate:modelValue":s[1]||(s[1]=e=>t.field.val=e),class:e.normalizeClass(t.Class.getClass("ptj-filter-form-checkbox"))},Q,10,G)),[[e.vModelSelect,t.field.val]]):(e.openBlock(),e.createElementBlock("button",ee,e.toDisplayString(t.field.val),1))},Y.__file="presstojam/src/components/ptj-flag.vue";var te=e.defineComponent({name:"ptj-flag",props:{field:Object,editable:{type:Boolean,default:!1},filter:{type:Boolean,default:!1}},data:()=>({cval:""}),computed:{atts(){}},setup:()=>({Class:P})});const se=["name"],re=e.createElementVNode("option",{value:"0",selected:""},"Select Option",-1),ae=["value"],le=["name"],oe=e.createElementVNode("option",{value:"0",selected:"",disabled:""},"All",-1),ie=["value"],ne={key:2};te.render=function(t,s,r,a,l,o){return t.editable?e.withDirectives((e.openBlock(),e.createElementBlock("select",e.mergeProps({key:0,class:t.Class.getClass("ptj-form-select"),"onUpdate:modelValue":s[0]||(s[0]=e=>t.field.val=e),name:t.field.meta.name},t.atts,{onBlur:s[1]||(s[1]=e=>t.field.validateon=!0)}),[re,(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.field.meta.options,(t=>(e.openBlock(),e.createElementBlock("option",{key:t.key,value:t.key},e.toDisplayString(t.value),9,ae)))),128))],16,se)),[[e.vModelSelect,t.field.val]]):t.filter?e.withDirectives((e.openBlock(),e.createElementBlock("select",e.mergeProps({key:1,class:t.Class.getClass("ptj-form-select"),"onUpdate:modelValue":s[2]||(s[2]=e=>t.field.val=e),name:t.field.meta.name},t.atts,{onBlur:s[3]||(s[3]=e=>t.field.validateon=!0),multiple:"true"}),[oe,(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.field.meta.options,(t=>(e.openBlock(),e.createElementBlock("option",{key:t.key,value:t.key},e.toDisplayString(t.value),9,ie)))),128))],16,le)),[[e.vModelSelect,t.field.val]]):(e.openBlock(),e.createElementBlock("span",ne,e.toDisplayString(t.field.val),1))},te.__file="presstojam/src/components/ptj-id.vue";var pe=e.defineComponent({name:"ptj-time",props:{field:Object,editable:{type:Boolean,default:!1},filter:{type:Boolean,default:!1}},setup:()=>({Class:P})});const ce=["name","readonly"],de={key:1},me=e.createTextVNode(" - "),he={key:2};pe.render=function(t,s,r,a,l,o){return t.editable?e.withDirectives((e.openBlock(),e.createElementBlock("input",{key:0,class:e.normalizeClass(t.Class.getClass("ptj-form-time")),name:t.field.meta.name,type:"datetime-local","onUpdate:modelValue":s[0]||(s[0]=e=>t.field.val=e),onBlur:s[1]||(s[1]=e=>t.field.validateon=!0),readonly:t.field.meta.readonly},null,42,ce)),[[e.vModelText,t.field.val]]):t.filter?(e.openBlock(),e.createElementBlock("div",de,[e.withDirectives(e.createElementVNode("input",{class:e.normalizeClass(t.Class.getClass("ptj-filter-form-time-1")),type:"datetime-local","onUpdate:modelValue":s[2]||(s[2]=e=>t.field.val1=e)},null,2),[[e.vModelText,t.field.val1]]),me,e.withDirectives(e.createElementVNode("input",{class:e.normalizeClass(t.Class.getClass("ptj-filter-form-time-2")),type:"datetime-local","onUpdate:modelValue":s[3]||(s[3]=e=>t.field.val2=e)},null,2),[[e.vModelText,t.field.val2]])])):(e.openBlock(),e.createElementBlock("span",he,e.toDisplayString(t.field.val),1))},pe.__file="presstojam/src/components/ptj-time.vue";var _e=e.defineComponent({name:"ptj-string-editable",props:{field:Object},setup:()=>({Class:P}),methods:{isEnum(e){if(!e)return null;let t=[];const s=new RegExp(/^[a-zA-Z]+[a-zA-Z0-9._]+$/),r=e.split("|");for(let e of r)if(e){if(!s.test(e))return null;t.push(e)}return t}},computed:{tag(){return this.isEnum(this.field.meta.validator.contains)?"select":this.field.meta.html||this.field.meta.max>150?"textarea":"input"},options(){const e=this.field.meta.validator.contains.split("|");let t=[];for(let s of e)t.push({key:s,value:s});return t},atts(){let e={};return this.field.meta.encrypted&&(e.type="password"),this.field.meta.readonly&&(e.readonly=!0),this.field.meta.placeholder&&(e.placeholder=field.meta.placeholder),this.field.meta.html&&(e["data-html"]=1),e}}});const ue=["name"],fe=["name"],ge=e.createElementVNode("option",{value:"0",selected:"",disabled:""},"Select Option",-1),ve=["value"],ke=["name","readonly"];_e.render=function(t,s,r,a,l,o){return"textarea"==t.tag?e.withDirectives((e.openBlock(),e.createElementBlock("textarea",e.mergeProps({key:0},t.atts,{name:t.field.meta.name,"onUpdate:modelValue":s[0]||(s[0]=e=>t.field.val=e)}),null,16,ue)),[[e.vModelText,t.field.val]]):"select"==t.tag?e.withDirectives((e.openBlock(),e.createElementBlock("select",e.mergeProps({key:1,class:t.Class.getClass("ptj-form-select"),"onUpdate:modelValue":s[1]||(s[1]=e=>t.field.val=e),name:t.field.meta.name},t.atts,{onBlur:s[2]||(s[2]=e=>t.field.validateon=!0)}),[ge,(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.options,(t=>(e.openBlock(),e.createElementBlock("option",{key:t.key,value:t.key},e.toDisplayString(t.value),9,ve)))),128))],16,fe)),[[e.vModelSelect,t.field.val]]):e.withDirectives((e.openBlock(),e.createElementBlock("input",e.mergeProps({key:2},t.atts,{class:t.Class.getClass("ptj-form-number"),name:t.field.meta.name,"onUpdate:modelValue":s[3]||(s[3]=e=>t.field.val=e),onBlur:s[4]||(s[4]=e=>t.field.validateon=!0),readonly:t.field.meta.readonly}),null,16,ke)),[[e.vModelDynamic,t.field.val]])},_e.__file="presstojam/src/components/ptj-string-editable.vue";var je=e.defineComponent({name:"ptj-string-display",props:{field:Object},setup:()=>({Class:P}),computed:{tag(){return this.field.meta.html||this.field.meta.max>150?"textarea":"input"}}});const ye={key:0},be={key:1};je.render=function(t,s,r,a,l,o){return"textarea"==t.tag?(e.openBlock(),e.createElementBlock("div",ye,e.toDisplayString(t.field.val),1)):(e.openBlock(),e.createElementBlock("span",be,e.toDisplayString(t.field.val),1))},je.__file="presstojam/src/components/ptj-string-display.vue";var Ce=e.defineComponent({name:"ptj-string-filter",props:{field:Object},setup:()=>({Class:P}),methods:{isEnum(e){if(!e)return null;let t=[];const s=new RegExp(/^[a-zA-Z]+[a-zA-Z0-9._]+$/),r=e.split("|");for(let e of r)if(e){if(!s.test(e))return null;t.push(e)}return t}},computed:{tag(){return this.isEnum(this.field.meta.validator.contains)?"select":this.field.meta.html||this.field.meta.max>150?"textarea":"input"},options(){const e=this.field.meta.validator.contains.split("|");let t=[];for(let s of e)t.push({key:s,value:s});return t},atts(){let e={};return this.field.meta.encrypted&&(e.type="hidden"),this.field.meta.readonly&&(e.readonly=!0),this.field.meta.placeholder&&(e.placeholder=field.meta.placeholder),this.field.meta.html&&(e["data-html"]=1),e}}});const Be=["name"],we=e.createElementVNode("option",{value:"0",selected:"",disabled:""},"Select Option",-1),Ee=["value"],xe=["name","readonly"];Ce.render=function(t,s,r,a,l,o){return"select"==t.tag?e.withDirectives((e.openBlock(),e.createElementBlock("select",e.mergeProps({key:0,class:t.Class.getClass("ptj-form-select"),"onUpdate:modelValue":s[0]||(s[0]=e=>t.field.val=e),name:t.field.meta.name},t.atts,{onBlur:s[1]||(s[1]=e=>t.field.validateon=!0),multiple:"true"}),[we,(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.options,(t=>(e.openBlock(),e.createElementBlock("option",{key:t.key,value:t.key},e.toDisplayString(t.value),9,Ee)))),128))],16,Be)),[[e.vModelSelect,t.field.val]]):e.withDirectives((e.openBlock(),e.createElementBlock("input",e.mergeProps({key:1},t.atts,{class:t.Class.getClass("ptj-form-number"),name:t.field.meta.name,"onUpdate:modelValue":s[2]||(s[2]=e=>t.field.val=e),onBlur:s[3]||(s[3]=e=>t.field.validateon=!0),readonly:t.field.meta.readonly}),null,16,xe)),[[e.vModelDynamic,t.field.val]])},Ce.__file="presstojam/src/components/ptj-string-filter.vue";var Se=e.defineComponent({name:"ptj-string",props:{field:Object,editable:{type:Boolean,default:!1},filter:{type:Boolean,default:!1}},setup:()=>({Class:P}),components:{"ptj-string-editable":_e,"ptj-string-display":je,"ptj-string-filter":Ce}});Se.render=function(t,s,r,a,l,o){const i=e.resolveComponent("ptj-string-editable"),n=e.resolveComponent("ptj-string-filter"),p=e.resolveComponent("ptj-string-display");return t.editable?(e.openBlock(),e.createBlock(i,{key:0,field:t.field},null,8,["field"])):t.filter?(e.openBlock(),e.createBlock(n,{key:1,field:t.field},null,8,["field"])):(e.openBlock(),e.createBlock(p,{key:2,field:t.field},null,8,["field"]))},Se.__file="presstojam/src/components/ptj-string.vue";var Ve=e.defineComponent({name:"ptj-asset",props:{field:Object,editable:{type:Boolean,default:!1},filter:{type:Boolean,default:!1}},setup:()=>({Class:P})});const Ne=["name"],De={key:1};Ve.render=function(t,s,r,a,l,o){return t.editable?(e.openBlock(),e.createElementBlock("input",{key:0,class:e.normalizeClass(t.Class.getClass("ptj-form-asset")),ref:"input",onChange:s[0]||(s[0]=(...e)=>t.setFile&&t.setFile(...e)),name:t.field.meta.name,type:"file"},null,42,Ne)):(e.openBlock(),e.createElementBlock("span",De,e.toDisplayString(t.field.val),1))},Ve.__file="presstojam/src/components/ptj-asset.vue";var Le=e.defineComponent({name:"ptj-form",data:()=>({fstate:0,globalerror:""}),setup:()=>({store:T.getStore(),Class:P}),methods:{clearErrors(){this.globalerror="";for(let e in this.store.data.cells)this.store.data.cells[e].error=0},submit(){return this.fstate=this.total>0?1:2,this.clearErrors(),this.store.submit().then((e=>{this.store.next(e),T.buildLink()})).catch((e=>{if(this.fstate=0,console.log(e),"string"==typeof e)this.globalerror=e;else for(let t in e){if(0===t.indexOf("__"))continue;const s=this.store.data.cells[t];s&&(s.error=c.getError(e[t]))}}))}},components:{"ptj-string":Se,"ptj-time":pe,"ptj-asset":Ve,"ptj-id":te,"ptj-progress-bar":A,"ptj-form-row":I,"ptj-flag":Y,"ptj-number":H}});Le.render=function(t,s,r,a,l,o){const i=e.resolveComponent("ptj-asset"),n=e.resolveComponent("ptj-number"),p=e.resolveComponent("ptj-flag"),c=e.resolveComponent("ptj-id"),d=e.resolveComponent("ptj-time"),m=e.resolveComponent("ptj-string"),h=e.resolveComponent("ptj-form-row"),_=e.resolveComponent("ptj-progress-bar");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("form",{onSubmit:s[0]||(s[0]=e.withModifiers(((...e)=>t.submit&&t.submit(...e)),["prevent"])),class:e.normalizeClass(t.Class.getClass("ptj-form")+" "+t.store.classes)},[e.withDirectives(e.createElementVNode("div",{class:e.normalizeClass(t.Class.getClass("ptj-form-error"))},e.toDisplayString(t.globalerror),3),[[e.vShow,t.globalerror]]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.store.data.cells,(s=>(e.openBlock(),e.createBlock(h,{key:s.meta.name,field:s,class:e.normalizeClass(t.Class.getClass("ptj-form-group"))},{default:e.withCtx((()=>["asset"==s.meta.type?(e.openBlock(),e.createBlock(i,{key:0,editable:!0,field:s},null,8,["field"])):"number"==s.meta.type?(e.openBlock(),e.createBlock(n,{key:1,editable:!0,field:s},null,8,["field"])):"flag"==s.meta.type?(e.openBlock(),e.createBlock(p,{key:2,editable:!0,field:s},null,8,["field"])):"id"==s.meta.type?(e.openBlock(),e.createBlock(c,{key:3,editable:!0,field:s},null,8,["field"])):"time"==s.meta.type?(e.openBlock(),e.createBlock(d,{key:4,editable:!0,field:s},null,8,["field"])):"string"==s.meta.type?(e.openBlock(),e.createBlock(m,{key:5,editable:!0,field:s},null,8,["field"])):e.createCommentVNode("v-if",!0)])),_:2},1032,["field","class"])))),128)),e.createElementVNode("input",{type:"submit",value:"Submit",class:e.normalizeClass(t.Class.getClass("ptj-form-submit"))},null,2)],34),[[e.vShow,0==t.fstate]]),e.withDirectives(e.createVNode(_,{total:t.store.progress.total,progress:t.store.progress.progress},null,8,["total","progress"]),[[e.vShow,1==t.fstate]])],64)},Le.__file="presstojam/src/components/ptj-form.vue";var ze=e.defineComponent({name:"ptj-nav",props:{actions:Array,classes:{type:String,default:""}},setup:()=>({Class:P}),methods:{setRoute(e){e.r().then((()=>{T.buildLink()})).catch((e=>console.log(e)))}}});const Re=["onClick"];ze.render=function(t,s,r,a,l,o){return e.openBlock(),e.createElementBlock("span",{class:e.normalizeClass(t.Class.getClass("ptj-nav")+" "+t.classes)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.actions,(s=>(e.openBlock(),e.createElementBlock("a",{key:s,onClick:e=>{t.setRoute(s)},class:e.normalizeClass(t.Class.getClass("ptj-nav-link"))},e.toDisplayString(s.n),11,Re)))),128))],2)},ze.__file="presstojam/src/components/ptj-nav.vue";var Ue=e.defineComponent({props:{title:String,active:{type:Boolean,default:!1},classes:{type:String,default:""}},setup:()=>({Class:P}),data(){return{show:this.active}},methods:{toggleWidget(){this.show=!this.show}}});const Te=[e.createElementVNode("span",{class:"material-icons"},"more_horiz",-1)],Oe={class:"Class.getClass('ptj-widget-window-body')"};Ue.render=function(t,s,r,a,l,o){return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(t.Class.getClass("ptj-widget-window")+" "+t.classes)},[e.createElementVNode("div",{class:e.normalizeClass(t.Class.getClass("ptj-widget-window-header"))},[e.createElementVNode("h1",{class:e.normalizeClass(t.Class.getClass("ptj-widget-window-title"))},[e.createTextVNode(e.toDisplayString(t.title)+" ",1),e.createElementVNode("a",{class:e.normalizeClass(t.Class.getClass("ptj-widget-window-toggle")),onClick:s[0]||(s[0]=(...e)=>t.toggleWidget&&t.toggleWidget(...e))},Te,2)],2)],2),e.withDirectives(e.createElementVNode("div",Oe,[e.renderSlot(t.$slots,"default",{toggleWidget:t.toggleWidget})],512),[[e.vShow,t.show]])],2)},Ue.__file="presstojam/src/components/ptj-widget-window.vue";var Pe=e.defineComponent({name:"ptj-filter-form",setup:()=>({store:T.getStore(),Class:P}),methods:{submit(){this.store.reload(),T.buildLink(!0)}},components:{"ptj-form-row":I,"ptj-id":te,"ptj-flag":Y,"ptj-time":pe,"ptj-number":H,"ptj-string":Se,"ptj-widget":Ue}});const Ae=["onClick"];M("\n.error[data-v-71ada21d] {\r\n  color : red;\n}\r\n\r\n"),Pe.render=function(t,s,r,a,l,o){const i=e.resolveComponent("ptj-id"),n=e.resolveComponent("ptj-flag"),p=e.resolveComponent("ptj-number"),c=e.resolveComponent("ptj-time"),d=e.resolveComponent("ptj-string"),m=e.resolveComponent("ptj-form-row"),h=e.resolveComponent("ptj-widget");return e.openBlock(),e.createBlock(h,{title:"search"},{default:e.withCtx((r=>[e.createElementVNode("form",{onSubmit:s[0]||(s[0]=e.withModifiers(((...e)=>t.submit&&t.submit(...e)),["prevent"])),class:e.normalizeClass(t.Class.getClass("ptj-filter-form"))},[e.createElementVNode("h1",null,"Search "+e.toDisplayString(t.store.title),1),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.store.data_template.cells,(s=>(e.openBlock(),e.createBlock(m,{key:s.meta.name,field:s,class:e.normalizeClass(t.Class.getClass("ptj-filter-form-group"))},{default:e.withCtx((()=>["id"==s.meta.type?(e.openBlock(),e.createBlock(i,{key:0,filter:!0,field:s},null,8,["field"])):"flag"==s.meta.type?(e.openBlock(),e.createBlock(n,{key:1,filter:!0,field:s},null,8,["field"])):"number"==s.meta.type?(e.openBlock(),e.createBlock(p,{key:2,filter:!0,field:s},null,8,["field"])):"time"==s.meta.type?(e.openBlock(),e.createBlock(c,{key:3,filter:!0,field:s},null,8,["field"])):"string"==s.meta.type?(e.openBlock(),e.createBlock(d,{key:4,filter:!0,field:s},null,8,["field"])):e.createCommentVNode("v-if",!0)])),_:2},1032,["field","class"])))),128)),e.createElementVNode("input",{type:"submit",value:"Submit",class:e.normalizeClass(t.Class.getClass("ptj-filter-form-submit")),onClick:r.toggleWidget},null,10,Ae)],34)])),_:1})},Pe.__scopeId="data-v-71ada21d",Pe.__file="presstojam/src/components/ptj-filter-form.vue";var Me=e.defineComponent({setup:()=>({store:T.getStore(),Class:P}),methods:{setPage(e){this.store.setPage(e-1),T.buildLink(!0)},getActiveClass(e){return e-1==this.store.data_template.page?"ptj-pagination-active":""}}});const Fe=["onClick"];Me.render=function(t,s,r,a,l,o){return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(t.Class.getClass("ptj-pagination"))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.store.data_template.max_pages,(s=>(e.openBlock(),e.createElementBlock("a",{key:s,onClick:e=>t.setPage(s),class:e.normalizeClass(t.getActiveClass(s))},e.toDisplayString(s),11,Fe)))),128))],2)},Me.__file="presstojam/src/components/ptj-pagination.vue";var Ie=e.defineComponent({setup:()=>({store:T.getStore(),Class:P}),components:{"ptj-widget":Ue}});const He=["onUpdate:modelValue"];Ie.render=function(t,s,r,a,l,o){const i=e.resolveComponent("ptj-widget");return e.openBlock(),e.createBlock(i,{title:"select fields",classes:t.Class.getClass("ptj-selectfields")},{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.store.fields,((s,r)=>(e.openBlock(),e.createElementBlock("div",{key:r},[e.withDirectives(e.createElementVNode("input",{type:"checkbox","onUpdate:modelValue":e=>s.summary=e,"true-value":1,"false-value":0,class:e.normalizeClass(t.Class.getClass("ptj-selectfields-checkbox"))},null,10,He),[[e.vModelCheckbox,s.summary]]),e.createElementVNode("label",{class:e.normalizeClass(t.Class.getClass("ptj-selectfields-label"))},e.toDisplayString(s.name),3)])))),128))])),_:1},8,["classes"])},Ie.__file="presstojam/src/components/ptj-selectfields.vue";var Je=e.defineComponent({name:"ptj-header",setup:()=>({store:T.getStore(),Class:P}),components:{"ptj-nav":ze,"ptj-filter-form":Pe,"ptj-pagination":Me,"ptj-selectfields":Ie}});const qe={key:0};Je.render=function(t,s,r,a,l,o){const i=e.resolveComponent("ptj-nav"),n=e.resolveComponent("ptj-filter-form"),p=e.resolveComponent("ptj-selectfields");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("h1",{class:e.normalizeClass(t.Class.getClass("ptj-repo-header-title"))},e.toDisplayString(t.store.title),3),t.store.count?(e.openBlock(),e.createElementBlock("p",qe,"Number of rows: "+e.toDisplayString(t.store.count),1)):e.createCommentVNode("v-if",!0),e.createVNode(i,{actions:t.store.actions,class:e.normalizeClass(t.Class.getClass("ptj-repo-header-actions"))},null,8,["actions","class"]),1!=t.store.disable_filter?(e.openBlock(),e.createBlock(n,{key:1})):e.createCommentVNode("v-if",!0),1!=t.store.disable_selectfields?(e.openBlock(),e.createBlock(p,{key:2})):e.createCommentVNode("v-if",!0)],64)},Je.__file="presstojam/src/components/ptj-repo-header.vue";var Xe=e.defineComponent({name:"ptj-tree-node",props:{branch:{type:Object,required:!0},draggable:Boolean,ischild:{type:Boolean,default:!1}},data:()=>({toggle_state:{}}),setup:()=>({store:T.getStore(),Class:P}),methods:{toggle(e){this.toggle_state[e]=!this.toggle_state[e]},setDraggable(e){e.target.closest(".ptj-draggable").setAttribute("draggable",!0)},endDraggable(e){e.target.closest(".ptj-draggable").setAttribute("draggable",!1)},selectRow(e){let t=e.primary.toVal();this.store.next(t),T.buildLink()},getRowClass(){let e=[];for(let t of this.store.groups)e.push(this.store.model+"-"+t.replace("_","-")+"-"+this.branch[t]);return e.join(" ")}},computed:{sortable:()=>!0,children(){let e=[],t=this.branch.children;for(let s in t){const r=t[s];e.push(...r)}return e}},components:{}});const We=t=>(e.pushScopeId("data-v-1dcaa9f5"),t=t(),e.popScopeId(),t),$e=["id"],Ke=[We((()=>e.createElementVNode("span",{class:"material-icons"},"subdirectory_arrow_right",-1)))],Ye=[We((()=>e.createElementVNode("span",{class:"material-icons"},"keyboard_arrow_right",-1)))],Ze={key:0},Ge=[We((()=>e.createElementVNode("span",{class:"material-icons"},"drag_handle",-1)))];M("\n.model-tree.branch[data-v-1dcaa9f5] {\r\n  padding-left: 8px;\r\n  padding-right: 8px;\r\n  margin: 6px 0;\r\n  background-color:#111111;\n}\n.tree .ide-block[data-v-1dcaa9f5] {\r\n\tdisplay : none;\n}\n.dragArea[data-v-1dcaa9f5] {\r\n  min-height: 50px;\r\n  outline: 1px solid #777777;\n}\r\n\r\n\r\n"),Xe.render=function(t,s,r,a,l,o){const i=e.resolveComponent("ptj-tree-node",!0);return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(t.Class.getClass("ptj-tree-node")+" ptj-draggable"+this.getRowClass()),id:t.branch.primary.toVal(),draggable:"false"},[e.createElementVNode("div",{class:e.normalizeClass(t.Class.getClass("ptj-tree-node-row")),onClick:s[5]||(s[5]=e=>{t.selectRow(t.branch)})},[e.createElementVNode("div",null,[t.ischild?(e.openBlock(),e.createElementBlock("a",{key:0,"data-action":"more",class:"button",onClick:s[0]||(s[0]=e.withModifiers((e=>t.toggle(t.branch.primary.toVal(),!1)),["prevent","stop"]))},Ke)):(e.openBlock(),e.createElementBlock("a",{key:1,"data-action":"more",class:"button",onClick:s[1]||(s[1]=e.withModifiers((e=>t.toggle(t.branch.primary.toVal(),!0)),["prevent","stop"]))},Ye))]),t.sortable?(e.openBlock(),e.createElementBlock("div",Ze,[e.createElementVNode("a",{"data-action":"more",class:"button",onClick:s[2]||(s[2]=(...e)=>t.prevent.stop&&t.prevent.stop(...e)),onMousedown:s[3]||(s[3]=(...e)=>t.setDraggable&&t.setDraggable(...e)),onMouseup:s[4]||(s[4]=(...e)=>t.endDraggable&&t.endDraggable(...e))},Ge,32)])):e.createCommentVNode("v-if",!0),e.createElementVNode("div",null,e.toDisplayString(t.branch.getSummary()),1)],2),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.children,((s,r)=>e.withDirectives((e.openBlock(),e.createBlock(i,{branch:s,ischild:!0,key:r,store:t.store},null,8,["branch","store"])),[[e.vShow,t.toggle_state[t.branch.primary.toVal()]]]))),128))],10,$e)},Xe.__scopeId="data-v-1dcaa9f5",Xe.__file="presstojam/src/components/ptj-tree-node.vue";class Qe{constructor(e={}){this._handle=e.handle,this._drop_target=e.drop_target,this._drag_target=e.drag_target,this._call_back=e.callback,this._x=0,this._y=0,this._offset_x=0,this._offset_y=0,this._judder=e.judder?e.judder:5,this._drag_node,this._drop_node,this._tree=e.tree}isJudder(e,t){const s=e-this._x,r=t-this._y;return!(s<-5||s>5)&&!(r<-5||r>5)}getDirection(e,t){return{x:e==this._x?0:e>this._x?1:-1,y:t==this._y?0:t>this._y?1:-1}}offset(e){var t=e.getBoundingClientRect(),s=e.ownerDocument.defaultView;return{top:t.top+s.pageYOffset,left:t.left+s.pageXOffset}}insertAfter(){let e=this._drag_node.getAttribute("id"),t=this._drop_node.getAttribute("id"),s=0,r=0;if(this._drop_node.nextElementSibling){for(let e in this._tree){let a=this._tree[e];if(a.id==t){s=a.circular,r=a.sort;break}}for(let t in this._tree){let a=this._tree[t];a.id==e?(a.circular=s,a.sort=r+1):a.circular==s&&a.sort>r&&++a.sort}}else for(let t in this._tree){let r=this._tree[t];r.id==e&&(r.circular=s,r.sort=0)}}insertBefore(){let e=this._drag_node.getAttribute("id"),t=this._drop_node.getAttribute("id"),s=0,r=0;for(let e in this._tree){let a=this._tree[e];if(a.id==t){s=a.circular,r=a.sort,++a.sort;break}}for(let t in this._tree){let a=this._tree[t];a.id==e?(a.circular=s,a.sort=r):a.circular==s&&a.sort>r&&++a.sort}}dragStart(e){const t=e.target.closest("[id]");this._drag_node=t;const{top:s,left:r}=this.offset(t);e.dataTransfer.dropEffect="move",this._x=e.clientX,this._y=e.clientY,this._offset_x=e.clientX-r,this._offset_y=e.clientY-s}isDroppable(e){return!!e.target.closest(this._drop_target)}dragEnter(e){if(!this.isDroppable(e))return!0;if(e.preventDefault(),e.dataTransfer.dropEffect="move",this._drop_node=e.target.closest(this._drag_target),!this._drop_node||this._drop_node.getAttribute("id")==this._drag_node.getAttribute("id"))return;const t=this.getDirection(e.clientX,e.clientY);1==t.y?this.insertAfter():-1==t.y&&this.insertBefore(),this._x=e.clientX,this._y=e.clientY}dragOver(e){if(!this.isDroppable(e))return!0;e.preventDefault(),e.dataTransfer.dropEffect="move"}dragEnd(){this._drag_node&&this._drag_node.setAttribute("draggable",!1),this._drag_node=null}drop(e){if(!this._drop_node)return!0;e.preventDefault(),this._call_back&&this._call_back(this._tree)}}var et={initDD:function(e){let t=new Qe(e);if(document.querySelectorAll(e.handle).forEach((e=>e.addAttribute("draggable",!0))),e.handle){document.querySelectorAll(e.handle).forEach((t=>{t.addEventListener("mousedown",(t=>{t.target.closest(e.drag_target).addAttribute("draggable",!0)}))}))}e.main.addEventListener("dragstart",(e=>t.dragStart(e))),e.main.addEventListener("dragenter",(e=>t.dragEnter(e))),e.main.addEventListener("dragover",(e=>t.dragOver(e))),e.main.addEventListener("drop",(e=>t.drop(e))),e.main.addEventListener("dragend",(e=>t.dragEnd(e)))}},tt=e.defineComponent({name:"ptj-tree",setup(t){let s={store:T.getStore(),treeroot:e.ref(null),Class:P};return e.onMounted((()=>{et.initDD({handle:".ptj-drag-handle",drag_target:".ptj-draggable",drop_target:".ptj-drop-target",main:s.treeroot.value,tree:s.store.data,callback:s.store.saveSort})})),s},components:{"ptj-nav":ze,"ptj-tree-node":Xe,"ptj-filter-form":Pe,"ptj-selectfields":Ie}});tt.render=function(t,s,r,a,l,o){const i=e.resolveComponent("ptj-tree-node");return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(t.Class.getClass("ptj-tree")+" "+t.store.classes+" ptj-drop-target"),ref:"treeroot"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.store.data,((t,s)=>(e.openBlock(),e.createBlock(i,{key:s,branch:t},null,8,["branch"])))),128))],2)},tt.__file="presstojam/src/components/ptj-tree.vue";var st=e.defineComponent({name:"ptj-table",setup:()=>(console.log(T.getStore().fields),{store:T.getStore(),Class:P,order:{name:"",dir:""}}),methods:{next(e){this.store.next(e),T.buildLink()},orderBy(e){if(this.store.pages>0){this.order.dir=!this.order.name!=e||"desc"==this.order.dir?"asc":"desc",this.order.name=e;let t=[];t[this.order.name]=this.order.dir,this.store.data_template.sort=t,this.store.reload()}else this.order.name!=e||"desc"==this.order.dir?(this.store.data.sort((function(t,s){let r=t.getCell(e).toVal(),a=s.getCell(e).toVal();return r<a?-1:r>a?1:0})),this.order.name=e,this.order.dir="asc"):(this.store.data.sort((function(t,s){let r=t.getCell(e).toVal(),a=s.getCell(e).toVal();return r<a?1:r>a?-1:0})),this.order.name=e,this.order.dir="desc")},getRowClass(e){let t=[];for(let s of this.store.groups)t.push(this.store.model+"-"+s.replace("_","-")+"-"+e[s]);return t.join(" ")}},computed:{sortable(){return!!this.store.sort},overlimit:()=>!1,rowclass(){}},components:{"ptj-pagination":Me,"ptj-string":Se,"ptj-time":pe,"ptj-asset":Ve,"ptj-id":te,"ptj-flag":Y,"ptj-number":H}});const rt=["onClick"],at={key:0,class:"material-icons"},lt={key:1,class:"material-icons"},ot={key:0},it=["onClick"],nt=[(t=>(e.pushScopeId("data-v-15ab9672"),t=t(),e.popScopeId(),t))((()=>e.createElementVNode("span",{class:"material-icons"},"drag",-1)))];M("\n.table[data-v-15ab9672], .thead[data-v-15ab9672], .tbody[data-v-15ab9672], .tr[data-v-15ab9672] {\r\n    width : 100%;\n}\r\n\r\n\r\n"),st.render=function(t,s,r,a,l,o){const i=e.resolveComponent("ptj-asset"),n=e.resolveComponent("ptj-number"),p=e.resolveComponent("ptj-flag"),c=e.resolveComponent("ptj-id"),d=e.resolveComponent("ptj-time"),m=e.resolveComponent("ptj-string"),h=e.resolveComponent("ptj-pagination");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("table",{class:e.normalizeClass(t.Class.getClass("ptj-table")+" "+t.store.classes)},[e.createElementVNode("thead",null,[e.createElementVNode("tr",{class:e.normalizeClass(t.Class.getClass("ptj-table-header"))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.store.fields,(s=>e.withDirectives((e.openBlock(),e.createElementBlock("th",{key:s.name,class:e.normalizeClass(t.Class.getClass("ptj-table-header-cell")+" "+s.name.replace("_","-")),onClick:e=>{t.orderBy(s.name)}},[e.createTextVNode(e.toDisplayString(s.label)+" ",1),this.order.name==s.name&&"asc"==this.order.dir?(e.openBlock(),e.createElementBlock("span",at,"keyboard_arrow_up")):e.createCommentVNode("v-if",!0),this.order.name==s.name&&"desc"==this.order.dir?(e.openBlock(),e.createElementBlock("span",lt,"keyboard_arrow_down")):e.createCommentVNode("v-if",!0)],10,rt)),[[e.vShow,s.summary]]))),128)),t.sortable?(e.openBlock(),e.createElementBlock("th",ot,"Â ")):e.createCommentVNode("v-if",!0)],2)]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.store.data,((r,a)=>(e.openBlock(),e.createElementBlock("tr",{key:a,class:e.normalizeClass(t.Class.getClass("ptj-table-row")+" "+this.getRowClass(r)),onClick:e=>{t.next(r.primary.toVal())}},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.cells,((s,r)=>e.withDirectives((e.openBlock(),e.createElementBlock("td",{key:r,class:e.normalizeClass(t.Class.getClass("ptj-table-cell")+" "+r.replace("_","-"))},["asset"==s.meta.type?(e.openBlock(),e.createBlock(i,{key:0,field:s},null,8,["field"])):"number"==s.meta.type?(e.openBlock(),e.createBlock(n,{key:1,field:s},null,8,["field"])):"flag"==s.meta.type?(e.openBlock(),e.createBlock(p,{key:2,field:s},null,8,["field"])):"id"==s.meta.type?(e.openBlock(),e.createBlock(c,{key:3,field:s},null,8,["field"])):"time"==s.meta.type?(e.openBlock(),e.createBlock(d,{key:4,field:s},null,8,["field"])):"string"==s.meta.type?(e.openBlock(),e.createBlock(m,{key:5,field:s},null,8,["field"])):e.createCommentVNode("v-if",!0)],2)),[[e.vShow,s.meta.summary]]))),128)),t.sortable?(e.openBlock(),e.createElementBlock("td",{key:0,class:e.normalizeClass(t.Class.getClass("ptj-table-cell-sortable"))},[e.createElementVNode("a",{"data-action":"more",class:"button",onClick:s[0]||(s[0]=e.withModifiers(((...e)=>t.toggle&&t.toggle(...e)),["prevent"])),draggable:"true"},nt)],2)):e.createCommentVNode("v-if",!0)],10,it)))),128))])],2),t.store.data_template.limit>0?(e.openBlock(),e.createBlock(h,{key:0})):e.createCommentVNode("v-if",!0)],64)},st.__scopeId="data-v-15ab9672",st.__file="presstojam/src/components/ptj-table.vue";var pt=e.defineComponent({name:"ptj-list",setup:()=>({store:T.getStore(),Class:P}),methods:{next(e){this.store.next(e),T.buildLink()},getCombinations(e,t,s){const r=[];if(0==s.length)for(let e in t)r.push({tags:[t[e].display],data:t[e].contains});else for(let e of s)for(let s in t){let a=e.tags;a.push(s.display),r.push({tags:a,data:e.data.filter((e=>t[s].contains.includes(e)))})}return r}},computed:{getIndexCombinations(){let e=[];for(let t in this.store.indexes)e=this.getCombinations(t,this.store.indexes[t],e);return e}}});const ct=["onClick"];pt.render=function(t,s,r,a,l,o){return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(t.Class.getClass("ptj-list")+" "+t.store.classes)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.getIndexCombinations,((s,r)=>(e.openBlock(),e.createElementBlock("div",{key:r},[e.createElementVNode("h3",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.tags,((t,s)=>(e.openBlock(),e.createElementBlock("span",{key:s},e.toDisplayString(t)+"Â ",1)))),128))]),e.createElementVNode("ul",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.data,(s=>(e.openBlock(),e.createElementBlock("li",{key:s},[e.createElementVNode("a",{onClick:e=>t.next(t.store.data[s].primary.toVal())},e.toDisplayString(t.store.data[s].getSummary()),9,ct)])))),128))])])))),128))],2)},pt.__file="presstojam/src/components/ptj-list.vue";var dt=e.defineComponent({name:"ptj-repo",setup:()=>({store:T.getStore(),Class:P}),components:{"ptj-repo-header":Je,"ptj-tree":tt,"ptj-table":st,"ptj-list":pt}});M("\n.table[data-v-1c7fb47e], .thead[data-v-1c7fb47e], .tbody[data-v-1c7fb47e], .tr[data-v-1c7fb47e] {\r\n    width : 100%;\n}\n.ptj-data-row[data-v-1c7fb47e]:nth-child(odd) {background : #CCC}\r\n\r\n"),dt.render=function(t,s,r,a,l,o){const i=e.resolveComponent("ptj-repo-header");return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(t.Class.getClass("ptj-repo")+" "+t.store.classes)},[e.createVNode(i),(e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.store.rawcomponent),{key:t.store.key}))],2)},dt.__scopeId="data-v-1c7fb47e",dt.__file="presstojam/src/components/ptj-repo.vue";var mt=e.defineComponent({name:"ptj-single-item",props:{active:{type:Boolean,default:!1}},setup:()=>({store:T.getStore(),Class:P}),computed:{editnav(){return this.store.actions.put},delnav(){return this.store.actions.delete},title(){return this.store.title+" "+this.store.summary()}},methods:{runDel(){this.store.runDelete()}},components:{"ptj-nav":ze,"ptj-widget":Ue,"ptj-string":Se,"ptj-time":pe,"ptj-asset":Ve,"ptj-id":te,"ptj-form-row":I,"ptj-flag":Y,"ptj-number":H}});mt.render=function(t,s,r,a,l,o){const i=e.resolveComponent("ptj-nav"),n=e.resolveComponent("ptj-asset"),p=e.resolveComponent("ptj-number"),c=e.resolveComponent("ptj-flag"),d=e.resolveComponent("ptj-id"),m=e.resolveComponent("ptj-time"),h=e.resolveComponent("ptj-string"),_=e.resolveComponent("ptj-form-row");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",{class:e.normalizeClass(t.Class.getClass("ptj-single-item")+" "+t.store.classes)},[e.createElementVNode("h1",null,e.toDisplayString(t.store.title),1),e.createVNode(i,{actions:t.store.actions,class:e.normalizeClass(t.Class.getClass("ptj-single-item-actions"))},null,8,["actions","class"]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.store.data.cells,((s,r)=>(e.openBlock(),e.createBlock(_,{key:r,field:s,class:e.normalizeClass(t.Class.getClass("ptj-single-item-row")+" "+s.name)},{default:e.withCtx((()=>["asset"==s.meta.type?(e.openBlock(),e.createBlock(n,{key:0,field:s},null,8,["field"])):"number"==s.meta.type?(e.openBlock(),e.createBlock(p,{key:1,field:s},null,8,["field"])):"flag"==s.meta.type?(e.openBlock(),e.createBlock(c,{key:2,field:s},null,8,["field"])):"id"==s.meta.type?(e.openBlock(),e.createBlock(d,{key:3,field:s},null,8,["field"])):"time"==s.meta.type?(e.openBlock(),e.createBlock(m,{key:4,field:s},null,8,["field"])):"string"==s.meta.type?(e.openBlock(),e.createBlock(h,{key:5,field:s},null,8,["field"])):e.createCommentVNode("v-if",!0)])),_:2},1032,["field","class"])))),128))],2),e.createVNode(i,{actions:t.store.children,class:e.normalizeClass(t.Class.getClass("ptj-single-item-children"))},null,8,["actions","class"])],64)},mt.__file="presstojam/src/components/ptj-single-item.vue";var ht=e.defineComponent({name:"ptj-login",setup(){let e=T.getStore();return e.next=()=>{T.reloadFromBase()},{store:e,Class:P}},components:{"ptj-form":Le,"ptj-nav":ze}});ht.render=function(t,s,r,a,l,o){const i=e.resolveComponent("ptj-form"),n=e.resolveComponent("ptj-nav");return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(t.Class.getClass("ptj-accounthandler"))},[e.createElementVNode("h1",null,e.toDisplayString(t.store.title),1),e.createVNode(i),e.createVNode(n,{action:t.store.actions},null,8,["action"])],2)},ht.__file="presstojam/src/components/ptj-accounthandler.vue";var _t=e.defineComponent({name:"ptj-card",props:{store:Object,active:{type:Boolean,default:!1}},methods:{next(){this.store.next(),T.buildLink()}},computed:{title(){return this.store.title},classes(){return P.getClass("ptj-card")+" "+this.store.classes},rowclass:()=>P.getClass("ptj-card-row"),labelclass:()=>P.getClass("ptj-card-label"),valueclass:()=>P.getClass("ptj-card-value")},components:{"ptj-widget":Ue}});const ut=[e.createElementVNode("span",{class:"material-icons"},"view_carousel",-1)],ft=e.createTextVNode("Â ");_t.render=function(t,s,r,a,l,o){const i=e.resolveComponent("ptj-widget");return e.openBlock(),e.createBlock(i,{title:t.title,active:t.active},{default:e.withCtx((()=>[e.createElementVNode("div",{class:e.normalizeClass(t.classes)},[e.createElementVNode("a",{onClick:s[0]||(s[0]=(...e)=>t.next&&t.next(...e))},ut),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.store.fields,((s,r)=>(e.openBlock(),e.createElementBlock("div",{key:r,class:e.normalizeClass(t.rowclass+" "+s.name)},[e.createElementVNode("span",{class:e.normalizeClass(t.labelclass)},e.toDisplayString(s.label),3),ft,e.createElementVNode("span",{class:e.normalizeClass(t.rowclass)},e.toDisplayString(s.val),3)],2)))),128))],2)])),_:1},8,["title","active"])},_t.__file="presstojam/src/components/ptj-card.vue";var gt=e.defineComponent({props:{index:{type:Boolean}},setup:e=>(e.index&&T.next(),{store:T.getStore(),Class:P}),computed:{parents:()=>[]},components:{"ptj-form":Le,"ptj-nav":ze,"ptj-single-item":mt,"ptj-account-handler":ht,"ptj-repo":dt,"ptj-card":_t}});gt.render=function(t,s,r,a,l,o){return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(t.Class.getClass("ptj-tabs"))},[e.createElementVNode("div",{class:e.normalizeClass(t.Class.getClass("ptj-tabs-tab"))},[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.store.component),{key:t.store.index}))],2)],2)},gt.__file="presstojam/src/components/ptj-tabs.vue";var vt=e.defineComponent({setup:()=>({Class:P}),methods:{logout(){n.post("/core-logout").then((()=>{T.reloadFromBase()}))}}});vt.render=function(t,s,r,a,l,o){return e.openBlock(),e.createBlock(e.Teleport,{to:"#ptj-accountdetails"},[e.createElementVNode("a",{class:e.normalizeClass(t.Class.getClass("ptj-account-details-logout")),onClick:s[0]||(s[0]=(...e)=>t.logout&&t.logout(...e))},"Logout",2)])},vt.__file="presstojam/src/components/ptj-account-details.vue";var kt=e.defineComponent({name:"ptj-root",setup:()=>({Class:P}),computed:{groups:()=>T.store.models,isaccount:()=>"public"!=T.store.profile},components:{"ptj-tabs":gt,"ptj-account-details":vt}});kt.render=function(t,s,r,a,l,o){const i=e.resolveComponent("ptj-account-details"),n=e.resolveComponent("ptj-tabs");return e.openBlock(),e.createElementBlock(e.Fragment,null,[t.isaccount?(e.openBlock(),e.createBlock(i,{key:0})):e.createCommentVNode("v-if",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.groups,(s=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(t.Class.getClass("ptj-root")),key:s.index},[e.createVNode(n,{index:!0})],2)))),128))],64)},kt.__file="presstojam/src/components/ptj-root.vue";var jt={Ctrl:T,runApp:function(t){const s=e.createApp(kt);return s.mount(t),s}};exports.default=jt;
//# sourceMappingURL=ptj.cjs.js.map
