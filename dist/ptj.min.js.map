{"version":3,"file":"ptj.min.js","sources":["../presstojam/src/components/ptj-modal.vue","../node_modules/style-inject/dist/style-inject.es.js","../presstojam/src/js/client.js","../presstojam/src/js/map.js","../presstojam/src/js/route.js","../presstojam/src/components/ptj-button.vue","../presstojam/src/components/ptj-multiple-input.vue","../presstojam/src/components/ptj-multiple-select.vue","../presstojam/src/js/dictionary.js","../presstojam/src/js/error.js","../presstojam/src/components/ptj-form-confirm.vue","../presstojam/src/components/ptj-update-encrypted.vue","../presstojam/src/components/ptj-string.vue","../presstojam/src/js/user.js","../presstojam/src/js/meta/field.js","../presstojam/src/js/meta/id.js","../presstojam/src/js/meta/flag.js","../presstojam/src/js/meta/asset.js","../presstojam/src/js/meta/time.js","../presstojam/src/js/meta/number.js","../presstojam/src/js/meta/string.js","../presstojam/src/js/meta/fieldfactory.js","../presstojam/src/js/metarow.js","../presstojam/src/js/datacell.js","../presstojam/src/js/states.js","../presstojam/src/js/datarow.js","../presstojam/src/js/repo.js","../presstojam/src/components/ptj-tree-node.vue","../presstojam/src/components/ptj-number.vue","../presstojam/src/components/ptj-flag.vue","../presstojam/src/components/ptj-id.vue","../presstojam/src/components/ptj-asset.vue","../presstojam/src/components/ptj-table.vue","../presstojam/src/components/ptj-list.vue","../presstojam/src/components/ptj-filter-form.vue","../presstojam/src/components/ptj-pagination.vue","../presstojam/src/components/ptj-progress-bar.vue","../presstojam/src/components/ptj-create-form.vue","../presstojam/src/components/ptj-sort.vue","../presstojam/src/components/ptj-repo.vue","../presstojam/src/components/ptj-delete.vue","../presstojam/src/components/ptj-primary.vue","../presstojam/src/components/ptj-account-handler.vue","../presstojam/src/components/ptj-route.vue","../presstojam/src/components/ptj-site-map.vue","../presstojam/src/js/controller.js","../import.js"],"sourcesContent":["<template>\r\n  <a @click=\"toggleShow\" class=\"ptj-modal-button\"><slot name=\"button\"></slot></a>\r\n  <teleport :disabled=\"disabled\" :to=\"location\">\r\n  <div class=\"ptj-modal-backdrop\" v-show=\"active\" :class=\"getClass\" :style=\"relstyle\">\r\n    <div class=\"ptj-modal\" :class=\"cls\">\r\n        <header>\r\n            <button\r\n          type=\"button\"\r\n          class=\"btn-close\"\r\n          @click=\"toggleShow\"\r\n        >\r\n          x\r\n        </button>\r\n        </header>\r\n      <slot :toggleShow=\"toggleShow\" name=\"default\">\r\n      </slot>\r\n    </div>\r\n  </div>\r\n  </teleport>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed } from \"vue\"\r\n\r\nconst props = defineProps({\r\n    location : {\r\n        default : 'body'\r\n    },\r\n    relative : {\r\n        default : false\r\n    },\r\n    cls : String\r\n});\r\n\r\nlet active = ref(false);\r\n\r\nfunction toggleShow() {\r\n    active.value = (active.value) ? false : true;\r\n}\r\n\r\nfunction getOffsetToWrapper(el) {\r\n    let obj = {\r\n        left : 0,\r\n        top : 0,\r\n        width : el.offsetWidth,\r\n        height : el.offsetHeight,\r\n        wrapper : 0\r\n    };\r\n    \r\n    while(!el.classList.contains('ptj-table-wrapper')) {\r\n        obj.left += el.offsetLeft;\r\n        obj.top += el.offsetTop;\r\n        el=el.parentNode;\r\n    }\r\n\r\n    obj.wrapper = el.offsetWidth;\r\n\r\n    return obj;\r\n}\r\n\r\nlet relstyle = computed(() => {\r\n    if (props.relative) {\r\n        let obj = getOffsetToWrapper(props.relative);\r\n        let right = obj.wrapper - (obj.left + obj.width);\r\n        return \"position:absolute;top:\" + (obj.top + obj.height) + \"px;right:0px;\";\r\n    } else {\r\n        return \"\";\r\n    }\r\n});\r\n\r\n\r\nlet disabled = computed(() => {\r\n    return (props.location) ? false : true;\r\n});\r\n\r\n\r\nlet getClass = computed(() => {\r\n    if (props.location == 'body') {\r\n        return \"ptj-modal-backdrop-full\";\r\n    } else {\r\n        return \"\";\r\n    }\r\n});\r\n\r\n\r\n\r\n\r\n</script>\r\n<style>\r\n.ptj-modal-backdrop-full {\r\n    position : absolute;\r\n    top : 0;\r\n    left : 0;\r\n    height : 100vh;\r\n    width : 100vw;\r\n}\r\n</style>","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","let custom_headers  = {};\r\nlet main_url;\r\n\r\nexport default {\r\n\r\n    initSettings(settings) {\r\n        main_url = settings.url;\r\n\r\n        if (settings.custom_headers) {\r\n            for(let name in settings.custom_headers) {\r\n                custom_headers[name] = settings.custom_headers[name];\r\n            }\r\n        }\r\n    },\r\n\r\n    run(method, url, params, body) {\r\n        const headers = new Headers();\r\n        if (params) {\r\n            headers.set('Content-Type', 'application/json');\r\n            body = params;\r\n        }\r\n\r\n        for(let i in custom_headers) {\r\n            headers.set(i, custom_headers[i]);\r\n        }\r\n\r\n        const options = {\r\n            method  : method,\r\n            mode : 'cors',\r\n            cache : 'no-cache',\r\n            credentials : 'include',\r\n            headers  : headers,\r\n            body : body\r\n        }\r\n\r\n        const _self = this;\r\n\r\n        return fetch(main_url + url, options)\r\n        .then(response => {\r\n            if (response.ok) {\r\n                return response.json();\r\n            } else {\r\n                throw response;\r\n            }\r\n        });\r\n    }, \r\n    get(url, data) {\r\n        if (data) {\r\n            const params = new URLSearchParams();\r\n            for(let i in data) {\r\n                if (Array.isArray(data[i]) || (typeof data[i] == 'object' && data[i] !== null)) {\r\n                   params.append(i, JSON.stringify(data[i]));\r\n                } else params.append(i, data[i]);\r\n            }\r\n\r\n            if (url.indexOf(\"?\") == -1) url += \"?\";\r\n            else url += \"&\";\r\n            url += params.toString();\r\n        }\r\n        return  this.run('GET', url);\r\n    },\r\n\r\n    getprimary(url, data) {\r\n        return this.get(url, data);\r\n    },\r\n\r\n    post(url, data) {\r\n        //call our fetch response and return\r\n        return this.run('POST', url, JSON.stringify(data));\r\n    },\r\n\r\n    put(url, data) {\r\n        return this.run('PUT', url, JSON.stringify(data));\r\n    },\r\n\r\n    patch(url, data) {\r\n        return this.run('PATCH', url, null, data);\r\n    },\r\n\r\n    getAsset(url) {\r\n        const headers = new Headers();\r\n        for(let i in custom_headers) {\r\n            headers.set(i, custom_headers[i]);\r\n        }\r\n\r\n        const options = {\r\n            method  : 'GET',\r\n            mode : 'cors',\r\n            cache : 'no-cache',\r\n            credentials : 'include',\r\n            headers  : headers\r\n        }\r\n\r\n        const _self = this;\r\n\r\n        return fetch(main_url + url, options)\r\n        .then(response => {\r\n            if (response.ok) {\r\n                return response.blob();\r\n            } else {\r\n                throw response;\r\n            }\r\n        });\r\n    },\r\n\r\n    delete(url, data) {\r\n        return this.run('DELETE', url, JSON.stringify(data));\r\n    }\r\n}\r\n","class MapModel {\r\n\r\n    constructor() {\r\n        this._route = '';\r\n        this._flow = '';\r\n        this._model = '';\r\n        this._state = '';\r\n        this._key = 0;\r\n        this._to = '';\r\n        this._params = {};\r\n        this._base = \"/\";\r\n        this._default = false;\r\n    \r\n        const keys = Object.keys(this);\r\n\r\n        keys.forEach(property => {\r\n          if (property[0] == \"_\") {\r\n            Object.defineProperty(this, property.substring(1), {\r\n                get: function() { \r\n                    return this[property];\r\n                },\r\n                set: function(newValue) {\r\n                    if (newValue != this[property]) {\r\n                        this[property] = newValue;\r\n                    }\r\n                }\r\n            });\r\n          } \r\n        });\r\n\r\n\r\n        this.action_map = {\r\n            'post' : '-create',\r\n            'put' : '-update',\r\n            'delete' : '-delete',\r\n            'login' : '-login',\r\n            'logout' : '-logout',\r\n            'primary' : '-primary',\r\n            'parent' : '-parent',\r\n            'get' : ''\r\n        };\r\n\r\n    }\r\n\r\n    get id() {\r\n        return this.model + \"-\" + this.state + \"-\" + this.to;\r\n    }\r\n\r\n    reset() {\r\n        this.route = '';\r\n        this.flow = '';\r\n        this.model = '';\r\n        this.state = '';\r\n        this.key = 0;\r\n        this.to = '';\r\n        this.params = {};\r\n    }\r\n\r\n\r\n    convertToURL() {\r\n        let url = this._base + this.route + \"/\" + this.flow;\r\n        if (this.model != this.flow) url += \"/\" + this.model;\r\n        url += this.action_map[this.state];\r\n        if (this.key) url += \"-\" + this.key;\r\n        if (this.to) url += \"-to-\" + this.to;\r\n\r\n        let params = new URLSearchParams();\r\n        for(const i in this.params) {\r\n            if (!this.params[i]) continue;\r\n            if (typeof this.params[i] == 'object') {\r\n                let pts = [];\r\n                for(let x in this.params[i]) {\r\n                    pts.push(this.params[i][x]);\r\n                }\r\n                params.append(i, pts.join(\",\"));\r\n            } else {\r\n                params.append(i, this.params[i]);\r\n            }\r\n        }\r\n\r\n        let param_str = params.toString();\r\n        if (param_str) url += \"?\" + param_str;\r\n\r\n        return url;\r\n    }\r\n    \r\n    initSettings(settings) {\r\n        if (settings) this._base = settings.base;\r\n        this.convertFromURL();\r\n    }\r\n\r\n    convertFromURL() {\r\n        let url_obj = new URL(window.location.href);\r\n        let url = url_obj.pathname.replace(this.base, \"\");\r\n        url = url.replace(/^\\/+|\\/+$/g, '');\r\n\r\n        if (!url) return;\r\n\r\n\r\n        let parts = url.split(\"/\");\r\n\r\n        if (parts.length >= 3) {\r\n            this.route = parts[0];\r\n            this.flow = parts[1];\r\n            url = parts[2];\r\n        } else if (parts.length >= 2) {\r\n            this.route = parts[0];\r\n            url = parts[1];\r\n        }\r\n        \r\n        const _self = this;\r\n        url_obj.searchParams.forEach(function(value, key) {\r\n            _self.params[key] = (value.indexOf(\",\") > -1) ? value.split(\",\") : value;\r\n        });\r\n\r\n       \r\n        parts = url.split(\"-to-\");\r\n        if (parts.length > 1) {\r\n            this.to = parts[1];\r\n            url = parts[0];\r\n        }\r\n\r\n       \r\n        parts = url.split(\"-\");\r\n        let key = parts[parts.length - 1];\r\n        if (key == \"first\") {\r\n            this.key = key;\r\n            parts.pop();\r\n        } else if (!isNaN(key)) {\r\n            this.key = parseInt(key);\r\n            parts.pop();\r\n        }\r\n            \r\n        if (parts.length == 0) {\r\n            throw new Error(\"Can't convert this url string: \" + url);\r\n        }\r\n    \r\n        this.state = \"get\";\r\n        for(let i in this.action_map) {\r\n            if (this.action_map[i] == \"-\" + parts[parts.length - 1]) {\r\n                this.state = i\r\n                parts.pop();\r\n                break;\r\n            }\r\n        }\r\n        this.model = parts.join(\"-\");\r\n        if (!this.route) this.route = this.model;\r\n        if (!this.flow) this.flow = this.model;\r\n    }\r\n\r\n    getAll() {\r\n        return {\r\n            route : this.route,\r\n            model : this.model,\r\n            state : this.state,\r\n            key : this.key,\r\n            to : this.to,\r\n            params : this.params,\r\n            base : this.base,\r\n            default : this.default\r\n        };\r\n    }\r\n\r\n    apply(route) {\r\n        for(let i in route) {\r\n            this[i] = route[i];\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport const Map = new MapModel();\r\n\r\n","import { reactive } from \"vue\"\r\nimport client from \"./client.js\"\r\nimport { Map } from \"./map.js\"\r\n\r\n\r\nlet model_settings = {};\r\n\r\nwindow.onpopstate = function() {\r\n    Map.reset();\r\n    Map.convertFromURL();\r\n    runRoute();\r\n}\r\n\r\nexport const RouteStore = reactive({ \r\n    component : '', \r\n    title : '',\r\n    name : '',\r\n    route : { \"children\" : [], parent : null, \"perms\" : []}, \r\n    slug : [],\r\n    sort : false\r\n});\r\n\r\nfunction setComponent() {\r\n    if (Map.state == \"get\" || Map.state == \"parent\") {\r\n        RouteStore.component = \"ptj-repo\";\r\n    } else if (Map.state == \"primary\") {\r\n        RouteStore.component = \"ptj-primary\";\r\n    } else if (Map.state == \"login\") {\r\n        RouteStore.component = \"ptj-account-handler\";\r\n    }\r\n}\r\n\r\n\r\nexport function initSettings(settings) {\r\n    if (settings) model_settings = settings;\r\n}\r\n\r\n\r\nexport function getModelSettings() {\r\n    if (model_settings[Map.model] && model_settings[Map.model][Map.state]) {\r\n        return model_settings[Map.model][Map.state];\r\n    }\r\n    return {};\r\n}\r\n\r\n\r\nexport function loadRoute() {\r\n    RouteStore.component = \"\";\r\n    RouteStore.route.children = [];\r\n    RouteStore.route.parent = null;\r\n    RouteStore.route.perms = [];\r\n    RouteStore.route.title = \"\";\r\n    RouteStore.route.name = \"\";\r\n    RouteStore.sort = false;\r\n    return client.get(\"/route/\" + Map.route + \"/\" + Map.flow + \"/\" + Map.model)\r\n    .then(response => {   \r\n        RouteStore.route.children = response.children;\r\n        RouteStore.route.perms = response.perms;\r\n        RouteStore.route.parent = response.parent;\r\n        RouteStore.title = response.title;\r\n        RouteStore.name = response.name;\r\n        if (response.sort) RouteStore.sort = true;\r\n        setComponent();\r\n    })\r\n    .then(response => {\r\n\r\n    })\r\n    .catch(e => console.log(e));\r\n}\r\n\r\nexport function loadSlugTrail() {\r\n    RouteStore.slug = [];\r\n    let params = {};\r\n    if (Map.key) {\r\n        if (Map.state == \"parent\") params[\"--parentid\"] = Map.key;\r\n        else if (Map.state == \"primary\") params[\"--id\"] = Map.key;\r\n    } else {\r\n        return;\r\n    }\r\n\r\n    return client.get(\"/slug/\" + Map.route + \"/\" + Map.flow + \"/\" + Map.model, params)\r\n    .then(response => {\r\n        RouteStore.slug = response;\r\n        for(let i in RouteStore.slug) {\r\n            i=parseInt(i);\r\n            if (i > 0) {\r\n                RouteStore.slug[i].route = {\r\n                    model : RouteStore.slug[i].model,\r\n                    state : 'parent',\r\n                    key : RouteStore.slug[i].id\r\n                }\r\n            } else {\r\n                RouteStore.slug[i].route = {\r\n                    model : RouteStore.slug[i].model,\r\n                    state : 'get',\r\n                    key : 0\r\n                }\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\n\r\nexport function refresh() {\r\n    location.href = Map.base;\r\n}\r\n\r\nexport function redirect() {\r\n    addToHistory();\r\n    runRoute();\r\n}\r\n\r\nexport function addToHistory() {\r\n    const url_str = window.location.protocol + \"//\" + window.location.host +  Map.convertToURL();\r\n    const url = new URL(url_str);\r\n    window.history.pushState({'name' : url.pathname}, document.title, url);\r\n}\r\n\r\nexport function runRoute() {\r\n    loadRoute();\r\n    loadSlugTrail();\r\n}\r\n","<template>\r\n  <a class=\"ptj-button\" :key=\"route\" @click=\"run\">\r\n    <slot />\r\n  </a> \r\n</template>\r\n\r\n<script setup>\r\n\r\n\r\nimport { redirect } from \"./../js/route.js\"\r\nimport { Map } from \"./../js/map.js\"\r\n\r\nconst props = defineProps({\r\n    route : Object\r\n});\r\n\r\n\r\nfunction run() {\r\n    for(let i in props.route) {\r\n        if (props.route[i] !== null) Map[i] = props.route[i];\r\n    }\r\n    Map.params = {};\r\n    redirect();\r\n}\r\n\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\n</style>","<template>\r\n    <div class=\"ptj-multiple-select\">\r\n        <div class=\"ptj-multiple-select-display\">\r\n            <div class=\"ptj-multiple-select-values\">\r\n                <div class=\"ptj-multiple-select-val\" v-for=\"val in field.change1\" :key=\"val\">\r\n                    {{ val }}\r\n                    <a class=\"ptj-multiple-select-val-remove\" @click=\"remove(val)\"><span class=\"material-icons\">close</span></a>\r\n                </div>\r\n            </div>\r\n            <input type=\"text\" v-model=\"custom_val\" />\r\n            <a @click=\"selectCustom\" class=\"ptj-multiple-select-add\">add</a>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script setup>\r\n\r\nimport { ref } from \"vue\"\r\n\r\n\r\nconst props = defineProps({\r\n    field : Object,\r\n});\r\n\r\nconst custom_val = ref(\"\");\r\n\r\nfunction remove(key) {\r\n    props.field.change = props.field.change.filter(function(item) {\r\n        return item !== key\r\n    });\r\n}\r\n\r\nfunction selectCustom() {\r\n    props.field.change1 = custom_val.value;\r\n    custom_val.value = \"\";\r\n}\r\n\r\n\r\n</script>\r\n<style scoped>\r\n.ptj-multiple-select-val {\r\n    display : inline-block;\r\n    border : 1px solid green;\r\n    margin-left : 2px;\r\n    margin-right : 2px;\r\n    padding : 2px;\r\n    background-color : green;\r\n}\r\n\r\n\r\n.ptj-multiple-select-val-remove {\r\n    color : red;\r\n}\r\n\r\n\r\n.ptj-multiple-select-display {\r\n    position :relative;\r\n    background-color : #fff;\r\n    border : 1px solid #cdcdcd;\r\n    min-height : 35px;\r\n\r\n}\r\n\r\n</style>","<template>\r\n    <div class=\"ptj-multiple-select\">\r\n        <div class=\"ptj-multiple-select-display\">\r\n            <div class=\"ptj-multiple-select-values\">\r\n                <div class=\"ptj-multiple-select-val\" v-for=\"val in field.change\" :key=\"val\">\r\n                    {{ getOption(val) }}\r\n                    <a class=\"ptj-multiple-select-val-remove\" @click=\"remove(val)\"><span class=\"material-icons\">close</span></a>\r\n                </div>\r\n            </div>\r\n            <a class=\"ptj-multiple-select-arrow\" @click=\"toggleList\">\r\n            <span class=\"material-icons\">{{ show_list.symbol }}</span>\r\n            </a>\r\n        </div>\r\n        <ul class=\"ptj-multiple-select-options\" v-show=\"show_list.display\" @click=\"select\">\r\n            <li v-for=\"option in options\" :key=\"option.key\" :data-key=\"option.key\">{{ option.value }}</li>\r\n        </ul>\r\n    </div>\r\n</template>\r\n<script setup>\r\n\r\nimport { reactive } from \"vue\"\r\nimport { Map } from \"./../js/map.js\"\r\n\r\nconst props = defineProps({\r\n    field : Object,\r\n    options : {\r\n        type : Array,\r\n        required : true\r\n    }\r\n});\r\n\r\n\r\n\r\nfunction getOption(key) {\r\n    for(let opt of props.options) {\r\n        if (opt.key == key) return opt.value;\r\n    }\r\n}\r\n\r\n\r\nconst show_list = reactive({\r\n    display : false,\r\n    symbol : 'keyboard_arrow_down'\r\n});\r\n\r\n\r\nfunction toggleList() {\r\n    if (show_list.display) {\r\n        show_list.display = false;\r\n        show_list.symbol = 'keyboard_arrow_down';\r\n    } else {\r\n        show_list.display = true;\r\n        show_list.symbol = 'keyboard_arrow_up';\r\n    }\r\n}\r\n\r\n\r\nfunction remove(key) {\r\n    props.field.change = props.field.change.filter(function(item) {\r\n        return item !== key\r\n    });\r\n}\r\n\r\n\r\n\r\nfunction select(e) {\r\n    props.field.change1 = e.target.getAttribute(\"data-key\");\r\n    toggleList();\r\n}\r\n</script>\r\n<style scoped>\r\n.ptj-multiple-select-val {\r\n    display : inline-block;\r\n    border : 1px solid green;\r\n    margin-left : 2px;\r\n    margin-right : 2px;\r\n    padding : 2px;\r\n    background-color : green;\r\n}\r\n\r\n\r\n.ptj-multiple-select-val-remove {\r\n    color : red;\r\n}\r\n\r\n.ptj-multiple-select-arrow {\r\n    position :absolute;\r\n    right : 2px;\r\n    top : 3px;\r\n}\r\n\r\n.ptj-multiple-select-display {\r\n    position :relative;\r\n    background-color : #fff;\r\n    border : 1px solid #cdcdcd;\r\n    min-height : 35px;\r\n\r\n}\r\n\r\n.ptj-multiple-select-options li {\r\n    list-style: none;\r\n    cursor: pointer;\r\n    margin-top : 2px;\r\n    border : 1px solid #cdcdcd;\r\n    background-color : #fff;\r\n}\r\n\r\n.ptj-multiple-select-options li:hover {\r\n    background-color : #f9f9fb;\r\n    transition : background-color .2s ease-out,border .2s ease-out;\r\n}\r\n</style>","let dictionary = {};\r\n\r\nexport function setDictionary(dict) {\r\n    dictionary = dict;\r\n}\r\n\r\n\r\nexport function getDictionary(id, vals) {\r\n    let str = \"\";\r\n    if (!vals) {\r\n        if (dictionary[id]) str = dictionary[id];\r\n        return str;\r\n    }\r\n    \r\n    if (vals.model) {\r\n        if (vals.field) {\r\n            if (vals.field.indexOf(\"/\") > -1) {\r\n                let exp = vals.field.split(\"/\");\r\n                vals.field = exp.pop();\r\n            }\r\n            \r\n            if (dictionary.models[vals.model] && dictionary.models[vals.model].fields[vals.field]) {\r\n                str= dictionary.models[vals.model].fields[vals.field][id];\r\n            }\r\n        } else {\r\n            if ( dictionary.models[vals.model]) {\r\n                str = dictionary.models[vals.model][id];\r\n            }\r\n        }\r\n    } else if (vals.type) {\r\n        if (dictionary[id][vals.type]) str = dictionary[id][vals.type];\r\n        else str = dictionary[id].def;\r\n    } else {\r\n        str = dictionary[id];\r\n    }\r\n\r\n    if (vals.val) {\r\n        str = str.replace( /\\{\\{(.*?)\\}\\}/g, vals.val);    \r\n\r\n        //s.replace( /\\{\\{(.*?)\\}\\}/g, function(x){          // this grabs replacement tags\r\n          //  return x.replace( /\\[(\\d+)\\]/g,'.$1' )});      \r\n    }\r\n\r\n    if (!str && vals.default) str = vals.default;\r\n    return str;\r\n}","const error_invalid_map = {\r\n            1 : \"too small\",\r\n            2 : \"too large\",\r\n            3 : \"contains incorrect characters\",\r\n            4 : \"doesn't contain required characters\",\r\n            5 : \"not unique\"\r\n}\r\n\r\nexport function getError(code) {\r\n    return error_invalid_map[code];\r\n}\r\n\r\nexport const Errors = {\r\n    OK : 0,\r\n    MIN_VALUE : 1,\r\n    MAX_VALUE : 2,\r\n    HAS : 3,\r\n    HAS_NOT : 4\r\n}\r\n","<template>\r\n    <input type=\"text\"\r\n        :name=\"field.name\"\r\n        v-model=\"val\" \r\n        @blur=\"store.validateon = true\" />\r\n</template>\r\n<script setup>\r\nimport { reactive, computed } from 'vue'\r\n\r\nconst props = defineProps({\r\n    field : {\r\n        type : Object,\r\n        required : true\r\n    }\r\n});\r\n\r\nconst store = reactive({ validateon : false, val : ''});\r\n\r\nconst val = computed({\r\n    get() {\r\n        return store.val;\r\n    },\r\n    set(val) {\r\n        if (val != field.val) {\r\n\r\n        }\r\n        store.val = val;\r\n    }\r\n});\r\n</script>\r\n","<template>\r\n    <form @submit.prevent=\"submit\" v-show=\"fstate==0\" class=\"ptj-form\" :class=\"Map.model + ' ' + Map.state\">\r\n        <ptj-form-row :field=\"field\">\r\n           <input type=\"password\"\r\n                :name=\"field.name\"\r\n                v-model=\"field.change\" \r\n                @blur=\"field.validateon = true\" />\r\n        </ptj-form-row>\r\n        <ptj-form-row :field=\"field\">\r\n          <ptj-confirm :field=\"field\" />\r\n        </ptj-form-row>\r\n        <input type=\"submit\" :value=\"getDictionary('ptj-reset-form-btn')\" class=\"ptj-form-submit\">\r\n  </form>\r\n</template>\r\n\r\n<script setup>\r\n\r\nimport { ref } from \"vue\"\r\nimport { getDictionary } from \"./../js/dictionary.js\"\r\nimport PtjFormRow from \"./ptj-form-row.vue\"\r\nimport PtjConfirm from \"./ptj-form-confirm.vue\"\r\nimport { Map } from \"./../js/map.js\"\r\n\r\nconst props = defineProps({\r\n    field : Object\r\n});\r\n\r\nconst fstate = ref(0);\r\n\r\nconst emit = defineEmits(['close']);\r\n\r\nfunction submit() {\r\n\r\n    fstate.value = 1;\r\n    let key = 0;\r\n    let ndata = {};\r\n    ndata[\"--id\"] = Map.key; //only called from primary field\r\n    ndata[field.name] = field.change;\r\n    return client.put(\"/data/\" +  Map.model, ndata)\r\n    .then(() => {\r\n        emit(\"close\");\r\n    })\r\n    .catch(err => {\r\n            //show error fields, mark fields as invalidated\r\n        fstate.value = 0;\r\n        if (typeof err == \"string\") {\r\n            globalerror = err;\r\n        } else {\r\n            cdata.setErrors(err);\r\n        }\r\n    });\r\n}\r\n\r\n</script>","<template>\r\n   <ptj-modal v-if=\"field.encrypted && field.mode=='edit'\">\r\n        <template #button>\r\n            {{ getDictionary('ptj-repo-post') }}\r\n        </template>\r\n        <template #default=\"encryptedScope\">\r\n            <ptj-update-encrypted @close=\"encryptedScope.toggleShow\" :field=\"field\"/>\r\n        </template>\r\n    </ptj-modal>\r\n   <textarea v-if=\"tag=='textarea' && (field.mode=='edit' || field.mode =='post')\"\r\n        v-bind=\"atts\" \r\n        :name=\"field.name\" \r\n        v-model=\"field.change\"></textarea>\r\n   <div v-else-if=\"tag=='textarea' && field.mode=='view'\">{{ field.val }}</div>\r\n   <ptj-multiple-select v-else-if=\"tag=='select' && field.mode == 'filter'\" :field=\"field\" :options=\"options\" />\r\n  <select v-else-if=\"tag=='select' && (field.mode=='edit' || field.mode =='post')\" \r\n        v-model=\"field.change\"\r\n        :name=\"field.name\"\r\n        v-bind=\"atts\"\r\n         @blur=\"field.validateon = true\"\r\n        >\r\n        <option value=\"\" selected disabled>{{ getDictionary('ptj-string-default') }}</option>\r\n        <option v-for=\"option in options\" :key=\"option.key\" :value=\"option.key\">{{ option.value }}</option>\r\n  </select>\r\n  <input v-else-if=\"field.mode=='edit' || field.mode=='post'\" v-bind=\"atts\"\r\n        :name=\"field.name\"\r\n        v-model=\"field.change\" \r\n        @blur=\"field.validateon = true\" />\r\n   <ptj-multiple-input :field=\"field\" v-else-if=\"field.mode=='filter'\"/>\r\n  <span v-else-if=\"field.mode=='view' && field.reference\">\r\n    <ptj-button :route=\"{model : field.reference, key : field.val, state:'primary' }\">{{ field.val }}</ptj-button>\r\n  </span>\r\n  <span v-else>{{ field.val }}</span>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from \"vue\"\r\nimport PtjButton from \"./ptj-button.vue\"\r\nimport PtjMultipleInput from \"./ptj-multiple-input.vue\"\r\nimport PtjMultipleSelect from \"./ptj-multiple-select.vue\"\r\nimport { getDictionary } from \"./../js/dictionary.js\"\r\nimport PtjModal from \"./ptj-modal.vue\"\r\nimport PtjUpdateEncrypted from \"./ptj-update-encrypted.vue\"\r\n\r\nimport { computed } from \"vue\"\r\nconst props = defineProps({\r\n    field : {\r\n        type : Object,\r\n        required : true\r\n    }\r\n});\r\n\r\nlet ctype = computed(() => {\r\n    return (props.type == 'edit' && props.field.immutable) ? \"view\" : props.type;\r\n});\r\n\r\nconst options = ref([]);\r\n\r\nfunction isEnum(contains) {\r\n    if (contains.length == 0) return null;\r\n    let enums=[];\r\n    const regEx = new RegExp(/^[a-zA-Z]+[a-zA-Z0-9._]+$/);\r\n    for(let exp of contains) {\r\n        if (!exp) continue;\r\n        if (regEx.test(exp)) {\r\n            enums.push(exp);\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n    return enums;\r\n}\r\n\r\nconst tag = computed(() => {\r\nif (isEnum(props.field.contains)) {\r\n    props.field.setContainsAsOptions(options);\r\n    return \"select\";\r\n} else if (props.field.encrypted) {\r\n    return \"input\";\r\n} else if (props.field.html || props.field.max > 300) {\r\n    return \"textarea\";\r\n} else {\r\n    return \"input\";\r\n}\r\n});\r\n\r\n\r\nconst atts = computed(() => {\r\nlet atts = {};\r\nif (props.field.encrypted) {\r\n    atts.type = \"password\";\r\n}\r\n\r\nif (props.field.immutable) {\r\n    atts.readonly = true;\r\n}\r\n\r\n\r\nlet pholder = getDictionary('placeholder', { \"model\" : props.field.model, \"field\" : props.field.name });\r\nif (pholder) {\r\n    atts.placeholder = pholder;\r\n}\r\n\r\nif (props.field.contains.includes(\"html\")) {\r\n    atts[\"data-html\"] = 1;\r\n}\r\nreturn atts;\r\n});\r\n\r\n\r\n</script>\r\n","import { reactive } from \"vue\"\r\nimport { refresh } from \"./route.js\"\r\nimport Client from \"./client.js\"\r\nimport { Map } from \"./map.js\"\r\nimport { setDictionary } from \"./dictionary.js\"\r\n\r\nexport const User = reactive({init : false, login : false, user : \"public\" });\r\n\r\nexport function logout() {\r\n    Client.post(\"/core/logout\")\r\n    .then(() => {\r\n        refresh();\r\n    });\r\n}\r\n\r\nfunction getDefault() {\r\n    for(let cat in NavStore.cats) {\r\n        for(let route of NavStore.cats[cat]) {\r\n            if (route.default) {\r\n                return route;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\nconst user_check = 600000;\r\n\r\nexport function checkLoginStatus() {\r\n    Client.get(\"/core/check-user\")\r\n    .then(response => {\r\n        if (response.is_expired) {\r\n            return Client.put(\"/core/switch-tokens\")\r\n            .then(() => {\r\n                checkLoginStatus();\r\n            });\r\n        }\r\n    }).then(response => {\r\n        if (User.user != \"public\") setTimeout(checkLoginStatus, user_check);\r\n    }).catch(e => {\r\n        User.login = true;\r\n    });\r\n}\r\n\r\nexport function initUser(role = \"\") {\r\n    return Client.get(\"/core/check-user\")\r\n    .then(response => {\r\n        if (response.is_expired) {\r\n            return Client.put(\"/core/switch-tokens\")\r\n            .then(() => {\r\n                return Client.get(\"/core/check-user\");\r\n            });\r\n        } else {\r\n            return response;\r\n        }\r\n    })\r\n    .then(response => {\r\n        User.user = response.user;\r\n        User.role = response.role;\r\n        User.init = true;\r\n\r\n        if (User.role != role) {\r\n            let url = \"/core/change-role\";\r\n            if (role) url += \"/\" + role;\r\n            return Client.post(url)\r\n            .then(response => {\r\n                User.role = role;\r\n            });\r\n        }\r\n    }).then(() => {\r\n        checkLoginStatus();\r\n    }).then(() => {\r\n        return Client.get(\"/dictionary\")\r\n        .then(response => {\r\n            setDictionary(response);\r\n            return true;\r\n        });\r\n    }).catch(e => console.log(e));\r\n}\r\n\r\n","\r\nimport { Errors } from \"./../error.js\"\r\nimport { reactive, computed } from \"vue\"\r\n\r\n\r\nexport class Field {\r\n\r\n    constructor(name) {\r\n        this._name = name;\r\n        this._store = reactive({ summary : 0});\r\n        this._default_val = null;\r\n        this._immutable = false;\r\n        this._encrypted = false;\r\n        this._min = null;\r\n        this._max = null;\r\n        this._contains = [];\r\n        this._notcontains = [];\r\n        this._listeners = [];\r\n        \r\n        const keys = Object.keys(this);\r\n       \r\n        keys.forEach(property => {\r\n          if (property != \"_store\" && property[0] == \"_\") {\r\n            Object.defineProperty(this, property.substring(1), {\r\n                get: function() { \r\n                   return this[property];\r\n                },\r\n                set: function(newValue) {\r\n                    if (property == \"_type\") this._type = newValue.toLowerCase();\r\n                    else this[property] = newValue;\r\n                }\r\n            })\r\n          }\r\n        });\r\n      \r\n      \r\n        this.summary = computed({\r\n            get : () => {\r\n                return this._store.summary;\r\n            },\r\n            set : (val) => {\r\n                this._store.summary = (val) ? 1 : 0;\r\n            }\r\n        })\r\n\r\n    }\r\n\r\n    apply(obj) {\r\n        for (let x in obj) {\r\n            if (x == \"summary\") this.summary = (obj[x]) ? 1 : 0;\r\n            else if (x == \"validation\") continue;\r\n            else if (x == \"type\") this.type = obj[x].toLowerCase();\r\n            else this[x] = obj[x];\r\n        }\r\n\r\n        this._min = obj.validation.min;\r\n        this._max = obj.validation.max;\r\n        if (obj.validation.contains) this._contains = obj.validation.contains.split(\"|\");\r\n        if (obj.validation.notcontains) this._notcontains = obj.validation.notcontains.split(\"|\");\r\n    }\r\n\r\n\r\n    clean(val) {\r\n        return val;\r\n    }\r\n\r\n\r\n    calcValue(value) {\r\n        if (!value) return \"\";\r\n        else return value;\r\n    }\r\n\r\n\r\n    validateSize(val) {\r\n        if (val < this._min) return Errors.MIN_VALUE;\r\n        else if (val > this._max) return Errors.MAX_VALUE;\r\n        else return Errors.OK;\r\n    }\r\n\r\n\r\n    validate(val) {\r\n        if (val === null) return;\r\n        let err;\r\n        if (isNaN(val)) {\r\n            const length = (val) ? val.length : 0;\r\n            err = this.validateSize(length);\r\n        } else {\r\n            err = this.validateSize(val);\r\n        }\r\n        if (err != Errors.OK) return err;\r\n\r\n        for(let nhas of this._notcontains) {\r\n            if (val.match(nhas)) return Errors.HAS_NOT;\r\n        }\r\n\r\n        if (this._contains.length == 0) return Errors.OK;\r\n        \r\n        for(let has of this._contains) {\r\n            if (val.match(has)) return Errors.OK;\r\n        }\r\n        return Errors.HAS;\r\n    }\r\n\r\n\r\n    trigger(val) {\r\n        for(let state of this._listeners) {\r\n            state(val);\r\n        }\r\n    }\r\n\r\n\r\n    addParam(obj, val) {\r\n        if (val) {\r\n            obj[this._name] = val;\r\n        }\r\n    }\r\n\r\n\r\n    addAPIParam(obj, val) {\r\n        if (val) {\r\n            obj[this._name] = val;\r\n        }\r\n    }\r\n\r\n\r\n    getVal(store) {\r\n        return store.value;\r\n    }\r\n\r\n    setVal(store, val) {\r\n        store.value = this.clean(val);\r\n        store.error = this.validate(val);\r\n    }\r\n\r\n    getChange(store) {\r\n        if (store.change == null) return store.value;\r\n        else return store.change;\r\n    }\r\n\r\n    setChange(store, val) {\r\n        store.change = this.clean(val);\r\n        store.error = this.validate(val);\r\n        this.trigger(val);\r\n    }\r\n\r\n    getFilter(store) {\r\n        return store.value;\r\n    }\r\n    \r\n    setFilter(store, val) {\r\n        store.value = val;\r\n    }\r\n\r\n    getErrorVal(error) {\r\n        if (error == Errors.MIN_VALUE) return this.min;\r\n        else if (error == Errors.MAX_VALUE) return this._max;\r\n        else if (error == Errors.HAS) return this._contains.join(\" | \");\r\n        else if (error == Errors.HAS_NOT) return this._notcontains;\r\n    }\r\n}\r\n\r\n\r\n","import { Field } from \"./field.js\"\r\nimport Client from \"./../client.js\"\r\n\r\nexport class ID extends Field {\r\n\r\n    constructor(name, obj) {\r\n\r\n        super(name);\r\n        \r\n        this._reference = false;\r\n        this._include_fields = [];\r\n        this._recursive = false;\r\n        this._reference_to;\r\n\r\n        this._default_val = 0;\r\n        if (obj) this.apply(obj);\r\n        if (obj.includes) this._include_fields = obj.includes;\r\n        if (obj.reference_to) this.referenceTo = obj.reference_to;\r\n    }\r\n\r\n\r\n    setReferenceOptions(url, params) {\r\n        return Client.get(url, params)\r\n        .then(response => {\r\n            let options = [];\r\n            for (let i in response) {\r\n                let key = response[i][\"--id\"];\r\n                let vals = [];\r\n                for(let x  in response[i]) {\r\n                    if (x != \"--id\") {\r\n                        vals.push(response[i][x]);\r\n                    }\r\n                }\r\n                options.push({ key: key, value: vals.join(\" \", vals) });\r\n            }\r\n           return options;\r\n        })\r\n        .catch(e => {\r\n            console.log(e);\r\n        });\r\n    }\r\n\r\n\r\n    getChange1(store) {\r\n        if (store.change == null) store.change = store.value;\r\n        let val = (store.change == null) ? [] : store.change;\r\n        return val;\r\n    }\r\n\r\n    \r\n    setChange1(store, val) {\r\n        if (store.change == null) store.change = [];\r\n        if (store.change.includes(val)) return;\r\n        store.change.push(this.clean(val));\r\n        store.error = this.validate(val);\r\n    }\r\n\r\n    get reference() {\r\n        return this._reference;\r\n    }\r\n\r\n    set reference(ref) {\r\n        this._reference = ref;\r\n    }\r\n\r\n    get include_fields() {\r\n        return this._include_fields;\r\n    }\r\n\r\n    set include_fields(fields) {\r\n        this._include_fields = fields;\r\n    }\r\n\r\n    get recursive() {\r\n        return this._recursive;\r\n    }\r\n\r\n    set recursive(recursive) {\r\n        this._recursive = recursive;\r\n    }\r\n\r\n    get referenceTo() {\r\n        return this._reference_to;\r\n    }\r\n\r\n    set referenceTo(ref) {\r\n        this._reference_to = ref;\r\n    }\r\n\r\n}","import { Field } from \"./field.js\"\r\n\r\nexport class Flag extends Field {\r\n\r\n    constructor(name, obj) {\r\n        super(name);\r\n        if (obj) this.apply(obj);\r\n    }\r\n\r\n\r\n    clean(val) {\r\n        return (val) ? 1 : 0;\r\n    }\r\n\r\n\r\n    getChange1(store) {\r\n        if (store.change == null) store.change = store.value;\r\n        if (store.change == null) return 0;\r\n        else if (!store.change) return 2;\r\n        else return store.change;\r\n    }\r\n\r\n    setChange1(store, val) {\r\n        if (val == 0) {\r\n            store.change = null;\r\n            return;\r\n        }\r\n        if (val == 2) val = 0;\r\n        store.change = this.clean(val);\r\n        store.error = this.validate(val);\r\n    }\r\n\r\n}","import { Field } from \"./field.js\"\r\nimport Client from \"./../client.js\"\r\n\r\nexport class Asset extends Field {\r\n\r\n    constructor(name, obj) {\r\n        super(name);\r\n        this._size = 0;\r\n      this._blob = null;\r\n      this._uploaded = false;\r\n      this._chunk_size = 0;\r\n      this._url;\r\n      this._key = 0;\r\n\r\n      if (obj) this.apply(obj);\r\n    }\r\n\r\n    set chunk_size(chunk) {\r\n        this._chunk_size = chunk;\r\n      }\r\n  \r\n      set blob(blob) {\r\n        this._blob = blob;\r\n      }\r\n  \r\n      set url(url) {\r\n          this._url = url;\r\n      }\r\n  \r\n      set key(key) {\r\n          this._key = key;\r\n      }\r\n  \r\n  \r\n      get blob() {\r\n        return this._blob;\r\n      }\r\n  \r\n      get size() {\r\n        return this._size;\r\n      }\r\n  \r\n      get uploaded() {\r\n        return this._uploaded;\r\n      }\r\n  \r\n      get chunk_size() {\r\n        return this._chunk_size;\r\n      }\r\n  \r\n  \r\n      get url() {\r\n          return this._url;\r\n      }\r\n  \r\n  \r\n      getChunk(index) {\r\n        const start = (this._chunk_size == 0) ? 0 : index * this._chunk_size;\r\n        let end = (this._chunk_size == 0) ? this._size : (index + 1) * this._chunk_size;\r\n        if (end > this._size) end = this._size;\r\n        const view = new DataView(this._blob, start, end - start);\r\n        let buffer = [];\r\n        for(let i = 0, n=view.byteLength; i<n; ++i) {\r\n          buffer.push(view.getInt8(i));\r\n        }\r\n        return buffer.join('');\r\n      }\r\n  \r\n  \r\n      loadFile(id) {\r\n          let data = {};\r\n          data.__key = id;\r\n          return Client.get(this._url, data)\r\n          .catch(e => {\r\n              alert(e);\r\n          });\r\n      }\r\n  \r\n      delFile(id) {\r\n          let data = {};\r\n          data.__key = id;\r\n          return Client.delete(this._url, data)\r\n          .catch(e => {\r\n              alert(e);\r\n          });\r\n      }\r\n  \r\n      saveFile(file) {\r\n          //this needs to be a promise\r\n          this._size = file.size;\r\n          return new Promise(( resolve, reject) => {\r\n            const fr = new FileReader();\r\n            let _self = this;\r\n            fr.onload = function(e) {\r\n              _self.blob = e.target.result;\r\n              resolve(fr.result);\r\n            }\r\n            fr.onerror = reject;\r\n            fr.readAsArrayBuffer(file);  \r\n          })\r\n          .then(() => {\r\n            let promises = [];\r\n            //else, do we have any assets?\r\n            let chunks = (this.chunk_size == 0) ? 1 : Math.ceil(this.size / this.chunk_size);\r\n            for(let i=0; i<chunks; ++i) {\r\n                const data = {};\r\n                data.__chunk = i;\r\n                data.__blob = this.getChunk(i);\r\n                promises.push(Client.put(this._url, data));\r\n            }\r\n            return Promise.all(promises);\r\n          });\r\n        }\r\n} ","import { Field } from \"./field.js\"\r\n\r\nexport class Time extends Field {\r\n\r\n    constructor(name, obj) {\r\n        super(name);\r\n        if (obj) this.apply(obj);\r\n    }\r\n\r\n\r\n    addAPIParam(obj, val) {\r\n        let cobj = {};\r\n        if (val) {\r\n            if (val.min) cobj.min = val.min;\r\n            if (val.max) cobj.max = val.max;\r\n            if (Object.keys(cobj).length > 0) {\r\n                obj[this._name] = cobj;\r\n            }\r\n        }\r\n    }\r\n\r\n    \r\n    getChange1(store) {\r\n        if (store.change == null) store.change = store.value;\r\n        if (!store.change) return \"\";\r\n        return store.change.min;\r\n    }\r\n\r\n\r\n    setChange1(store, val) {\r\n        if (store.change2 != null && val > store.change2) {\r\n            throw \"Trying to set min number larger than max\";\r\n        } \r\n        if (!store.change) store.change = { min: null, max: null };\r\n        store.change.min = this.clean(val);\r\n        store.error = this.validate(val);\r\n    }\r\n\r\n\r\n    getChange2(store) {\r\n        if (store.change2 == null) store.change2 = store.value;\r\n        if (!store.change2) return \"\";\r\n        return store.change2;\r\n    }\r\n\r\n\r\n    setChange2(store, val) {\r\n        if (store.change != null && val < store.change2) {\r\n            throw \"Trying to set max number larger than min\";\r\n        }\r\n        store.change2 = this.clean(val);\r\n        store.error = this.validate(val);\r\n    }\r\n}","import { Field } from \"./field.js\"\r\n\r\nexport class Number extends Field {\r\n    constructor(name, obj) {\r\n        super(name);\r\n        this._round = 0;\r\n\r\n        if (obj) this.apply(obj);\r\n    }\r\n\r\n    clean(val) {\r\n        if (this._round) return parseFloat(val);\r\n        else return parseInt(val);\r\n    }\r\n\r\n    getVal(store) {\r\n        let val = (store.value) ? store.value : 0;\r\n        return val.toFixed(this._round);\r\n    }\r\n\r\n    setVal(store, val) {\r\n        store.value = this.clean(val);\r\n        store.error = this.validate(val);\r\n    }\r\n\r\n    getChange(store) {\r\n        if (store.change == null) store.change=  store.value;\r\n        if (!store.change) return \"\";\r\n        return store.change.toFixed(this._round);\r\n    }\r\n\r\n    setChange(store, val) {\r\n        store.change = this.clean(val);\r\n        store.error = this.validate(val);\r\n        this.trigger(val);\r\n    }\r\n\r\n    getFilter(store) {\r\n        let val = (store.value) ? store.value : 0;\r\n        return store.value.toFixed(this._round);\r\n    }\r\n    \r\n    setFilter(store, val) {\r\n        store.value = this.clean(val);\r\n    }\r\n\r\n\r\n    getChange1(store) {\r\n        if (store.change == null) store.change = store.value;\r\n        if (!store.change) return \"\";\r\n        return store.change.toFixed(this._round);\r\n    }\r\n\r\n\r\n    setChange1(store, val) {\r\n        if (store.change2 != null && val > store.change2) {\r\n            throw \"Trying to set min number larger than max\";\r\n        } \r\n        if (!store.change) store.change = store.value;\r\n       \r\n        store.change = this.clean(val);\r\n        store.error = this.validate(val);\r\n    }\r\n\r\n   \r\n    getChange2(store) {\r\n        if (store.change2 == null) store.change2 = store.value;\r\n        if (!store.change2) return \"\";\r\n        return store.change2.toFixed(this._round);\r\n    }\r\n\r\n\r\n    setChange2(store, val) {\r\n        if (store.change != null && val < store.change2) {\r\n            throw \"Trying to set max number larger than min\";\r\n        }\r\n        store.change2 = this.clean(val);\r\n        store.error = this.validate(val);\r\n    }\r\n\r\n    get round() {\r\n        return this._round;\r\n    }\r\n\r\n    set round(round) {\r\n        this._round = round;\r\n    }\r\n}","import { Field } from \"./field.js\"\r\n\r\nexport class String extends Field {\r\n\r\n    constructor(name, obj) {\r\n        super(name);\r\n\r\n        if (obj) this.apply(obj);\r\n    }\r\n\r\n    setContainsAsOptions(options) {\r\n        let opts = [];\r\n        for(let exp of this._contains) {\r\n            if (exp.indexOf(\":\") > -1) {\r\n                const pts = exp.split(\":\");\r\n                opts.push({ key : pts[0], value : pts[1]});\r\n            } else {\r\n                opts.push({ key : exp, value : exp});\r\n            }\r\n        }\r\n        options.value = opts;\r\n    }\r\n\r\n\r\n    addAPIParam(obj, val) {\r\n        if (val) {\r\n            let arr = [];\r\n            for(let i in val) {\r\n                if (val[i]) arr.push(\"%\" + val[i] + \"%\");\r\n            }\r\n            if (arr.length > 0) obj[this._name] = arr;\r\n        }\r\n    }\r\n\r\n    getChange1(store) {\r\n        if (store.change == null) store.change = store.value;\r\n        if (store.change == null) return [];\r\n        else return store.change;\r\n    }\r\n\r\n\r\n    setChange1(store, val) {\r\n        if (store.change == null) store.change = [];\r\n        store.change.push(this.clean(val));\r\n        store.error = this.validate(val);\r\n    }\r\n\r\n\r\n    getFilter(store) {\r\n        return store.value;\r\n    }\r\n\r\n\r\n    setFilter(store, val) {\r\n        if (Array.isArray(val)) store.value = val;\r\n        else if (val) store.value = [val];\r\n    }\r\n\r\n}","import { ID} from \"./id.js\"\r\nimport { Flag } from \"./flag.js\"\r\nimport { Asset } from \"./asset.js\"\r\nimport { Time } from \"./time.js\"\r\nimport { Number } from \"./number.js\"\r\nimport { String } from \"./string.js\"\r\n\r\nexport function createField(field, obj) {\r\n    if (obj.type == \"ID\") return new ID(field, obj);\r\n    else if (obj.type ==\"Number\") return new Number(field, obj);\r\n    else if (obj.type == \"Asset\") return new Asset(field, obj);\r\n    else if (obj.type == \"Flag\") return new Flag(field, obj);\r\n    else if (obj.type == \"Time\") return new Time(field, obj);\r\n    else return new String(field, obj);\r\n}","import { reactive} from \"vue\"\r\nimport { createField } from \"./meta/fieldfactory.js\"\r\n\r\nexport class MetaRow {\r\n\r\n    constructor() {\r\n        this._cells = {};\r\n        this._children = [];\r\n        this._active = 0;\r\n        this._init = false;\r\n        this._store = reactive({index : null});\r\n        this._state_groups = {};\r\n      \r\n        const keys = Object.keys(this);\r\n\r\n        keys.forEach(property => {\r\n          if (property[0] == \"_\") {\r\n            Object.defineProperty(this, property.substring(1), {\r\n                get: function() { \r\n                    return this[property];\r\n                },\r\n                set: function(newValue) {\r\n                    this[property] = newValue;\r\n                }\r\n            });\r\n          } \r\n        });\r\n    }\r\n\r\n\r\n    addChild(name, child) {\r\n        this._children[name] = child;\r\n    }\r\n\r\n    addState(name, action) {\r\n        this._actions[name] = action;\r\n    }\r\n\r\n\r\n    resetSummary(arr) {\r\n\r\n        for(let i in this._cells) {\r\n            this._cells[i].summary = false;\r\n        }\r\n        \r\n        for(let i in arr) {\r\n            if (this._cells[arr[i]]) {\r\n                this._cells[arr[i]].summary = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    setStates(fields) {\r\n        for(let i in fields) {\r\n            let groups = {};\r\n            if (fields[i].states) {\r\n                for(const state of fields[i].states) {\r\n                    if (!groups[state.depends_on]) groups[state.depends_on] = [];\r\n                    groups[state.depends_on].push(state); \r\n                }\r\n            }\r\n            this._state_groups[i] = groups;\r\n        }\r\n    }\r\n\r\n    mapField(field, obj) {\r\n        this._cells[field] = createField(field, obj);\r\n         \r\n        if (this._cells[field].recursive) {\r\n            this._store.index = field;\r\n        }\r\n    }\r\n\r\n    map(fields, limited_fields = []) {\r\n        if (limited_fields.length > 0) {\r\n            for(let field of limited_fields) {\r\n                this.mapField(field, fields[field]);\r\n            }\r\n        } else {\r\n            for (let i in fields) {\r\n                this.mapField(i, fields[i]);\r\n            }\r\n        }\r\n        this.setStates(fields);\r\n    }\r\n\r\n\r\n    getCellByType(type) {\r\n        let cells = {};\r\n        for(let i in this._cells) {\r\n            if (this._cells[i].type == type) cells[i] = this._cells[i];\r\n        }\r\n        return cells;\r\n    }\r\n\r\n    showAll() {\r\n        for(let i in this._cells) {\r\n            this._cells[i].summary = true;\r\n        }\r\n    }\r\n\r\n}","import { reactive, computed } from \"vue\"\r\n\r\nexport class DataCell {\r\n\r\n    constructor(meta) {\r\n        this._store = reactive({ \r\n            meta : meta, \r\n            value: null, \r\n            change: null,\r\n            change2 : null,\r\n            display: null, \r\n            error: 0, \r\n            is_validate_on: false,\r\n            mode : 'view'\r\n        });\r\n\r\n\r\n        const meta_keys = Object.getOwnPropertyNames(meta);\r\n        const keys = Object.keys(this);\r\n\r\n        const _self = this;\r\n        meta_keys.forEach(property => {\r\n            if (property[0] != \"_\" && !keys.includes(property)) {\r\n                this[property] = computed({\r\n                    get: function () {\r\n                        return _self.store.meta[property];\r\n                    },\r\n                    set: function (newValue) {\r\n                        _self.store.meta[property] = newValue;\r\n                    }\r\n                })\r\n            }\r\n        });\r\n\r\n\r\n\r\n        this.error = computed({\r\n            get: () => { return this._store.error; },\r\n            set: val => { \r\n                this._store.error = parseInt(val); \r\n                this._store.is_validate_on = true; \r\n            }\r\n        });\r\n\r\n        this.display = computed({\r\n            get: () => {\r\n                if (Array.isArray(this._store.display)) {\r\n                    if (this._store.display.length > 0) return this._store.display.join(\" \");\r\n                    else return this._store.value;\r\n                } else if (this._store.display) return this._store.display;\r\n                else return this._store.value;\r\n            },\r\n            set: (row) => {\r\n                this._store.display = [];\r\n                const fields = this._store.meta.include_fields;\r\n                if (fields) {\r\n                    for(const field of fields) {\r\n                        const fname = this._store.meta.name + \"/\" + field;\r\n                        this._store.display.push(row[fname]);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n        this.showError = computed(() => {\r\n            let res = this._store.is_validate_on && this._store.error ? true : false;\r\n            return this._store.is_validate_on && this._store.error ? true : false;\r\n        });\r\n\r\n        if (this._store.meta.default_val) this._store.value = this._store.meta.default_val;\r\n        else if (this._store.meta.type == \"select\") this._store.value = 0;\r\n\r\n        this.val = computed({\r\n            get: () => {\r\n                return this._store.meta.getVal(this._store);\r\n            },\r\n            set: (val) => {\r\n                this._store.value = this._store.meta.clean(val);\r\n                this._store.error = this._store.meta.validate(val);\r\n            }\r\n        });\r\n\r\n        this.change = computed({\r\n            get: () => {\r\n                return this._store.meta.getChange(this._store);\r\n            },\r\n            set: (val) => {\r\n                this._store.meta.setChange(this._store, val);\r\n            }\r\n        });\r\n\r\n       \r\n        this.change1 = computed({\r\n            get: () => {\r\n                return this._store.meta.getChange1(this._store);\r\n            },\r\n            set: (val) => {\r\n                this._store.meta.setChange1(this._store, val);\r\n            }\r\n        });\r\n\r\n        this.change2 = computed({\r\n            get: () => {\r\n                if (typeof this._store.meta.getChange2 === \"function\") {\r\n                    return this._store.meta.getChange2(this._store);\r\n                }\r\n            },\r\n            set: (val) => {\r\n                this._store.meta.setChange2(this._store, val);\r\n            }\r\n        });\r\n\r\n\r\n        this.filter = computed({\r\n            get: () => {\r\n                return this._store.meta.getFilter(this._store);\r\n            },\r\n            set: (val) => {\r\n                this._store.meta.setFilter(this._store, val);\r\n            }\r\n        });\r\n\r\n\r\n        this.mode = computed({\r\n            get: () => {\r\n                return this._store.mode;\r\n            },\r\n            set: (val) => {\r\n                if (this._store.meta.immutable) {\r\n                    if (val == \"view\" || val == \"filter\") this._store.mode = val;\r\n                }  else {\r\n                    this._store.mode = val;\r\n                }\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n\r\n    get meta() {\r\n        return this._store.meta;\r\n    }\r\n\r\n    set validateon(on) {\r\n        if (this._store.mode == 'post' || this._store.mode == 'edit') {\r\n            this._store.is_validate_on = on;\r\n        }\r\n    }\r\n\r\n    get store() {\r\n        return this._store;\r\n    }\r\n\r\n    resetMeta(meta) {\r\n        this._store.meta = meta;\r\n    }\r\n\r\n    toString() {\r\n        return this._store.display;\r\n    }\r\n\r\n    isSummary() {\r\n        return this._store.meta.summary;\r\n    }\r\n\r\n    setContainsAsOptions(options) {\r\n        this._store.meta.setContainsAsOptions(options);\r\n    }\r\n\r\n    reset() {\r\n        this._store.change = null;\r\n        this._store.value = null;\r\n    }\r\n\r\n    getOption(key) {\r\n        if (this._store.meta.type == 'string') return key;\r\n        else return this._store.meta.getOption(key);\r\n    }\r\n\r\n\r\n    addParam(obj) {\r\n        this._store.meta.addParam(obj, this._store.value)\r\n    }\r\n\r\n    addAPIParam(obj) {\r\n        this._store.meta.addParam(obj, this._store.value)\r\n    }\r\n    \r\n}\r\n","import { createField } from \"./meta/fieldfactory.js\"\r\n\r\nexport function createStateTrigger(name, states, cb) {\r\n\r\n    let group = [];\r\n    for(let i in states) {\r\n        let field = createField(name, states[i]);\r\n        group.push({ depends_val : states[i].depends_val, field });\r\n    }\r\n    \r\n    return (val) => {\r\n        for(const state of group) {\r\n            if (state.depends_val == val) {\r\n                return cb(state.field);\r\n            }\r\n        }\r\n\r\n        //if we get to here, then set a default\r\n        for(const state of group) {\r\n            if (!state.depends_val) {\r\n                return cb(state.field);\r\n            }\r\n        }\r\n    }\r\n\r\n}           ","import { DataCell } from \"./datacell.js\"\r\nimport { reactive, computed } from \"vue\"\r\nimport { createStateTrigger } from \"./states.js\"\r\n\r\n\r\nexport class DataRow {\r\n\r\n    constructor(metarow) {\r\n        this._metarow = metarow;\r\n        this._cells = reactive({});\r\n        this._children = {};\r\n        this._ids = reactive({});\r\n        \r\n        \r\n\r\n\r\n        if (metarow) {\r\n            this.applyMetaRow(metarow);\r\n        }\r\n\r\n        this.cells = computed(() => {\r\n            return this._cells;\r\n        });\r\n\r\n        this.primary = computed(() => {\r\n            return this._ids[\"--id\"];\r\n        });\r\n\r\n        this.parent = computed(() => {\r\n            return this._ids[\"--parentid\"];\r\n        });\r\n\r\n        this.recursive = computed(() => {\r\n            return this._ids[\"--recursive-id\"];\r\n        });\r\n        \r\n    }\r\n\r\n    \r\n\r\n    set children(children) {\r\n        this._children = children;\r\n    }\r\n\r\n    get children() {\r\n        return this._children;\r\n    }\r\n\r\n    setMode(mode) {\r\n        for(let i in this._cells) {\r\n            if (i == \"--id\" || i == \"--parentid\") continue;\r\n            else if ((i == \"date-created\" || i == \"last-updated\") && mode != \"filter\") continue;\r\n            this._cells[i].mode = mode;\r\n        }\r\n    }\r\n\r\n    getCell(name) {\r\n        return this._cells[name];\r\n    }\r\n\r\n\r\n    clone() {\r\n        const data = new DataRow(this._metarow);\r\n        let cells = {};\r\n        for(let i in this._cells) {\r\n            cells[i].val = this._cells[i].val;\r\n        }\r\n    \r\n        let children = {};\r\n        for(let i in data.children) {\r\n            children[i] = data.children[i].clone();\r\n        }\r\n        data.children = children;\r\n        return data;\r\n    }\r\n\r\n    \r\n    applyMetaRow(metarow) {\r\n        for(const i in metarow.cells) {\r\n            const field = metarow.cells[i];\r\n            this._cells[field.name] = new DataCell(field);\r\n        }\r\n\r\n        for(const i in metarow.children) {\r\n            this._children[i] = metarow.children[i];\r\n        }\r\n\r\n        let groups = metarow.state_groups;\r\n\r\n\r\n        for(let i in groups) {\r\n            for(let x in groups[i]) {\r\n                const _self = this;\r\n                let state = createStateTrigger(i, groups[i][x], field => {\r\n                    _self._cells[i].resetMeta(field);\r\n                });\r\n                this._cells[x].listeners.push(state);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    addChild(name, child) {\r\n        if (!this._children[name]) {\r\n            this._children[name] = [];\r\n        }\r\n        this._children[name].push(child);\r\n    }\r\n\r\n    set row(row) {\r\n        if (!row) return;\r\n\r\n        if (row[\"--id\"]) this._ids[\"--id\"] = row[\"--id\"];\r\n        if (row[\"--parentid\"]) this._ids[\"--parentid\"] = row[\"--parentid\"];\r\n        if (row[\"--recursive-id\"]) this._ids[\"--recursive-id\"] = row[\"--recursive-id\"];\r\n\r\n        for(let field in this._cells) {\r\n            if (row.hasOwnProperty(field)) {\r\n                this._cells[field].val = row[field];\r\n                this._cells[field].display = row;\r\n            }\r\n        }\r\n\r\n        for(let child in this._children) {\r\n            this._children[child].row = row[child];\r\n        }\r\n    }\r\n\r\n\r\n    set filter(row) {\r\n        if (!row) return;\r\n\r\n        for(let field in this._cells) {\r\n            if (row.hasOwnProperty(field)) this._cells[field].filter = row[field];\r\n        }\r\n    }\r\n\r\n\r\n    getSummary() {\r\n        let str = [];\r\n        for(let i in this._cells) {\r\n            const cell = this._cells[i];\r\n            if (cell.isSummary()) {\r\n                const display = cell.display;\r\n                str.push(display);\r\n            }\r\n        }\r\n        return str.join(\" \");\r\n    }\r\n\r\n    toString() {\r\n        let str = [];\r\n        for(let i in this._cells) {\r\n            str.push(this._cells[i].display);\r\n        }   \r\n        return str.join(\" \");\r\n    }\r\n\r\n\r\n    serialize(changes_only = false) {\r\n        let data = {};\r\n        for(let i in this._cells) {\r\n            if (changes_only) {\r\n                if (this._cells[i].change != this._cells[i].val) {\r\n                    data[i] = this._cells[i].change;\r\n                }\r\n            } else {\r\n                if (this._cells[i].change != null) data[i] = this._cells[i].change;\r\n            }\r\n        }\r\n        return data;\r\n    }\r\n\r\n\r\n    getCellByType(type) {\r\n        let cells = {};\r\n        for(let i in this._cells) {\r\n            if (this._cells[i].type == type) cells[i] = this._cells[i];\r\n        }\r\n        return cells;\r\n    }\r\n\r\n    clearErrors() {\r\n        for(let i in this._cells) {\r\n            this._cells[i].error = 0;\r\n        }\r\n    }\r\n\r\n\r\n    reset() {\r\n        for(let i in this._cells) {\r\n            this._cells[i].error = 0;\r\n            this._cells[i].change = null;\r\n        }\r\n    }\r\n\r\n    setErrors(err) {\r\n        for(let i in err) {\r\n            if (i.indexOf(\"__\") === 0) continue;\r\n            if (this._cells[i]) {\r\n                this._cells[i].error = err[i];\r\n            }\r\n        }\r\n    }\r\n\r\n    convertToParams() {\r\n        let obj = {};\r\n        for(let i in this._cells) {\r\n            this._cells[i].addParam(obj);\r\n        }\r\n        return obj;\r\n    }\r\n\r\n    convertToAPIParams() {\r\n        let obj = {};\r\n        for(let i in this._cells) {\r\n            if (this._cells[i].type == \"asset\") continue;\r\n            this._cells[i].addAPIParam(obj);\r\n        }\r\n        return obj;\r\n    }\r\n\r\n    applyChangeData() {\r\n        for(let i in this._cells) {\r\n            this._cells[i].val = this._cells[i].change;\r\n        }\r\n    }\r\n\r\n}","import { MetaRow } from \"./metarow.js\"\r\nimport { DataRow } from \"./datarow.js\"\r\nimport { Map } from \"./map.js\"\r\nimport { reactive } from \"vue\"\r\nimport client from \"./client.js\"\r\nimport { getModelSettings } from \"./route.js\" \r\n\r\n\r\nexport const RepoStore = reactive({meta : new MetaRow, data : [], indexes : {}, search : new DataRow() });\r\n\r\nexport function applySettings(settings) {\r\n    meta_settings = settings;\r\n}\r\n\r\nfunction indexData() {\r\n    RepoStore.indexes = {};\r\n    \r\n    for(const key in RepoStore.data) {\r\n        const row = RepoStore.data[key];\r\n        let ckey = row.cells[RepoStore.meta.store.index].val;\r\n        if (!RepoStore.indexes[ckey]) RepoStore.indexes[ckey] = [];\r\n        RepoStore.indexes[ckey].push(key);\r\n    }\r\n}\r\n\r\n\r\nfunction mapRepoData(response) {\r\n    RepoStore.data = [];\r\n    for (const i in response) {\r\n        let obj= new DataRow(RepoStore.meta);\r\n        obj.row = response[i];\r\n        RepoStore.data.push(obj);\r\n    }\r\n}\r\n\r\n\r\nfunction buildParams(meta_settings) {\r\n    let params = {};\r\n    if (!params) params = {};\r\n    if (Map.to) params.__to = Map.to;\r\n    if (meta_settings.to) params.__to = meta_settings.to;\r\n    if (Map.key) params[\"--parentid\"] = Map.key;\r\n    if (meta_settings.limit) params.__limit = meta_settings.limit;\r\n    if (meta_settings.fields) params.__fields = meta_settings.fields;\r\n    if (meta_settings.group) params.group = meta_settings.group;\r\n    if (Map.params._page) params.__limit = ((Map.params._page - 1) * params.__limit) + \",\" + params.__limit;\r\n    return params;\r\n}\r\n\r\nexport function resetRepo() {\r\n    RepoStore.meta = new MetaRow();\r\n    RepoStore.data = [];\r\n    RepoStore.indexes = {};\r\n    RepoStore.search = new DataRow();\r\n    RepoStore.max_pages = 0;\r\n}\r\n\r\n\r\nexport const loadRepo = async() => {\r\n    let meta_settings = getModelSettings();\r\n    \r\n    resetRepo();\r\n    let params = buildParams(meta_settings);\r\n    let url = Map.model;\r\n    if (Map.state == \"parent\") url += \"/parent\";\r\n    return client.get(\"/meta/\" +url, params)\r\n    .then(response => {\r\n        RepoStore.meta.map(response.fields, meta_settings.fields);\r\n        if (meta_settings.show == 'all') {\r\n            RepoStore.meta.showAll();\r\n        }\r\n\r\n        RepoStore.search.applyMetaRow(RepoStore.meta, meta_settings.filter_fields);\r\n        RepoStore.search.setMode(\"filter\");\r\n        RepoStore.search.filter = Map.params;\r\n        RepoStore.meta.init = true;\r\n\r\n        if (meta_settings.component) RepoStore.component = meta_settings.component;\r\n        else if (!RepoStore.meta.cells) RepoStore.component = \"\";\r\n        else RepoStore.component = (RepoStore.meta.store.index || RepoStore.meta.children.length > 0) ? \"tree\" : \"table\";\r\n    }).then(() => {\r\n        params = { ...params, ...RepoStore.search.convertToAPIParams()};\r\n        if (meta_settings.limit > 0) {\r\n            return client.get(\"/count/\" + url, params)\r\n            .then(response => {\r\n                RepoStore.max_pages = Math.ceil(response.count / meta_settings.limit);\r\n            })\r\n            .then(() => {\r\n                return client.get(\"/data/\" + url, params);\r\n            })\r\n            .then(response => {\r\n                mapRepoData(response);\r\n                if (RepoStore.meta.store.index) indexData();\r\n                return response;\r\n            });\r\n        } else {\r\n            return client.get(\"/data/\" + url, params)\r\n            .then(response => {\r\n                mapRepoData(response);\r\n                if (RepoStore.meta.store.index) indexData();\r\n                return response;\r\n            });\r\n        }\r\n    })\r\n    .catch(e => console.log(e));\r\n}\r\n\r\n\r\nexport function reorderRepo(positions) {\r\n    const arr = [];\r\n    arr.length = RepoStore.data.length;\r\n    for(let i in RepoStore.data) {\r\n        arr[positions[RepoStore.data[i].primary] - 1] = RepoStore.data[i];\r\n    }\r\n    RepoStore.data = arr;\r\n}\r\n","<template >\r\n    <div class=\"ptj-tree-node ptj-draggable\" :id=\"primary\" draggable=\"false\">\r\n        <div class=\"ptj-tree-node-row\">  \r\n            <div>\r\n                <a v-if=\"ischild\" data-action=\"more\" class=\"button\" @click.prevent.stop=\"toggle()\">\r\n                    <span class=\"material-icons\">subdirectory_arrow_right</span>\r\n                </a>\r\n                <a v-else data-action=\"more\" class=\"button\" @click.prevent.stop=\"toggle()\">\r\n                    <span class=\"material-icons\">keyboard_arrow_right</span>\r\n                </a>\r\n            </div>\r\n            <div v-if=\"RepoStore.meta.sortable\">\r\n                <a data-action=\"more\" class=\"button\" @click=\"prevent.stop\" @mousedown=\"setDraggable\" @mouseup=\"endDraggable\">\r\n                    <span class=\"material-icons\">drag_handle</span>\r\n                </a>\r\n            </div>\r\n            <div>{{ summary }}</div>\r\n            <ptj-button :route=\"{state:'primary', key:primary }\"><span class=\"material-icons\">arrow_forward_ios</span></ptj-button>\r\n        </div>\r\n        <ptj-tree-node v-for=\"(key, index) in children\" :row=\"key\" :ischild=\"true\"  :key=\"index\" v-show=\"store.toggle_state[primary]\" />\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { reactive, computed, onMounted } from \"vue\"\r\nimport PtjButton from \"./ptj-button.vue\"\r\nimport { RepoStore } from \"./../js/repo.js\"\r\n\r\nconst props = defineProps({\r\n    row : { \r\n        type : [String, Number],\r\n        required : true\r\n    },\r\n    draggable : Boolean,\r\n    ischild : {\r\n        type : Boolean,\r\n        default : false\r\n    }\r\n});\r\n\r\nconst store = reactive({ toggle_state : {}, branch : null });\r\n\r\nfunction toggle() {\r\n    const index = store.branch.primary;\r\n    store.toggle_state[index] = (store.toggle_state[index]) ? false : true;\r\n}\r\n\r\nconst children = computed(() => {\r\n    if (!store.branch) return [];\r\n    const id = store.branch.primary;\r\n    return (RepoStore.indexes[id]) ? RepoStore.indexes[id] : [];\r\n});\r\n\r\nconst primary = computed(() => {\r\n    if (!store.branch) return 0;\r\n    return store.branch.primary;\r\n});\r\n\r\nconst summary = computed(() => {\r\n    if (!store.branch) return \"\";\r\n    return store.branch.getSummary();\r\n});\r\n\r\nonMounted(() => {\r\n    store.branch = RepoStore.data[props.row];\r\n});\r\n\r\n\r\n</script>\r\n\r\n<style scoped>\r\n\r\n.model-tree.branch {\r\n  padding-left: 8px;\r\n  padding-right: 8px;\r\n  margin: 6px 0;\r\n  background-color:#111111;\r\n}\r\n\r\n.tree .ide-block {\r\n\tdisplay : none;\r\n}\r\n\r\n.dragArea {\r\n  min-height: 50px;\r\n  outline: 1px solid #777777;\r\n}\r\n\r\n\r\n</style>","<template>\r\n  <input v-if=\"field.mode=='edit' || field.mode=='post'\"\r\n        class=\"ptj-form-number\" \r\n        :name=\"field.name\" \r\n        type=\"number\" \r\n        v-model=\"field.change\" \r\n        v-bind=\"atts\"\r\n        @blur=\"field.validateon = true\" >\r\n   <div v-else-if=\"field.mode=='filter'\">\r\n       <input\r\n        class=\"ptj-form-filter-number ptj-min\" \r\n        :name=\"field.name\" \r\n        type=\"number\" \r\n        v-model=\"field.change1\" \r\n        v-bind=\"atts\"\r\n        @blur=\"field.validateon = true\"> - \r\n        <input\r\n        class=\"ptj-form-filter-number ptj-max\" \r\n        :name=\"field.name\" \r\n        type=\"number\" \r\n        v-model=\"field.change2\" \r\n        v-bind=\"atts\"\r\n        @blur=\"field.validateon = true\">\r\n   </div>\r\n   <span v-else>{{ field.val }}</span>\r\n</template>\r\n\r\n<script setup>\r\nimport { computed } from \"vue\"\r\n\r\nconst props = defineProps({\r\n    field : Object\r\n});\r\n\r\n\r\nconst atts = computed(() => {\r\n    let atts = {};\r\n    if (props.field.meta.round) {\r\n        let step = \"0.\";\r\n        for(let i=0; i<props.field.meta.round - 1; ++i) {\r\n            step += \"0\";\r\n        }\r\n        step += \"1\";\r\n        atts[\"step\"]  = step;\r\n    }\r\n    return atts;\r\n});\r\n</script>\r\n","<template>\r\n    <input class=\"ptj-checkbox\" type=\"checkbox\" :true-value=\"1\" :false-value=\"0\" :name=\"field.name\" v-model=\"field.change\" v-if=\"field.mode=='edit' || field.mode == 'post'\">\r\n    <select v-else-if=\"field.mode=='filter'\" :name=\"field.name\" v-model=\"field.change1\" class=\"ptj-filter-form-checkbox\">\r\n        <option :value='0'>{{ \"All\" }}</option>\r\n        <option :value='1'>{{ \"Checked\" }}</option>\r\n        <option :value='2'>{{ \"Unchecked\" }}</option>\r\n    </select>\r\n    <a v-else @click=\"submit()\"><span class=\"material-icons\">{{ icon }}</span></a>\r\n</template>\r\n\r\n<script setup>\r\nimport { computed } from \"vue\"\r\nimport { Map } from \"./../js/map.js\"\r\nimport client from \"./../js/client.js\"\r\n\r\nconst props = defineProps({\r\n    field : Object,\r\n    id : Number\r\n});\r\n\r\n\r\nfunction submit() {\r\n    let params = {};\r\n    params[\"--id\"] = props.id;\r\n    params[props.field.name] = (props.field.val == 1) ? 0 : 1;\r\n    return client.put(\"/data/\" +  Map.model, params)\r\n    .then(() => {\r\n        props.field.val = (props.field.val == 1) ? 0 : 1;\r\n    })\r\n    .catch(e => {\r\n        console.log(e);\r\n    });\r\n}\r\n\r\nlet icon = computed(() => {\r\n    if (props.field.val == 1) {\r\n        return \"check_circle_outline\";\r\n    } else {\r\n        return \"highlight_off\"\r\n    }\r\n});\r\n</script>","<template>\r\n    <select v-if=\"field.mode=='edit' || field.mode == 'post'\" \r\n        v-model=\"field.change\"\r\n        v-bind=\"field.atts\"\r\n        :name=\"field.name\"\r\n         @blur=\"field.validateon = true\"\r\n        >\r\n        <option value=\"0\" selected>{{ getDictionary('ptj-id-default') }}</option>\r\n        <option v-for=\"option in options\" :key=\"option.key\" :value=\"option.key\">{{ option.value }}</option>\r\n  </select>\r\n  <ptj-multiple-select v-else-if=\"field.mode=='filter'\" :field=\"field\" :options=\"options\" />\r\n  <span v-else>{{ field.display }}</span>\r\n</template>\r\n\r\n\r\n<script setup>\r\nimport { computed, ref, onMounted } from \"vue\"\r\nimport PtjMultipleSelect from \"./ptj-multiple-select.vue\"\r\nimport { getDictionary } from \"./../js/dictionary.js\"\r\nimport { Map } from \"./../js/map.js\"\r\n\r\nconst props = defineProps({\r\n    field : Object,\r\n    parent : Number\r\n});\r\n\r\nconst options = ref([]);\r\n\r\nlet ctype = computed(() => {\r\n    return (props.type == 'edit' && props.field.immutable) ? \"view\" : props.type;\r\n});\r\n\r\nasync function getOptions() {\r\n    let url = \"/reference/\" + Map.model + \"/\";\r\n    url += (props.field.meta.reference) ? props.field.name : \"id\";\r\n    options.value = await props.field.meta.setReferenceOptions(\r\n        url, \r\n        {\"--parentid\":props.parent}\r\n    );\r\n}\r\n\r\n\r\nif (props.field.meta.reference || props.field.meta.recursive) {\r\n    onMounted(() => {\r\n       getOptions();\r\n    });\r\n    \r\n}\r\n\r\n\r\n</script>","<template>\r\n   <input v-if=\"field.mode=='edit'  || field.mode == 'post'\" class=\"ptj-form-asset\" \r\n    ref=\"input\" @change=\"setFile\" \r\n    :name=\"field.meta.name\" \r\n    type=\"file\" >\r\n   <span v-else>{{ field.val }}   <a @click=\"download()\"><span class=\"material-icons\">download</span></a></span>\r\n   \r\n</template>\r\n\r\n<script setup>\r\nimport client from \"./../js/client.js\"\r\n\r\n\r\nconst props = defineProps({\r\n    field : Object,\r\n    id : Number\r\n});\r\n\r\nfunction download() {\r\n    client.getAsset(\"/asset/\" + props.field.model + \"/\" + props.field.name + \"/\" + props.id)\r\n    .then(blob => {\r\n\r\n        const anchor = document.createElement(\"a\");\r\n        const url = URL.createObjectURL(blob);\r\n        anchor.href = url;\r\n        anchor.download = props.field.val;\r\n        document.body.appendChild(anchor);\r\n        anchor.click();\r\n        document.body.removeChild(anchor);\r\n        URL.revokeObjectURL(url);\r\n    })\r\n    .catch(e => {\r\n        console.log(e);\r\n    });\r\n}\r\n</script>\r\n","<template>\r\n  <div class=\"ptj-table-wrapper\">\r\n    <table class=\"ptj-table\" :class=\"Map.model\">\r\n    <thead>\r\n        <tr class=\"ptj-table-header\" ref=\"tableheader\">\r\n        <th v-for=\"cell in RepoStore.meta.cells\" \r\n            v-show=\"cell.summary\" \r\n            :key=\"cell.name\" \r\n            class=\"ptj-table-header-cell\"\r\n            :class=\"cell.name\"\r\n            @click=\"orderBy(cell.name);\"\r\n        >{{ getDictionary('label', { \"model\" : cell.model, \"field\" : cell.name, default : cell.name }) }}\r\n            <span v-if=\"order.name == cell.name && order.dir == 'asc'\" \r\n                class=\"material-icons\" \r\n                >keyboard_arrow_up</span>\r\n            <span v-if=\"order.name == cell.name && order.dir == 'desc'\" \r\n                class=\"material-icons\" \r\n                >keyboard_arrow_down</span>\r\n        </th>\r\n        <th class=\"ptj-actions\">\r\n            <ptj-modal v-if=\"settings.disable_selectfields != true\" :location=\"false\" :relative=\"tableheader\">\r\n                <template #button>\r\n                    <span class=\"material-icons\">add</span> \r\n                </template>\r\n                <template #default>\r\n                    <ptj-selectfields ></ptj-selectfields> \r\n                </template>\r\n            </ptj-modal>\r\n        </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr v-for=\"(obj, rindex) in RepoStore.data\" :key=\"rindex\" class=\"ptj-table-row\">\r\n        <td v-for=\"(field, name) in obj.cells\" :key=\"name\" v-show=\"field.summary\" class=\"ptj-table-cell\" :class=\"field.name\">\r\n          <ptj-asset v-if=\"field.type=='asset'\" :field=\"field\" :id=\"obj.primary\" />\r\n          <ptj-number v-else-if=\"field.type=='number'\" :field=\"field\" />\r\n          <ptj-flag v-else-if=\"field.type=='flag'\" :field=\"field\" :id=\"obj.primary\" />\r\n          <ptj-id v-else-if=\"field.type=='id'\" :field=\"field\" />\r\n          <ptj-time v-else-if=\"field.type=='time'\" :field=\"field\" />\r\n          <ptj-string v-else-if=\"field.type=='string'\" :field=\"field\"  />\r\n        </td>\r\n        <td class=\"ptj-actions\" >\r\n            <ptj-button :route=\"{state:'primary', key:obj.primary}\"><span class=\"material-icons\">arrow_forward_ios</span></ptj-button>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n    </table>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n\r\nimport PtjNumber from \"./ptj-number.vue\"\r\nimport PtjFlag from \"./ptj-flag.vue\"\r\nimport PtjId from \"./ptj-id.vue\"\r\nimport PtjTime from \"./ptj-time.vue\"\r\nimport PtjString from \"./ptj-string.vue\"\r\nimport PtjAsset from \"./ptj-asset.vue\"\r\nimport PtjButton from \"./ptj-button.vue\"\r\nimport PtjSelectfields from \"./ptj-selectfields.vue\"\r\nimport PtjModal from \"./ptj-modal.vue\"\r\nimport { reactive, ref } from \"vue\"\r\nimport { RepoStore } from \"./../js/repo.js\"\r\nimport { getModelSettings } from \"./../js/route.js\"\r\nimport { getDictionary } from \"./../js/dictionary.js\"\r\nimport { Map } from \"./../js/map.js\"\r\n\r\n\r\nlet settings = getModelSettings();\r\nlet order = reactive( { name : '', dir : ''});\r\nconst tableheader = ref(null);\r\n\r\nfunction orderBy(name) {\r\n    if (RepoStore.meta.pages > 0) {\r\n        order.dir = (!order.name != name || order.dir  == \"desc\") ? \"asc\" : \"desc\";\r\n        order.name = name;\r\n        let sort = [];\r\n        sort[order.name] = order.dir;\r\n        RepoStore.meta.sort = sort;\r\n        load();\r\n    } else {\r\n        //custom sort on the table\r\n        if (order.name != name || order.dir == \"desc\") {\r\n            RepoStore.data.sort(function(x, y) {\r\n                let xval = x.getCell(name).val;\r\n                let yval = y.getCell(name).val;\r\n                if (xval < yval) {\r\n                    return -1;\r\n                } else if (xval > yval) {\r\n                    return 1;\r\n                } else {\r\n                    return 0;\r\n                }\r\n            });\r\n            order.name = name;\r\n            order.dir = \"asc\";\r\n        } else {\r\n            RepoStore.data.sort(function(x, y) {\r\n                let xval = x.getCell(name).val;\r\n                let yval = y.getCell(name).val;\r\n                if (xval < yval) {\r\n                    return 1;\r\n                } else if (xval > yval) {\r\n                    return -1;\r\n                } else {\r\n                    return 0;\r\n                }\r\n            });\r\n            order.name = name;\r\n            order.dir = \"desc\";\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\n\r\ntable, thead, tbody, tr {\r\n    width : 100%;\r\n}\r\n\r\n\r\n.ptj-table-wrapper {\r\n    position : relative;\r\n}\r\n\r\n</style>","<template>\r\n    <div v-for=\"(combinations, index) in getIndexCombinations\" :key=\"index\">\r\n     <h3><span\r\n        v-for=\"(tag, index) in combinations.tags\"\r\n        :key=\"index\"\r\n        >{{ tag }}&nbsp;</span></h3>\r\n    <ul>\r\n       <li v-for=\"ckey in combinations.data\" :key=\"ckey\">\r\n         <ptj-button :route=\"route\">\r\n          {{  data[ckey].getSummary() }}\r\n         </ptj-button>\r\n       </li>\r\n    </ul>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n\r\nimport { computed, inject } from \"vue\"\r\nimport PtjButton from \"./ptj-button.vue\"\r\ninject(\"data\");\r\ninject(\"indexes\");\r\n\r\nfunction getCombinations(tag, data, combos) {\r\n    const ncombos = [];\r\n    if (combos.length == 0) {\r\n        for(let d in data) {\r\n        ncombos.push({ tags : [ data[d].display ], data : data[d].contains});\r\n        }\r\n    } else {\r\n        for (let c of combos) {\r\n          for(let d in data) {\r\n            let tags = c.tags;\r\n            tags.push(d.display);\r\n            ncombos.push({ tags : tags, data : c.data.filter( value => data[d].contains.includes(value))});\r\n          }\r\n        }\r\n    }\r\n    return ncombos;\r\n}\r\n\r\nconst getIndexCombinations = computed(() => { \r\n    let combos = [];\r\n    for (let group in indexes) {\r\n        combos = this.getCombinations(group, indexes[group], combos);\r\n    }\r\n    return combos;\r\n});\r\n</script>\r\n\r\n","<template>\r\n   <form @submit.prevent=\"searchData\" class=\"ptj-filter-form\">\r\n      <h3>{{ getDictionary('ptj-filter-form-title')}}</h3>\r\n      <ptj-form-row v-for=\"field in RepoStore.search.cells\" :key=\"field.name\" :field=\"field\" v-show=\"field.type != 'id' || field.meta.reference || field.meta.recursive\">\r\n          <ptj-id v-if=\"field.type=='id'\" :field=\"field\" :parent=\"Map.key\"/>\r\n          <ptj-flag v-else-if=\"field.type=='flag'\" :field=\"field\" />\r\n          <ptj-number v-else-if=\"field.type=='number'\" :field=\"field\" />\r\n          <ptj-time v-else-if=\"field.type=='time'\" :field=\"field\" />\r\n          <ptj-string v-else-if=\"field.type=='string'\" :field=\"field\" />\r\n          <a class=\"ptj-filter-form-reset\" @click=\"field.reset()\">x</a>\r\n      </ptj-form-row>\r\n      <input type=\"submit\" :value=\"getDictionary('ptj-filter-form-btn')\" class=\"ptj-filter-form-submit\" @click=\"$emit('close');\">\r\n  </form>\r\n</template>\r\n\r\n<script setup>\r\n\r\nimport PtjFormRow from \"./ptj-form-row.vue\"\r\nimport PtjId from \"./ptj-id.vue\"\r\nimport PtjFlag from \"./ptj-flag.vue\"\r\nimport PtjTime from \"./ptj-time.vue\"\r\nimport PtjNumber from \"./ptj-number.vue\"\r\nimport PtjString from \"./ptj-string.vue\"\r\nimport { addToHistory } from \"./../js/route.js\"\r\nimport { Map } from \"./../js/map.js\"\r\nimport { RepoStore, loadRepo } from \"./../js/repo.js\"\r\nimport { getDictionary } from \"./../js/dictionary.js\"\r\n\r\n\r\nfunction searchData() {\r\n    RepoStore.search.applyChangeData();\r\n    Map.params = RepoStore.search.convertToParams();\r\n    addToHistory();\r\n    loadRepo();\r\n}\r\n\r\n\r\n</script>\r\n<style scoped>\r\n.error {\r\n  color : red;\r\n}\r\n\r\n</style>\r\n\r\n","<template>\r\n <div class=\"ptj-pagination\">\r\n     <a v-for=\"index in RepoStore.max_pages\" \r\n     :key=\"index\" \r\n     @click=\"changePage(index)\" \r\n     :class=\"getActiveClass(index)\">{{ index }}</a>\r\n </div>\r\n</template>\r\n<script setup>\r\nimport { addToHistory } from \"./../js/route.js\"\r\nimport { loadRepo, RepoStore } from \"./../js/repo.js\"\r\nimport { Map } from \"./../js/map.js\"\r\n\r\nfunction getActiveClass(index) {\r\n    return (index == Map.params._page ?? 1) ? \"ptj-pagination-active\" : \"\";\r\n}\r\n\r\nfunction changePage(page) {\r\n    Map.params._page = page;\r\n    addToHistory();\r\n    loadRepo();\r\n}\r\n</script>","<template>\r\n    <div class=\"ptj-progress-bar-wrapper\">\r\n        <div class=\"ptj-progress-holder\">\r\n            <div class=\"ptj-progress-bar\" :style=\"'width:' + num + 'px'\">&nbsp;</div> \r\n        </div>   \r\n        <span>{{ num }}%</span>\r\n    </div> \r\n</template>\r\n\r\n<script setup>\r\n\r\nimport { computed } from \"vue\"\r\n\r\nconst props = defineProps({\r\n    total : Number,\r\n    progress : Number\r\n});\r\n\r\n\r\nconst num = computed(() => {\r\n    let num = Math.floor((props.progress / props.total) * 100);\r\n    return (isNaN(num)) ? 0 : num;\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n .ptj-progress-holder {\r\n     width : 100%;\r\n     min-height : 10px;\r\n     position : relative;\r\n     display : flex;\r\n     align-items: stretch;\r\n     padding : 2px;\r\n }\r\n\r\n .ptj-progress-bar {\r\n     width : 0;\r\n     height : 100%;\r\n     position : relative;\r\n     line-height : 100%;\r\n }\r\n\r\n\r\n</style>\r\n","<template>\r\n <form @submit.prevent=\"submit\" v-show=\"fstate==0\" class=\"ptj-form\" :class=\"Map.model + ' ' + Map.state\">\r\n    <div class=\"ptj-form-error\" v-show=\"globalerror\">{{ globalerror }}</div>\r\n    <ptj-form-row v-for=\"field in cdata.cells\" :key=\"field.name\" :field=\"field\">\r\n          <ptj-asset v-if=\"field.type=='asset'\" :field=\"field\" />\r\n          <ptj-number v-else-if=\"field.type=='number'\" :field=\"field\"/>\r\n          <ptj-flag v-else-if=\"field.type=='flag'\" :field=\"field\" />\r\n          <ptj-id v-else-if=\"field.type=='id'\" :field=\"field\"  :parent=\"Map.key\" />\r\n          <ptj-time v-else-if=\"field.type=='time'\" :field=\"field\" />\r\n          <ptj-string v-else-if=\"field.type=='string'\" :field=\"field\" />\r\n          <ptj-form-row :field=\"field\" v-if=\"field.encrypted\">\r\n            <ptj-confirm :field=\"field\" />\r\n          </ptj-form-row>\r\n    </ptj-form-row>\r\n    <input type=\"submit\" :value=\"getDictionary('ptj-create-form-btn')\" class=\"ptj-form-submit\">\r\n    <ptj-progress-bar v-show=\"fstate == 1\" :total=\"progress.total\" :progress=\"progress.progress\" />\r\n  </form>\r\n  \r\n</template>\r\n\r\n<script setup>\r\n\r\nimport {ref, reactive, onMounted } from \"vue\" \r\nimport PtjFormRow from \"./ptj-form-row.vue\"\r\nimport PtjProgressBar from \"./ptj-progress-bar.vue\"\r\nimport PtjAsset from \"./ptj-asset.vue\"\r\nimport PtjNumber from \"./ptj-number.vue\"\r\nimport PtjFlag from \"./ptj-flag.vue\"\r\nimport PtjId from \"./ptj-id.vue\"\r\nimport PtjTime from \"./ptj-time.vue\"\r\nimport PtjString from \"./ptj-string.vue\"\r\nimport PtjConfirm from \"./ptj-form-confirm.vue\"\r\nimport client from \"./../js/client.js\"\r\nimport { DataRow } from \"./../js/datarow.js\"\r\nimport { MetaRow } from \"./../js/metarow.js\"\r\nimport { Map } from \"./../js/map.js\"\r\nimport { loadRepo } from \"./../js/repo.js\"\r\nimport { getDictionary } from \"./../js/dictionary.js\"\r\n\r\nconst emit = defineEmits(['close']);\r\nlet globalerror = ref('');\r\n\r\nconst cdata = reactive(new DataRow());\r\n\r\n\r\nconst progress = reactive({ total : 0, progress : 0});\r\n\r\nlet fstate = 0;\r\n\r\n\r\n\r\nconst load = async() => {\r\n    return client.post(\"/meta/\" + Map.model)\r\n    .then(response => {\r\n        const meta = new MetaRow();\r\n        meta.map(response.fields);\r\n        cdata.applyMetaRow(meta);\r\n        cdata.setMode('post');\r\n\r\n        let promises = [];\r\n        for(let i in meta.cells) {\r\n            if (meta.cells[i].type == 'id' && meta.cells[i].reference) {\r\n                let url = \"/reference/\" + Map.model + \"/\" + i;\r\n                promises.push(meta.cells[i].setReferenceOptions(url, {\"--parentid\":Map.key}));\r\n            }\r\n        }\r\n        return Promise.all(promises);\r\n    }).catch(e => console.log(e));\r\n}\r\n\r\n\r\nfunction submit() {\r\n\r\n    fstate = (progress.total > 0) ? 1 : 2;\r\n    cdata.clearErrors();\r\n    let key = 0;\r\n    let ndata = cdata.serialize();\r\n    if (Map.key) ndata[\"--parentid\"] = Map.key;\r\n    return client.post(\"/data/\" + Map.model, ndata)\r\n    .then(response=>{\r\n        key = response[\"--id\"];\r\n        let promises = [];\r\n        let assets = cdata.getCellByType(\"asset\");\r\n        progress.total = 0;\r\n        for(let i in assets) {\r\n            const val = assets[i].val;\r\n            if (!val) continue;\r\n            ++progress.total;\r\n            const asset = new Asset();\r\n            asset.url = \"/asset/\" + Map.model + \"/\" + i + \"/\" + response[\"--id\"];\r\n            let promise = asset.saveFile(assets[i].val)\r\n            .then(() => {\r\n                ++progress.progress;\r\n            });\r\n            promises.push(promise);\r\n        }\r\n        return Promise.all(promises);\r\n    })\r\n    .then(() => {\r\n        cdata.reset();\r\n        loadRepo();\r\n        emit(\"close\");\r\n    })\r\n    .catch(err => {\r\n            //show error fields, mark fields as invalidated\r\n        fstate = 0;\r\n        return err.json()\r\n        .then(response => {\r\n            const msg = response.exception[0];\r\n            if (msg.type == \"PressToJamCore\\\\Exceptions\\\\ValidationException\") {\r\n                cdata.setErrors(JSON.parse(msg.message));\r\n            }\r\n            console.log(\"Err response\", response);\r\n        });\r\n        \r\n    });\r\n}\r\n\r\nonMounted(async () => {\r\n    await load();\r\n});\r\n\r\n</script>\r\n","<template>\r\n    <div class=\"ptj-drop-target\" \r\n            @dragover=\"dragOver\" \r\n            @dragenter=\"dragEnter\"\r\n            @dragleave=\"dragLeave\"\r\n            @drop=\"drop\">\r\n        <div v-for=\"(data, rindex) in RepoStore.data\" \r\n            :key=\"rindex\" \r\n            :id=\"data.primary\"\r\n            class=\"ptj-drag-target\" \r\n            draggable=\"true\" \r\n            @dragstart=\"dragStart\"\r\n            @dragend=\"dragEnd\"\r\n            >\r\n            <span>{{ data.getSummary() }}</span>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script setup>\r\nimport { RepoStore } from \"./../js/repo.js\"\r\nimport client from \"./../js/client.js\"\r\nimport { Map } from \"./../js/map.js\"\r\n\r\nlet _drag_target;\r\nlet _x =0;\r\nlet _y=0;\r\n\r\nconst emit = defineEmits(['reorder']);\r\n\r\n\r\nfunction getDirection(x, y) {\r\n    const dir_x = (x == _x) ? 0 : (x > _x) ? 1 : -1;\r\n    const dir_y = (y == _y) ? 0 : (y > _y) ? 1 : -1;\r\n      \r\n    return { x : dir_x, y : dir_y };\r\n}\r\n\r\nfunction insertAfter(drop_target) {\r\n    if (drop_target.nextElementSibling) {\r\n        drop_target.parentNode.insertBefore(_drag_target, drop_target.nextElementSibling);\r\n    } else {\r\n        drop_target.parentNode.append(_drag_target);\r\n    }\r\n}\r\n\r\nfunction insertBefore(drop_target) {\r\n    drop_target.parentNode.insertBefore(_drag_target, drop_target);\r\n}\r\n\r\nfunction dragStart(ev) {\r\n    const targ = ev.target;\r\n    _drag_target = targ;\r\n  \r\n    ev.dataTransfer.dropEffect = \"move\";\r\n    _drag_target.style.opacity = '0.4';\r\n\r\n    _x = ev.clientX;\r\n    _y = ev.clientY;\r\n}\r\n\r\n\r\nfunction dragEnd() {\r\n    _drag_target.style.opacity = \"1.0\";\r\n}\r\n\r\n\r\nfunction dragEnter(ev) {\r\n    ev.preventDefault();\r\n    ev.dataTransfer.dropEffect = \"move\";\r\n\r\n    const dir = getDirection(ev.clientX, ev.clientY);\r\n\r\n    if (dir.y == 1) {\r\n        insertAfter(ev.target.closest(\".ptj-drag-target\"));\r\n    } else if (dir.y == -1) {\r\n        insertBefore(ev.target.closest(\".ptj-drag-target\"));\r\n    }\r\n    _x = ev.clientX;\r\n    _y = ev.clientY;\r\n}\r\n\r\nfunction dragLeave(ev) {\r\n    ev.preventDefault();\r\n}\r\n\r\nfunction dragOver(ev) {\r\n    ev.preventDefault();\r\n    ev.dataTransfer.dropEffect = \"move\";\r\n}\r\n\r\n\r\nfunction drop(ev) {\r\n    ev.preventDefault();\r\n    ev.dataTransfer.dropEffect = 'move';\r\n    let indexes = getOrder();\r\n    let url = \"/data/\" + Map.model + \"/resort\";\r\n    client.put(url, {\"_rows\" : indexes })\r\n    .catch(e => console.log(e));\r\n\r\n\r\n    const positions = {};\r\n    for(let obj of indexes) {\r\n        positions[obj['--id']] = obj['--sort'];\r\n    }\r\n\r\n    emit('reorder', positions);\r\n   \r\n}\r\n\r\n\r\nfunction getOrder() {\r\n    let index = [];\r\n    const children = _drag_target.closest(\".ptj-drop-target\").querySelectorAll(\".ptj-drag-target\");\r\n    for(let c=0; c<children.length; ++c) {\r\n        index.push({\"--id\" : children[c].getAttribute(\"id\"), \"--sort\" : c + 1});\r\n    }\r\n    return index;\r\n}\r\n\r\n</script>","<template>\r\n  <div :class=\"[Map.model, Map.state]\">\r\n    <ptj-modal v-if=\"RouteStore.route.perms.includes('post')\">\r\n        <template #button>\r\n            {{ getDictionary('ptj-repo-post') }}\r\n        </template>\r\n        <template #default=\"createScope\">\r\n            <ptj-create-form @close=\"createScope.toggleShow\" />\r\n        </template>\r\n    </ptj-modal>\r\n    <ptj-modal v-if=\"settings.disable_filter != true\">\r\n        <template #button>\r\n            {{ getDictionary('ptj-repo-search') }} <span class=\"material-icons\">search</span>\r\n        </template>\r\n        <template #default=\"filterScope\">\r\n            <ptj-filter-form @close=\"filterScope.toggleShow\" />\r\n        </template>\r\n    </ptj-modal>\r\n    <ptj-modal v-if=\"settings.disable_sort != true && RouteStore.sort && RouteStore.route.perms.includes('put')\">\r\n        <template #button>\r\n            {{ getDictionary('ptj-repo-sort') }} <span class=\"material-icons\">sort</span>\r\n        </template>\r\n        <template #default=\"sortScope\">\r\n            <ptj-sort @close=\"sortScope.toggleShow\" @reorder=\"reorder\"/>\r\n        </template>\r\n    </ptj-modal>\r\n    <ptj-tree v-if=\"RepoStore.component=='tree'\" />\r\n    <ptj-list v-else-if=\"RepoStore.component=='list'\" />\r\n    <ptj-table v-else-if=\"RepoStore.component=='table'\" />\r\n    <ptj-pagination v-if=\"RepoStore.max_pages > 0\" />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n\r\nimport { ref, onMounted, onBeforeUnmount } from \"vue\"\r\nimport PtjTree from \"./ptj-tree.vue\"\r\nimport PtjTable from \"./ptj-table.vue\"\r\nimport PtjList from \"./ptj-list.vue\"\r\nimport PtjFilterForm from \"./ptj-filter-form.vue\"\r\nimport PtjSelectfields from \"./ptj-selectfields.vue\"\r\nimport PtjPagination from \"./ptj-pagination.vue\"\r\nimport PtjModal from \"./ptj-modal.vue\"\r\nimport PtjCreateForm from \"./ptj-create-form.vue\"\r\nimport { RepoStore, loadRepo, resetRepo, reorderRepo } from \"./../js/repo.js\"\r\nimport { getModelSettings, RouteStore } from \"./../js/route.js\" \r\nimport { getDictionary } from \"./../js/dictionary.js\"\r\nimport PtjSort from \"./ptj-sort.vue\"\r\n\r\n\r\nlet settings = getModelSettings();\r\n\r\nfunction reorder(positions) {\r\n    reorderRepo(positions);\r\n}\r\n\r\n\r\nonMounted(async () => {\r\n    await loadRepo();\r\n});\r\n\r\nonBeforeUnmount(() => {\r\n    resetRepo();\r\n});\r\n\r\n</script>\r\n<script>\r\n\r\n</script>\r\n\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\n\r\n.table, .thead, .tbody, .tr {\r\n    width : 100%;\r\n}\r\n\r\n</style>","<template>\r\n    <p>{{ title }}</p>\r\n    <input type=\"text\" :placeholder=\"check_str\" @keyup=\"checkStatus\" v-model=\"delval\">\r\n    <button :disabled=\"disabled\" @click=\"del\">{{ btn }}</button>\r\n</template>\r\n\r\n<script setup>\r\n\r\nimport client from \"./../js/client.js\"\r\nimport { ref, computed } from \"vue\";\r\nimport { redirect } from \"./../js/route.js\"\r\nimport { Map } from \"./../js/map.js\"\r\nimport { getDictionary } from \"./../js/dictionary.js\"\r\n\r\nconst props = defineProps({\r\n    check_str : {\r\n        type : String,\r\n        default : \"delete\"\r\n    },\r\n    parentid : {\r\n        default : 0\r\n    }\r\n});\r\n\r\nconst emits = defineEmits(['close']);\r\n\r\nlet delval = ref(\"\");\r\nlet disabled = ref(true);\r\nlet title = computed(() => {\r\n    return getDictionary(\"ptj-delete-title\",  { val : props.check_str});\r\n});\r\n\r\nlet btn = computed(() => {\r\n    return getDictionary(\"ptj-delete-btn\");\r\n});\r\n\r\nfunction checkStatus() {\r\n    disabled.value = (delval.value == props.check_str) ? false : true;\r\n}\r\n\r\nfunction del() {\r\n    client.delete(\"/data/\" + Map.model, {\"--id\":Map.key})\r\n    .then(res => {\r\n        Map.state = \"parent\";\r\n        Map.key = props.parentid.val;\r\n        redirect();\r\n    })\r\n    .catch(e => console.log(e));\r\n}\r\n    \r\n</script>\r\n","<template>\r\n    <a v-if=\"RouteStore.route.perms.includes('put')\" @click=\"toggleState\" class=\"ptj-edit-toggle\">{{ next_state }}</a>\r\n    <ptj-modal v-if=\"RouteStore.route.perms.includes('delete')\" cls=\"ptj-del-modal\">\r\n        <template #button>\r\n            {{ getDictionary('ptj-primary-delete') }}\r\n        </template>\r\n        <template #default=\"delScope\">\r\n            <ptj-delete :parentid=\"store.data.parent\" @close=\"delScope.toggleShow\" />\r\n        </template>\r\n    </ptj-modal>\r\n    <div class=\"ptj-primary\" :class=\"Map.model\" v-if=\"store.fstate == 0\">\r\n        <ptj-form-row v-for=\"field in store.data.cells\" :key=\"field.name\" :field=\"field\"> \r\n          <ptj-asset v-if=\"field.type=='asset'\" :field=\"field\" :id=\"store.data.primary\" />\r\n          <ptj-number v-else-if=\"field.type=='number'\" :field=\"field\" />\r\n          <ptj-flag v-else-if=\"field.type=='flag'\" :field=\"field\" :id=\"store.data.primary\" />\r\n          <ptj-id v-else-if=\"field.type=='id'\" :field=\"field\" :parent=\"store.data.parent\" />\r\n          <ptj-time v-else-if=\"field.type=='time'\" :field=\"field\" />\r\n          <ptj-string v-else-if=\"field.type=='string'\" :field=\"field\"  />\r\n        </ptj-form-row>\r\n        <input v-if=\"store.type =='edit'\" type=\"submit\" :value=\"getDictionary('ptj-primary-put-btn')\" class=\"ptj-form-submit\" @click=\"submit\">\r\n    </div>\r\n    <div class=\"ptj-children\">\r\n        <ptj-button v-for=\"action in RouteStore.route.children\" :key=\"action\" :route=\"{ model : action, state : 'parent', key : Map.key}\">\r\n            {{ action }}\r\n        </ptj-button>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport client from \"./../js/client.js\"\r\nimport PtjNumber from \"./ptj-number.vue\"\r\nimport PtjAsset from \"./ptj-asset.vue\"\r\nimport PtjFlag from \"./ptj-flag.vue\"\r\nimport PtjId from \"./ptj-id.vue\"\r\nimport PtjTime from \"./ptj-time.vue\"\r\nimport PtjString from \"./ptj-string.vue\"\r\nimport { DataRow } from \"./../js/datarow.js\"\r\nimport { reactive, ref, computed, onMounted, onBeforeUnmount } from \"vue\"\r\nimport PtjDelete from \"./ptj-delete.vue\"\r\nimport PtjModal from \"./ptj-modal.vue\"\r\nimport PtjForm from \"./ptj-create-form.vue\"\r\nimport PtjButton from \"./ptj-button.vue\"\r\nimport PtjFormRow from \"./ptj-form-row.vue\"\r\nimport { MetaRow } from \"./../js/metarow.js\"\r\nimport {RouteStore, getModelSettings } from \"./../js/route.js\"\r\nimport { Map } from \"./../js/map.js\"\r\nimport { getDictionary } from \"./../js/dictionary.js\"\r\n  \r\n\r\n\r\nconst store = reactive({ data : new DataRow(), fstate : -1,  type : 'view', show_def : false, progress : { total : 0, progress : 0} });\r\n\r\nfunction toggleState() {\r\n    store.type = (store.type == \"view\") ? \"edit\" : \"view\";\r\n    store.data.setMode(store.type);\r\n    store.fstate = 0;\r\n}\r\n\r\nlet next_state = computed(() => {\r\n    return (store.type == \"edit\") ? \"view\" : \"edit\";\r\n});\r\n\r\n\r\n\r\nfunction buildParams(meta_settings) {\r\n    let params = {};\r\n    if (Map.to) params.__to = Map.to;\r\n    if (Map.key) {\r\n        if (Map.key == \"first\") params.__limit = 1;\r\n        else params[\"--id\"] = Map.key;\r\n    }\r\n    if (meta_settings.fields) params.__fields = meta_settings.fields;\r\n    return params;\r\n}\r\n\r\n\r\nfunction reset() {\r\n    store.data = new DataRow();\r\n    store.fstate = 0;\r\n    store.type = \"view\";\r\n    store.show_def = false;\r\n    store.progress = { total : 0, progress : 0};\r\n}\r\n\r\nconst load = async() => {\r\n    let meta_settings = getModelSettings();\r\n    let params = buildParams(meta_settings);\r\n   \r\n    return client.get(\"/meta/\" + Map.model + \"/primary\", params)\r\n    .then(response => {\r\n        const meta = new MetaRow();\r\n        meta.map(response.fields, meta_settings.fields ?? []);\r\n        store.data.applyMetaRow(meta);\r\n    }).then(() => {\r\n        return client.get(\"/data/\" +  Map.model + \"/primary\", params);\r\n    }).then(response => {\r\n        store.data.row = response;\r\n        //set the change values as well for each row\r\n        for(let i in store.data.cells) {\r\n            store.data.cells[i].change = store.data.cells[i].val;\r\n        }\r\n        store.fstate = 0;\r\n    }).catch(e => console.log(e));\r\n\r\n}\r\n\r\n\r\nfunction submit() {\r\n\r\n    store.fstate = (store.progress.total > 0) ? 1 : 2;\r\n    store.data.clearErrors();\r\n    let key = 0;\r\n    let ndata = store.data.serialize(true);\r\n    if (Object.keys(ndata).length == 0) {\r\n        toggleState();\r\n        return;\r\n    }\r\n    ndata[\"--id\"] = Map.key;\r\n    return client.put(\"/data/\" + Map.model, ndata)\r\n    .then(response=>{\r\n        let promises = [];\r\n        let assets = store.data.getCellByType(\"asset\");\r\n        store.progress.total = 0;\r\n        for(let i in assets) {\r\n            const val = assets[i].val;\r\n            if (!val) continue;\r\n            ++store.progress.total;\r\n            const asset = new Asset();\r\n            asset.url = \"/asset/\" + Map.model + \"/\" + i + \"/\" + response[\"--id\"];\r\n            let promise = asset.saveFile(assets[i].val)\r\n            .then(() => {\r\n                ++store.progress.progress;\r\n            });\r\n            promises.push(promise);\r\n        }\r\n        return Promise.all(promises);\r\n    })\r\n    .then(() => {\r\n        for(let i in store.data.cells) {\r\n            store.data.cells[i].val = store.data.cells[i].change;\r\n        }\r\n    })\r\n    .then(() => {\r\n        toggleState();\r\n    })\r\n    .catch(err => {\r\n            //show error fields, mark fields as invalidate\r\n        store.fstate = 0;\r\n        if (typeof err == \"string\") {\r\n            globalerror = err;\r\n        } else {\r\n            return err.json()\r\n            .then(response => {\r\n                const msg = response.exception[0];\r\n                if (msg.type == \"PressToJamCore\\\\Exceptions\\\\ValidationException\") {\r\n                    store.data.setErrors(JSON.parse(msg.message));\r\n                }\r\n            });\r\n        }\r\n    });\r\n}\r\n\r\nonMounted(async () => {\r\n await load();\r\n});\r\n\r\nonBeforeUnmount(() => {\r\n    reset();\r\n});\r\n\r\n</script>","<template>\r\n <div class=\"ptj-account-handler\">\r\n    <form @submit.prevent=\"submit\" v-show=\"store.state=='login'\" class=\"ptj-login\">\r\n        <div class=\"ptj-form-error\" v-show=\"store.globalerror\">{{ store.globalerror }}</div>\r\n        <ptj-form-row v-for=\"field in store.login_data.cells\" :key=\"field.meta.name\" :field=\"field\">\r\n          <ptj-string type=\"post\" :field=\"field\" />\r\n        </ptj-form-row>\r\n        <input type=\"submit\" :value=\"getDictionary('ptj-account-handler-btn-login')\" class=\"ptj-form-submit\">\r\n        <a v-if=\"RouteStore.route.perms.includes('post')\" @click=\"toggleState('create')\">Register</a>\r\n        <a @click=\"toggleState('forgotpassword')\">Forgotten password?</a>\r\n    </form>\r\n    <form  @submit.prevent=\"submit\" v-show=\"store.state=='create'\" class=\"ptj-register\">\r\n        <div class=\"ptj-form-error\" v-show=\"store.globalerror\">{{ store.globalerror }}</div>\r\n        <ptj-form-row v-for=\"field in store.register_data.cells\" :key=\"field.meta.name\" :field=\"field\">\r\n          <ptj-number v-if=\"field.meta.type=='number'\" type=\"post\" :field=\"field\"/>\r\n          <ptj-flag v-else-if=\"field.meta.type=='flag'\" type=\"post\" :field=\"field\" />\r\n          <ptj-time v-else-if=\"field.meta.type=='time'\" type=\"post\" :field=\"field\" />\r\n          <ptj-string v-else-if=\"field.meta.type=='string'\" type=\"post\" :field=\"field\" />\r\n          <ptj-form-row :field=\"field\" v-if=\"field.encrypted\">\r\n            <ptj-confirm :field=\"field\" />\r\n          </ptj-form-row>\r\n        </ptj-form-row>\r\n        <input type=\"submit\" :value=\"getDictionary('ptj-account-handler-btn-create')\" class=\"ptj-form-submit\">\r\n        <a v-if=\"RouteStore.route.perms.includes('login')\" @click=\"toggleState('login')\">Login</a>\r\n    </form>\r\n    <form  @submit.prevent=\"submit\" v-show=\"store.state=='forgotpassword'\" class=\"ptj-register\">\r\n        <div class=\"ptj-form-error\" v-show=\"store.globalerror\">{{ store.globalerror }}</div>\r\n        <ptj-form-row v-for=\"field in store.forgot_password.cells\" :key=\"field.meta.name\" :field=\"field\">\r\n          <ptj-string type=\"post\" :field=\"field\" />\r\n          <ptj-form-row :field=\"field\">\r\n            <ptj-confirm :field=\"field\" />\r\n          </ptj-form-row>\r\n        </ptj-form-row>\r\n        <input type=\"submit\" :value=\"getDictionary('ptj-account-handler-btn-forgot-password')\" class=\"ptj-form-submit\">\r\n        <a @click=\"toggleState('login')\">Login</a>\r\n    </form>\r\n </div>\r\n</template>\r\n\r\n<script setup>\r\n\r\nimport PtjFormRow from \"./ptj-form-row.vue\"\r\nimport PtjString from \"./ptj-string.vue\"\r\nimport PtjNumber from \"./ptj-number.vue\"\r\nimport PtjFlag from \"./ptj-flag.vue\"\r\nimport PtjTime from \"./ptj-time.vue\"\r\nimport { refresh } from \"./../js/route.js\"\r\nimport { Map } from \"./../js/map.js\"\r\nimport { reactive } from 'vue'\r\nimport { DataRow } from './../js/datarow.js';\r\nimport { MetaRow } from \"./../js/metarow.js\"\r\nimport client from \"./../js/client.js\"\r\nimport { getDictionary } from \"./../js/dictionary.js\"\r\nimport {RouteStore } from \"./../js/route.js\"\r\nimport PtjConfirm from \"./ptj-form-confirm.vue\"\r\n\r\nconst props = defineProps({\r\n    actions : []\r\n});\r\n\r\n\r\nconst store = reactive({\r\n    state : 'login',\r\n    active : true,\r\n    login_data : new DataRow(),\r\n    register_data : new DataRow(),\r\n    forgot_password : new DataRow(),\r\n    globalerror : ''\r\n});\r\n\r\nfunction toggleState(state) {\r\n    store.state = state;\r\n}\r\n\r\n//load our modules\r\n\r\nclient.post(\"/meta/\" + Map.model)\r\n.then(response => {\r\n    let meta = new MetaRow();\r\n    meta.map(response.fields);\r\n    store.register_data.applyMetaRow(meta);\r\n    store.register_data.setMode(\"edit\");\r\n});\r\n\r\nclient.post(\"/meta/\" +  Map.model + \"/login\")\r\n.then(response => {\r\n    let meta = new MetaRow();\r\n    meta.map(response.fields);\r\n    store.login_data.applyMetaRow(meta);\r\n    store.login_data.setMode(\"edit\");\r\n    store.forgot_password.applyMetaRow(meta);\r\n});\r\n\r\n\r\nfunction submit() {\r\n    store.active = false;\r\n    store.globalerror = \"\";\r\n    if (store.state == \"login\") {\r\n        return client.post(\"/login/\" + Map.route, store.login_data.serialize(\"login\"))\r\n        .then(response => {\r\n            refresh();\r\n        })\r\n        .catch(e => {\r\n            store.globalerror = \"Incorrect username / password\";\r\n        });\r\n    } else if (store.state == \"forgotpassword\") {\r\n        return client.post(\"/data/\" +  Map.model + \"/forgotpassword\", store.forgot_password.serialize(\"login\"))\r\n        .then(response => {\r\n            refresh();\r\n        })\r\n        .catch(e => {\r\n            store.globalerror = \"Incorrect username / password\";\r\n        });\r\n    } else {\r\n        return client.post(\"/data/user-login\", store.register_data.serialize(\"post\"))\r\n        .then(response => {\r\n            refresh();\r\n        })\r\n        .catch(e => {\r\n            store.register_data.applyErrors(e);\r\n        });\r\n    }\r\n} \r\n</script>\r\n\r\n\r\n","<template>\r\n    <ptj-slug-trail />\r\n    <Suspense>\r\n        <template #default>\r\n            <div :class=\"[Map.model, Map.state]\">\r\n            <h1>{{ RouteStore.title }}</h1>\r\n            <component v-if=\"component\" :is=\"component\" />\r\n            </div>\r\n        </template>\r\n        <template #fallback>\r\n            <div>Loading ...</div>\r\n        </template>\r\n    </Suspense>\r\n</template>\r\n<script setup>\r\n\r\nimport { computed, onMounted } from \"vue\"\r\nimport PtjSlugTrail from \"./ptj-slug-trail.vue\"\r\nimport { RouteStore, loadRoute, loadSlugTrail } from \"../js/route.js\"\r\nimport PtjRepo from \"./ptj-repo.vue\"\r\nimport PtjPrimary from \"./ptj-primary.vue\"\r\nimport PtjAccountHandler from \"./ptj-account-handler.vue\"\r\nimport { Map } from \"../js/map.js\"\r\n\r\n\r\nconst component = computed(() => {\r\n    if (!RouteStore.component) return null;\r\n    else if (RouteStore.component == \"ptj-primary\") return PtjPrimary;\r\n    else if (RouteStore.component == \"ptj-repo\") return PtjRepo;\r\n    else if (RouteStore.component == \"ptj-account-handler\") return PtjAccountHandler;\r\n});\r\n\r\n\r\n\r\n\r\nonMounted(() => {\r\n    loadSlugTrail();\r\n    return loadRoute();\r\n});\r\n\r\n</script>","<template>\r\n    <div class=\"ptj-nav\">\r\n        <div v-for=\"(routes, title) in NavStore.cats\" :key=\"title\">\r\n            <span v-if=\"routes.length > 1\">{{ title }}</span>\r\n            <ptj-button v-for=\"(route) in routes\" :route=\"{ 'route' : route.route, 'model' : route.model, 'state':route.state, 'key' : 0}\" :key=\"route.route\">{{ route.route }}</ptj-button>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script setup>\r\nimport { reactive, onMounted } from \"vue\"\r\nimport Client from \"./../js/client.js\"\r\nimport PtjButton from \"./ptj-button.vue\"\r\n\r\n\r\nconst NavStore = reactive({\r\n    cats : {}, \r\n    routes : [], \r\n});\r\n\r\n\r\nonMounted(() => {\r\nreturn Client.get(\"/nav/site-map\")\r\n    .then(response => {\r\n        for(let cat in response) {\r\n            if (!response[cat]) {\r\n                const route = { route : cat,  model : cat, state : null };\r\n                NavStore.cats[cat] = [route];\r\n            } else {\r\n                for(let route_name in response[cat]) {\r\n                    const route = { model : route_name, state : response[cat][route_name].state };\r\n                    if (response[cat][route_name].default) route.default = true;\r\n                    route.route = route_name;\r\n                    NavStore.routes.push(route);\r\n\r\n                    if (!NavStore.cats[cat]) NavStore.cats[cat] = [];\r\n                    NavStore.cats[cat].push(route);\r\n                }\r\n            }\r\n        }\r\n    })\r\n    .catch(e => {\r\n        console.log(e);\r\n    });\r\n});\r\n</script>","let settings = {};\r\nimport client from \"./client.js\"\r\nimport { Map } from \"./map.js\"\r\nimport { initUser } from \"./user.js\"\r\nimport { initSettings} from \"./route.js\"\r\n\r\n\r\nexport function PtjRun(settings = {}) {\r\n    if (!settings) settings = {};\r\n    if (!settings.client) {\r\n        throw \"Must set client settings\";\r\n    }\r\n\r\n    if (!settings.client.url) {\r\n        throw(\"No URL defined for client\");\r\n    }\r\n\r\n    client.initSettings(settings.client);\r\n\r\n    if (settings.map) {\r\n        Map.initSettings(settings.map);\r\n    }\r\n\r\n    initSettings(settings.models);\r\n\r\n    let role = (settings.user && settings.user.role) ? settings.user.role : \"\";\r\n    return initUser(role);\r\n}\r\n","import PTJUser from \"./presstojam/src/components/ptj-user.vue\"\r\nimport PTJRoute from \"./presstojam/src/components/ptj-route.vue\"\r\nimport { PtjRun } from \"./presstojam/src/js/controller.js\"\r\nimport Client from \"./presstojam/src/js/client.js\"\r\nimport { createApp } from \"vue\"\r\n\r\n \r\nexport function runApp(mount, user_settings) {\r\n    PtjRun(user_settings)\r\n    .then(() => {\r\n        return loadNav()\r\n    }).then(() => {\r\n        const app = createApp(PTJUser);\r\n        app.mount(mount);\r\n        return app;\r\n    }).catch(e => {\r\n        console.log(e);\r\n    });\r\n}\r\n\r\nexport function runRoute(mount, user_settings) {\r\n    PtjRun(user_settings)\r\n    .then(() => {\r\n        const app = createApp(PTJRoute);\r\n        app.mount(mount);\r\n        return app;\r\n    }).catch(e => {\r\n        console.log(e);\r\n    });\r\n}\r\n\r\n\r\nexport function getClient(settings) {\r\n\r\n    if (!settings.client) {\r\n        throw \"Must set client settings\";\r\n    }\r\n\r\n    if (!settings.client.url) {\r\n        throw(\"No URL defined for client\");\r\n    }\r\n\r\n    Client.initSettings(settings.client);\r\n    return Client;\r\n}\r\n\r\n"],"names":["active","ref","toggleShow","value","relstyle","computed","props","relative","obj","el","left","top","width","offsetWidth","height","offsetHeight","wrapper","classList","contains","offsetLeft","offsetTop","parentNode","getOffsetToWrapper","disabled","getClass","location","styleInject","css","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","main_url","custom_headers","Client","initSettings","settings","url","name","run","method","params","body","headers","Headers","set","i","fetch","mode","cache","credentials","then","response","ok","json","get","data","URLSearchParams","Array","isArray","append","JSON","stringify","indexOf","toString","this","getprimary","post","put","patch","getAsset","blob","delete","Map","constructor","_route","_flow","_model","_state","_key","_to","_params","_base","_default","Object","keys","forEach","property","defineProperty","substring","newValue","action_map","login","logout","primary","parent","id","model","state","to","reset","route","flow","key","convertToURL","pts","x","push","join","param_str","base","convertFromURL","url_obj","URL","window","href","pathname","replace","parts","split","length","_self","searchParams","pop","isNaN","parseInt","Error","getAll","default","apply","model_settings","onpopstate","runRoute","RouteStore","reactive","component","title","children","perms","slug","sort","getModelSettings","loadRoute","client","catch","e","console","log","loadSlugTrail","refresh","redirect","addToHistory","url_str","protocol","host","history","pushState","custom_val","selectCustom","field","change1","change","filter","item","getOption","opt","options","show_list","display","symbol","toggleList","select","target","getAttribute","dictionary","getDictionary","vals","str","exp","models","fields","def","val","Errors","store","validateon","fstate","submit","ndata","emit","err","globalerror","cdata","setErrors","immutable","tag","enums","regEx","RegExp","test","isEnum","setContainsAsOptions","encrypted","html","max","atts","readonly","pholder","placeholder","includes","User","init","user","checkLoginStatus","is_expired","setTimeout","initUser","role","Field","_name","_store","summary","_default_val","_immutable","_encrypted","_min","_max","_contains","_notcontains","_listeners","_type","toLowerCase","validation","min","notcontains","clean","calcValue","validateSize","validate","nhas","match","has","trigger","addParam","addAPIParam","getVal","setVal","error","getChange","setChange","getFilter","setFilter","getErrorVal","ID","super","_reference","_include_fields","_recursive","_reference_to","reference_to","referenceTo","setReferenceOptions","getChange1","setChange1","reference","include_fields","recursive","Flag","Asset","_size","_blob","_uploaded","_chunk_size","_url","chunk_size","chunk","size","uploaded","getChunk","index","start","end","view","DataView","buffer","n","byteLength","getInt8","loadFile","__key","alert","delFile","saveFile","file","Promise","resolve","reject","fr","FileReader","onload","result","onerror","readAsArrayBuffer","promises","chunks","Math","ceil","__chunk","__blob","all","Time","cobj","change2","getChange2","setChange2","Number","_round","parseFloat","toFixed","round","String","opts","arr","createField","MetaRow","_cells","_children","_active","_init","_state_groups","addChild","child","addState","action","_actions","resetSummary","setStates","groups","states","depends_on","mapField","map","limited_fields","getCellByType","cells","showAll","DataCell","meta","is_validate_on","meta_keys","getOwnPropertyNames","row","fname","showError","default_val","on","resetMeta","isSummary","createStateTrigger","cb","group","depends_val","DataRow","metarow","_metarow","_ids","applyMetaRow","setMode","getCell","clone","state_groups","listeners","hasOwnProperty","getSummary","cell","serialize","changes_only","clearErrors","convertToParams","convertToAPIParams","applyChangeData","RepoStore","indexes","search","indexData","ckey","mapRepoData","resetRepo","max_pages","loadRepo","async","meta_settings","__to","limit","__limit","__fields","_page","buildParams","show","filter_fields","count","toggle_state","branch","toggle","onMounted","step","icon","getOptions","anchor","createObjectURL","download","click","removeChild","revokeObjectURL","order","dir","tableheader","pages","load","y","xval","yval","vue","inject","getIndexCombinations","combos","getCombinations","searchData","getActiveClass","page","num","floor","progress","total","assets","asset","promise","msg","exception","parse","message","_drag_target","_x","_y","dragStart","ev","targ","dataTransfer","dropEffect","opacity","clientX","clientY","dragEnd","dragEnter","preventDefault","drop_target","closest","nextElementSibling","dragLeave","dragOver","drop","querySelectorAll","c","getOrder","_rows","positions","reorder","reorderRepo","onBeforeUnmount","delval","check_str","btn","checkStatus","del","res","parentid","show_def","toggleState","next_state","login_data","register_data","forgot_password","applyErrors","PtjPrimary","PtjRepo","PtjAccountHandler","NavStore","cats","routes","cat","route_name","PtjRun","mount","user_settings","loadNav","app","createApp","PTJUser","PTJRoute"],"mappings":"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"}