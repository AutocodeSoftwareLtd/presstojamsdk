{"version":3,"file":"ptj.min.js","sources":["../presstojam/src/js/settings.js","../presstojam/src/js/client.js","../presstojam/src/js/moduleloader.js","../presstojam/src/js/route.js","../presstojam/src/js/map.js","../presstojam/src/components/ptj-button.vue","../node_modules/style-inject/dist/style-inject.es.js","../presstojam/src/js/user.js","../presstojam/src/components/ptj-slug-trail.vue","../presstojam/src/components/ptj-router.vue","../presstojam/src/components/ptj-user.vue","../import.js"],"sourcesContent":["let settings = {};\r\n\r\nfunction regSettings(isettings, type = null) {\r\n    if (!type) settings = isettings;\r\n    else settings[type] = isettings;\r\n}\r\n\r\n\r\nfunction getSettings(type) {\r\n    return settings[type];\r\n} \r\n\r\n\r\nfunction getModelSettings(model, state) {\r\n    if (settings.models && settings.models[model] && settings.models[model][state]) {\r\n        return settings.models[model][state];\r\n    }\r\n    return {};\r\n}\r\n\r\nexport default {\r\n    regSettings,\r\n    getSettings,\r\n    getModelSettings\r\n}","import Settings from \"./settings.js\"\r\n\r\nlet custom_headers  = {};\r\nlet main_url;\r\n\r\nexport default {\r\n\r\n    initSettings() {\r\n        const settings = Settings.getSettings(\"client\");\r\n        if (!settings.url) {\r\n            throw(\"No URL defined for client\");\r\n        }\r\n        main_url = settings.url;\r\n\r\n        if (settings.custom_headers) {\r\n            for(let name in settings.custom_headers) {\r\n                custom_headers[name] = settings.custom_headers[name];\r\n            }\r\n        }\r\n    },\r\n\r\n    run(url, headers) {\r\n\r\n        if (!main_url) {\r\n            this.initSettings();\r\n        }\r\n        \r\n        headers.mode = 'cors';\r\n        headers.cache = 'no-cache';\r\n        headers.credentials = 'include';\r\n        headers['Content-Type'] = 'application/json';\r\n        headers.headers = custom_headers;\r\n\r\n        const _self = this;\r\n\r\n        return fetch(main_url + url, headers)\r\n        .then(response => {\r\n            if (response.ok) {\r\n                return response.json();\r\n            } else {\r\n                throw response;\r\n            }\r\n        });\r\n    }, \r\n    get(url, data) {\r\n        if (data) {\r\n            const params = new URLSearchParams();\r\n            for(let i in data) {\r\n                if (Array.isArray(data[i]) || (typeof data[i] == 'object' && data[i] !== null)) {\r\n                   params.append(i, JSON.stringify(data[i]));\r\n                } else params.append(i, data[i]);\r\n            }\r\n\r\n            if (url.indexOf(\"?\") == -1) url += \"?\";\r\n            else url += \"&\";\r\n            url += params.toString();\r\n        }\r\n        let headers = {};\r\n        headers.method = 'GET';\r\n        return  this.run(url, headers);\r\n    },\r\n\r\n    getprimary(url, data) {\r\n        return this.get(url, data);\r\n    },\r\n\r\n    post(url, data) {\r\n        //call our fetch response and return\r\n        let headers = {};\r\n        headers.method = 'POST';\r\n        headers.body = JSON.stringify(data);\r\n        return this.run(url, headers);\r\n    },\r\n\r\n    put(url, data) {\r\n        let headers = {};\r\n        headers.method = 'PUT';\r\n        headers.body = JSON.stringify(data);\r\n        return this.run(url, headers);\r\n    },\r\n\r\n    patch(url, data) {\r\n        let headers = {};\r\n        headers.method = 'PATCH';\r\n        headers.body = JSON.stringify(data);\r\n        return this.run(url, headers);\r\n    },\r\n\r\n    delete(url, data) {\r\n        let headers = {};\r\n        headers.method = 'DELETE';\r\n        headers.body = JSON.stringify(data);\r\n        return this.run(url, headers);\r\n    }\r\n}\r\n","const module_address = {\r\n}\r\n\r\nfunction addModule(name, location) {\r\n    module_address[name] = location;\r\n}\r\n\r\n\r\nfunction loadModule(name) {\r\n    if (module_address[name]) {\r\n        return import(/* @vite-ignore */module_address[name]);\r\n    } else {\r\n        return import(/* @vite-ignore */\"./../components/\" + name + \".vue\");\r\n    }\r\n}\r\n\r\nexport default {\r\n    addModule,\r\n    loadModule\r\n}","import { reactive, defineAsyncComponent } from \"vue\"\r\nimport client from \"./client.js\"\r\nimport Settings from \"./settings.js\"\r\nimport { MapModel } from \"./map.js\"\r\nimport ModuleLoader from \"./moduleloader.js\"\r\nimport { setDictionary } from \"./dictionary.js\"\r\n\r\nwindow.onpopstate = function() {\r\n    Map.convertFromURL();\r\n    runRoute();\r\n}\r\n\r\nexport const RouteStore = reactive({ \r\n    cats : {}, \r\n    routes : [], \r\n    component : '', \r\n    title : '',\r\n    name : '',\r\n    route : { \"children\" : [], parent : null, \"perms\" : []}, \r\n});\r\n\r\nexport const Map = new MapModel();\r\n\r\nfunction setComponent() {\r\n    if (Map.state == \"get\" || Map.state == \"parent\") {\r\n        RouteStore.component = \"ptj-repo\";\r\n    } else if (Map.state == \"primary\") {\r\n        RouteStore.component = \"ptj-primary\";\r\n    } else if (Map.state == \"login\") {\r\n        RouteStore.component = \"ptj-account-handler\";\r\n    }\r\n}\r\n\r\n\r\nexport function init() {\r\n    let role = \"\";\r\n    const settings = Settings.getSettings(\"mapper\");\r\n    if (settings) {\r\n        Map.base = \"/\" + settings.base.replace(/^\\/+|\\/+$/g, '');\r\n        if (settings.role) {\r\n            role = settings.role;\r\n        }\r\n    }\r\n\r\n    Map.convertFromURL();\r\n    return Promise.resolve();\r\n}\r\n\r\nfunction getDefault() {\r\n    for(let cat in RouteStore.cats) {\r\n        for(let route of RouteStore.cats[cat]) {\r\n            if (route.default) {\r\n                return route;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\nfunction load(response) {\r\n    RouteStore.cats = {};\r\n    RouteStore.routes = [];\r\n    RouteStore.route = { \"children\" : [], parent : null, \"perms\" : []};\r\n    RouteStore.model = null;\r\n    return client.get(\"/nav/site-map\")\r\n    .then(response => {\r\n        for(let cat in response) {\r\n            for(let route_name in response[cat]) {\r\n                const route = { model : route_name, state : response[cat][route_name].state };\r\n                if (response[cat][route_name].default) route.default = true;\r\n                route.route = route_name;\r\n                RouteStore.routes.push(route);\r\n\r\n                if (!RouteStore.cats[cat]) RouteStore.cats[cat] = [];\r\n                RouteStore.cats[cat].push(route);\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\n\r\nfunction loadRoute() {\r\n    return client.get(\"/nav/route-points/\" + Map.route + \"/\" + Map.model)\r\n    .then(response => {   \r\n        RouteStore.route.children = response.children;\r\n        RouteStore.route.perms = response.perms;\r\n        RouteStore.route.parent = response.parent;\r\n        RouteStore.title = response.title;\r\n        RouteStore.name = response.name;\r\n        setDictionary(response.dictionary);\r\n    })\r\n    .catch(e => console.log(e));\r\n}\r\n\r\n\r\n\r\n\r\nexport function refresh() {\r\n    location.href = Map.base;\r\n}\r\n\r\nexport function redirect() {\r\n    addToHistory();\r\n    runRoute();\r\n}\r\n\r\nexport function addToHistory() {\r\n    const url_str = window.location.protocol + \"//\" + window.location.host +  Map.convertToURL();\r\n    const url = new URL(url_str);\r\n    window.history.pushState({'name' : url.pathname}, document.title, url);\r\n}\r\n\r\nexport function runRoute() {\r\n    let promises = [];\r\n    if (!Map.model) {\r\n        promises.push(\r\n            load()\r\n            .then(() => {\r\n                Map.apply(getDefault());\r\n                return loadRoute();\r\n            })\r\n        );\r\n    } else if (Map.hasChange(\"route\")) {\r\n      promises.push(load());\r\n      promises.push(loadRoute());\r\n    } else if (Map.hasChange(\"model\")) {\r\n        promises.push(loadRoute());\r\n    }\r\n\r\n    return Promise.all(promises)\r\n    .then(() => {\r\n        if (!Map.model) {\r\n            \r\n        }\r\n        setComponent();\r\n    })\r\n    .catch(e => console.log(e));\r\n}\r\n","import { computed, reactive } from \"vue\"\r\n\r\nexport class MapModel {\r\n\r\n    constructor() {\r\n        this._route = '';\r\n        this._model = '';\r\n        this._state = '';\r\n        this._key = 0;\r\n        this._to = '';\r\n        this._params = {};\r\n        this._settings = {};\r\n        this._base = \"/\";\r\n        this._default = false;\r\n        this._changes = {};\r\n\r\n        const keys = Object.keys(this);\r\n\r\n        keys.forEach(property => {\r\n          if (property[0] == \"_\") {\r\n            Object.defineProperty(this, property.substring(1), {\r\n                get: function() { \r\n                    return this[property];\r\n                },\r\n                set: function(newValue) {\r\n                    this._changes[property.substring(1)] = this[property];\r\n                    this[property] = newValue;\r\n                }\r\n            });\r\n          } \r\n        });\r\n\r\n\r\n        this.action_map = {\r\n            'post' : '-create',\r\n            'put' : '-update',\r\n            'delete' : '-delete',\r\n            'login' : '-login',\r\n            'logout' : '-logout',\r\n            'primary' : '-primary',\r\n            'parent' : '-parent',\r\n            'get' : ''\r\n        };\r\n    }\r\n\r\n    get id() {\r\n        return this.model + \"-\" + this.state + \"-\" + this.to;\r\n    }\r\n\r\n    hasChange(key) {\r\n        return this._changes.hasOwnProperty(key);\r\n    }\r\n\r\n    reset() {\r\n        this.route = '';\r\n        this.model = '';\r\n        this.state = '';\r\n        this.key = 0;\r\n        this.to = '';\r\n        this.params = {};\r\n        this.settings = {};\r\n        this._changes = {};\r\n    }\r\n\r\n    resetChanges() {\r\n        this._changes = {};\r\n    }\r\n\r\n\r\n    convertToURL() {\r\n        let url = this._base + this.route + \"/\" + this.model + this.action_map[this.state];\r\n        if (this.key) url += \"-\" + this.key;\r\n        if (this.to) url += \"-to-\" + this.to;\r\n\r\n        let param_str = [];\r\n        for(const i in this.params) {\r\n            if (typeof this.params[i] == 'Array' || typeof this.params[i] == 'Object') {\r\n                param_str.push(i + \"=\" + JSON.stringify(this.params[i]));\r\n            } else {\r\n                param_str.push(i + \"=\" + this.params[i]);\r\n            }\r\n        }\r\n\r\n        if (param_str.length > 0) url += \"?\" + param_str.join(\"&\");\r\n\r\n        return url;\r\n    }\r\n    \r\n    convertFromURL(url_obj) {\r\n        if (!url_obj) url_obj = new URL(window.location.href);\r\n        let url = url_obj.pathname.replace(this.base, \"\");\r\n        url = url.replace(/^\\/+|\\/+$/g, '');\r\n\r\n        if (!url) return;\r\n\r\n\r\n        let parts = url.split(\"/\");\r\n        this.route = parts[0];\r\n        url = parts[1];\r\n\r\n        const _self = this;\r\n        url_obj.searchParams.forEach(function(value, key) {\r\n            _self.params[key] = (value.indexOf(\",\") > -1) ? value.split(\",\") : value;\r\n        });\r\n\r\n        parts = url.split(\"-to-\");\r\n        if (parts.length > 1) {\r\n            this.to = parts[1];\r\n            url = parts[0];\r\n        }\r\n\r\n       \r\n        parts = url.split(\"-\");\r\n        let key = parts[parts.length - 1];\r\n        if (key == \"first\") {\r\n            this.key = key;\r\n            parts.pop();\r\n        } else if (!isNaN(key)) {\r\n            this.key = key;\r\n            parts.pop();\r\n        }\r\n            \r\n        if (parts.length == 0) {\r\n            throw new Error(\"Can't convert this url string: \" + url);\r\n        }\r\n    \r\n        this.state = \"get\";\r\n        for(let i in this.action_map) {\r\n            if (this.action_map[i] == \"-\" + parts[parts.length - 1]) {\r\n                this.state = i\r\n                parts.pop();\r\n                break;\r\n            }\r\n        }\r\n        this.model = parts.join(\"-\");\r\n    }\r\n\r\n    getAll() {\r\n        return {\r\n            route : this.route,\r\n            model : this.model,\r\n            state : this.state,\r\n            key : this.key,\r\n            to : this.to,\r\n            params : this.params,\r\n            base : this.base,\r\n            default : this.default\r\n        };\r\n    }\r\n\r\n    apply(route) {\r\n        for(let i in route) {\r\n            this[i] = route[i];\r\n        }\r\n    }\r\n}\r\n\r\n","<template>\r\n  <a class=\"ptj-button\" :key=\"route\" @click=\"run\">\r\n    <slot />\r\n  </a> \r\n</template>\r\n\r\n<script setup>\r\n\r\n\r\nimport { redirect, Map } from \"./../js/route.js\"\r\n\r\nconst props = defineProps({\r\n    route : Object\r\n});\r\n\r\n\r\nfunction run() {\r\n    for(let i in props.route) {\r\n        Map[i] = props.route[i];\r\n    }\r\n    redirect();\r\n}\r\n\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\n</style>","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import { reactive } from \"vue\"\r\nimport { refresh } from \"./route.js\"\r\nimport Client from \"./client.js\"\r\n\r\nexport const User = reactive({init : false, login : false, user : \"public\" });\r\n\r\nexport function logout() {\r\n    Client.post(\"/core/logout\")\r\n    .then(() => {\r\n        refresh();\r\n    });\r\n}\r\n\r\n\r\nconst user_check = 600000;\r\n\r\nexport function checkLoginStatus() {\r\n    Client.get(\"/core/check-user\")\r\n    .then(response => {\r\n        if (response.is_expired) {\r\n            return Client.put(\"/core/switch-tokens\")\r\n            .then(() => {\r\n                checkLoginStatus();\r\n            });\r\n        }\r\n        if (!User.init) {\r\n            User.user = response.user;\r\n            User.role = response.role;\r\n            User.init = true;\r\n            /*if (user.user != \"public\") {\r\n                return Client.post(\"/route/\" + user.user + \"/\" + user.user + \"/login\")\r\n                .then(response => {\r\n                    let meta = new MetaRow();\r\n                    meta.map(response.fields);\r\n                    register_data.applyMetaRow(meta);\r\n                });\r\n            }*/\r\n        }\r\n    }).then(response => {\r\n        if (User.user != \"public\") setTimeout(checkLoginStatus, user_check);\r\n    }).catch(e => {\r\n        User.login = true;\r\n    });\r\n}\r\n\r\n","<template>\r\n    <div class=\"ptj-slug-trail\">\r\n        <ptj-button v-for=\"trail in trails\" :key=\"trail.id\" :route=\"trail.route\">{{ trail.value }}</ptj-button>\r\n    </div>\r\n</template>\r\n<script setup>\r\nimport PtjButton from \"./ptj-button.vue\"\r\nimport { ref } from \"vue\"\r\nimport client from \"../js/client.js\"\r\nimport { Map } from \"../js/route.js\"\r\n\r\nconst trails = ref([]);\r\n\r\nconst init = async() => {\r\n    trails.value.splice(0);\r\n    return client.get(\"/slug/\" + Map.route + \"/\" + Map.model + \"/\" + Map.key)\r\n    .then(response => {\r\n        for(let i in response) {\r\n            let values = [];\r\n            for(let x in response[[i]]) {\r\n                if (x == \"--id\") {\r\n                    continue;\r\n                }\r\n                values.push(response[i][x]);\r\n            }\r\n            trails.value.push({\r\n                id : response[i][\"--parentid\"],\r\n                model : response[i].model\r\n            });\r\n        }\r\n    });\r\n}\r\n\r\nonMounted(async () => {\r\n   // await init();\r\n});\r\n\r\n</script>","<template>\r\n    <div class=\"ptj-nav\">\r\n        <div v-for=\"(routes, title) in RouteStore.cats\" :key=\"title\">\r\n            <span v-if=\"routes.length > 1\">{{ title }}</span>\r\n            <ptj-button v-for=\"(route) in routes\" :route=\"{ 'route' : route.route, 'model' : route.model, 'state':route.state, 'key' : 0}\" :key=\"route.route\">{{ route.route }}</ptj-button>\r\n        </div>\r\n    </div>\r\n    <ptj-slug-trail />\r\n    <Suspense>\r\n        <template #default>\r\n            <div :class=\"[Map.model, Map.state]\">\r\n            <ptj-button v-if=\"RouteStore.back\" :route=\"RouteStore.back\"><span class=\"material-icons\">back</span></ptj-button>\r\n            <h1>{{ RouteStore.title }}</h1>\r\n            <component v-if=\"component\" :is=\"component\" />\r\n            </div>\r\n        </template>\r\n        <template #fallback>\r\n            <div>Loading ...</div>\r\n        </template>\r\n    </Suspense>\r\n</template>\r\n<script setup>\r\n\r\nimport { computed, defineAsyncComponent, onMounted } from \"vue\"\r\nimport PtjButton from \"./ptj-button.vue\"\r\nimport PtjSlugTrail from \"./ptj-slug-trail.vue\"\r\nimport { init, RouteStore, runRoute } from \"./../js/route.js\"\r\nimport ModuleLoader from \"./../js/moduleloader.js\"\r\n\r\n\r\nconst component = computed(() => {\r\n    if (!RouteStore.component) return null;\r\n    else return defineAsyncComponent(() => ModuleLoader.loadModule(RouteStore.component));\r\n});\r\n\r\n\r\n\r\n\r\nonMounted(() => {\r\n    init()\r\n    .then(() => {\r\n        return runRoute();\r\n    });\r\n});\r\n\r\n</script>","<template>\r\n    <Teleport to=\"#ptj-accountdetails\">\r\n    <a v-if=\"User.user != 'public'\" class=\"ptj-account-details-logout\" @click=\"logout\">Logout</a>\r\n    </Teleport>\r\n    <ptj-router />\r\n    <ptj-modal :active=\"User.login\">\r\n        \r\n    </ptj-modal>\r\n</template>\r\n<script setup>\r\n\r\nimport PtjModal from \"./ptj-modal.vue\"\r\nimport PtjString from \"./ptj-string.vue\"\r\nimport { User, checkLoginStatus, logout } from \"../js/user.js\"\r\nimport PtjRouter from \"./ptj-router.vue\"\r\n\r\n\r\ncheckLoginStatus();\r\n\r\n/*\r\n<form @submit.prevent=\"submit\" class=\"ptj-login\">\r\n            <ptj-form-row v-for=\"field in login_data.cells\" :key=\"field.meta.name\" :field=\"field\">\r\n                <ptj-string type=\"edit\" :field=\"field\" />\r\n            </ptj-form-row>\r\n            <input type=\"submit\" value=\"Login\" class=\"ptj-form-submit\" @click=\"submit\">\r\n        </form>\r\n*/\r\n\r\n</script>","import PTJUser from \"./presstojam/src/components/ptj-user.vue\"\r\nimport Settings from \"./presstojam/src/js/settings.js\"\r\nimport Client from \"./presstojam/src/js/client.js\"\r\nimport { createApp } from \"vue\"\r\n\r\nfunction runApp(mount, user_settings) {\r\n    Settings.regSettings(user_settings);\r\n    const app = createApp(PTJUser);\r\n    app.mount(mount);\r\n    return app;\r\n}\r\n\r\nfunction getClient(user_settings) {\r\n    Settings.regSettings(user_settings);\r\n    return Client;\r\n}\r\n\r\n\r\n\r\nexport default { \r\n    runApp,\r\n    getClient\r\n}\r\n\r\n\r\n"],"names":["settings","regSettings","isettings","type","getSettings","getModelSettings","model","state","models","main_url","custom_headers","initSettings","Settings","url","name","run","headers","mode","cache","credentials","fetch","then","response","ok","json","get","data","params","URLSearchParams","i","Array","isArray","append","JSON","stringify","indexOf","toString","this","getprimary","post","body","put","patch","delete","module_address","addModule","location","loadModule","import","window","onpopstate","Map","convertFromURL","runRoute","RouteStore","reactive","cats","routes","component","title","route","parent","constructor","_route","_model","_state","_key","_to","_params","_settings","_base","_default","_changes","Object","keys","forEach","property","defineProperty","substring","set","newValue","action_map","id","to","hasChange","key","hasOwnProperty","reset","resetChanges","convertToURL","param_str","push","length","join","url_obj","URL","href","pathname","replace","base","parts","split","_self","searchParams","value","pop","isNaN","Error","getAll","default","apply","load","client","cat","route_name","loadRoute","children","perms","dictionary","catch","e","console","log","redirect","url_str","protocol","host","history","pushState","document","addToHistory","promises","getDefault","Promise","all","props","styleInject","css","ref","insertAt","head","getElementsByTagName","style","createElement","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","User","init","login","user","logout","Client","checkLoginStatus","is_expired","role","setTimeout","trails","onMounted","async","computed","defineAsyncComponent","ModuleLoader","resolve","runApp","mount","user_settings","app","createApp","PTJUser","getClient"],"mappings":"qtBAAA,IAAIA,EAAW,SAoBA,CACXC,YAnBJ,SAAqBC,EAAWC,EAAO,MAC9BA,EACAH,EAASG,GAAQD,EADXF,EAAWE,GAmBtBE,YAdJ,SAAqBD,UACVH,EAASG,IAchBE,iBAVJ,SAA0BC,EAAOC,UACzBP,EAASQ,QAAUR,EAASQ,OAAOF,IAAUN,EAASQ,OAAOF,GAAOC,GAC7DP,EAASQ,OAAOF,GAAOC,GAE3B,KCfX,IACIE,EADAC,EAAkB,SAGP,CAEXC,qBACUX,EAAWY,EAASR,YAAY,cACjCJ,EAASa,SACJ,+BAEVJ,EAAWT,EAASa,IAEhBb,EAASU,mBACL,IAAII,KAAQd,EAASU,eACrBA,EAAeI,GAAQd,EAASU,eAAeI,IAK3DC,IAAIF,EAAKG,UAEAP,QACIE,eAGTK,EAAQC,KAAO,OACfD,EAAQE,MAAQ,WAChBF,EAAQG,YAAc,UACtBH,EAAQ,gBAAkB,mBAC1BA,EAAQA,QAAUN,EAIXU,MAAMX,EAAWI,EAAKG,GAC5BK,MAAKC,OACEA,EAASC,UACFD,EAASE,aAEVF,MAIlBG,IAAIZ,EAAKa,MACDA,EAAM,OACAC,EAAS,IAAIC,oBACf,IAAIC,KAAKH,EACLI,MAAMC,QAAQL,EAAKG,KAA0B,iBAAXH,EAAKG,IAA8B,OAAZH,EAAKG,GAC/DF,EAAOK,OAAOH,EAAGI,KAAKC,UAAUR,EAAKG,KACjCF,EAAOK,OAAOH,EAAGH,EAAKG,KAGR,GAArBhB,EAAIsB,QAAQ,KAAYtB,GAAO,IAC9BA,GAAO,IACZA,GAAOc,EAAOS,eAEdpB,EAAU,CACdA,OAAiB,cACTqB,KAAKtB,IAAIF,EAAKG,IAG1BsB,WAAWzB,EAAKa,UACLW,KAAKZ,IAAIZ,EAAKa,IAGzBa,KAAK1B,EAAKa,OAEFV,EAAU,CACdA,OAAiB,eACjBA,EAAQwB,KAAOP,KAAKC,UAAUR,GACvBW,KAAKtB,IAAIF,EAAKG,IAGzByB,IAAI5B,EAAKa,OACDV,EAAU,CACdA,OAAiB,cACjBA,EAAQwB,KAAOP,KAAKC,UAAUR,GACvBW,KAAKtB,IAAIF,EAAKG,IAGzB0B,MAAM7B,EAAKa,OACHV,EAAU,CACdA,OAAiB,gBACjBA,EAAQwB,KAAOP,KAAKC,UAAUR,GACvBW,KAAKtB,IAAIF,EAAKG,IAGzB2B,OAAO9B,EAAKa,OACJV,EAAU,CACdA,OAAiB,iBACjBA,EAAQwB,KAAOP,KAAKC,UAAUR,GACvBW,KAAKtB,IAAIF,EAAKG,KC5F7B,MAAM4B,EAAiB,SAgBR,CACXC,UAdJ,SAAmB/B,EAAMgC,GACrBF,EAAe9B,GAAQgC,GAcvBC,WAVJ,SAAoBjC,UACZ8B,EAAe9B,GACRkC,OAAyBJ,EAAe9B,IAExCkC,0BAA8ClC,EAAO,UCLpEmC,OAAOC,WAAa,WAChBC,EAAIC,iBACJC,KAGG,MAAMC,EAAaC,WAAS,CAC/BC,KAAO,GACPC,OAAS,GACTC,UAAY,GACZC,MAAQ,GACR7C,KAAO,GACP8C,MAAQ,UAAe,GAAIC,OAAS,WAAgB,MAG3CV,EAAM,ICnBZ,MAEHW,mBACSC,OAAS,QACTC,OAAS,QACTC,OAAS,QACTC,KAAO,OACPC,IAAM,QACNC,QAAU,QACVC,UAAY,QACZC,MAAQ,SACRC,UAAW,OACXC,SAAW,GAEHC,OAAOC,KAAKrC,MAEpBsC,SAAQC,IACQ,KAAfA,EAAS,IACXH,OAAOI,eAAexC,KAAMuC,EAASE,UAAU,GAAI,CAC/CrD,IAAK,kBACMY,KAAKuC,IAEhBG,IAAK,SAASC,QACLR,SAASI,EAASE,UAAU,IAAMzC,KAAKuC,QACvCA,GAAYI,aAOxBC,WAAa,MACL,cACD,iBACG,gBACD,gBACC,kBACC,kBACD,cACH,IAIZC,gBACO7C,KAAK/B,MAAQ,IAAM+B,KAAK9B,MAAQ,IAAM8B,KAAK8C,GAGtDC,UAAUC,UACChD,KAAKmC,SAASc,eAAeD,GAGxCE,aACS3B,MAAQ,QACRtD,MAAQ,QACRC,MAAQ,QACR8E,IAAM,OACNF,GAAK,QACLxD,OAAS,QACT3B,SAAW,QACXwE,SAAW,GAGpBgB,oBACShB,SAAW,GAIpBiB,mBACQ5E,EAAMwB,KAAKiC,MAAQjC,KAAKuB,MAAQ,IAAMvB,KAAK/B,MAAQ+B,KAAK4C,WAAW5C,KAAK9B,OACxE8B,KAAKgD,MAAKxE,GAAO,IAAMwB,KAAKgD,KAC5BhD,KAAK8C,KAAItE,GAAO,OAASwB,KAAK8C,QAE9BO,EAAY,OACZ,MAAM7D,KAAKQ,KAAKV,OACa,gBAAlBU,KAAKV,OAAOE,IAA0C,iBAAlBQ,KAAKV,OAAOE,GACvD6D,EAAUC,KAAK9D,EAAI,IAAMI,KAAKC,UAAUG,KAAKV,OAAOE,KAEpD6D,EAAUC,KAAK9D,EAAI,IAAMQ,KAAKV,OAAOE,WAIzC6D,EAAUE,OAAS,IAAG/E,GAAO,IAAM6E,EAAUG,KAAK,MAE/ChF,EAGXuC,eAAe0C,GACNA,IAASA,EAAU,IAAIC,IAAI9C,OAAOH,SAASkD,WAC5CnF,EAAMiF,EAAQG,SAASC,QAAQ7D,KAAK8D,KAAM,OAC9CtF,EAAMA,EAAIqF,QAAQ,aAAc,KAE3BrF,EAAK,WAGNuF,EAAQvF,EAAIwF,MAAM,UACjBzC,MAAQwC,EAAM,GACnBvF,EAAMuF,EAAM,SAENE,EAAQjE,KACdyD,EAAQS,aAAa5B,SAAQ,SAAS6B,EAAOnB,GACzCiB,EAAM3E,OAAO0D,GAAQmB,EAAMrE,QAAQ,MAAQ,EAAKqE,EAAMH,MAAM,KAAOG,KAGvEJ,EAAQvF,EAAIwF,MAAM,QACdD,EAAMR,OAAS,SACVT,GAAKiB,EAAM,GAChBvF,EAAMuF,EAAM,IAIhBA,EAAQvF,EAAIwF,MAAM,SACdhB,EAAMe,EAAMA,EAAMR,OAAS,MACpB,SAAPP,QACKA,IAAMA,EACXe,EAAMK,OACEC,MAAMrB,UACTA,IAAMA,EACXe,EAAMK,OAGU,GAAhBL,EAAMR,aACA,IAAIe,MAAM,kCAAoC9F,QAGnDN,MAAQ,UACT,IAAIsB,KAAKQ,KAAK4C,cACV5C,KAAK4C,WAAWpD,IAAM,IAAMuE,EAAMA,EAAMR,OAAS,GAAI,MAChDrF,MAAQsB,EACbuE,EAAMK,iBAITnG,MAAQ8F,EAAMP,KAAK,KAG5Be,eACW,CACHhD,MAAQvB,KAAKuB,MACbtD,MAAQ+B,KAAK/B,MACbC,MAAQ8B,KAAK9B,MACb8E,IAAMhD,KAAKgD,IACXF,GAAK9C,KAAK8C,GACVxD,OAASU,KAAKV,OACdwE,KAAO9D,KAAK8D,KACZU,QAAUxE,KAAKwE,SAIvBC,MAAMlD,OACE,IAAI/B,KAAK+B,OACJ/B,GAAK+B,EAAM/B,KD7F5B,SAASkF,EAAKzF,UACVgC,EAAWE,KAAO,GAClBF,EAAWG,OAAS,GACpBH,EAAWM,MAAQ,UAAe,GAAIC,OAAS,WAAgB,IAC/DP,EAAWhD,MAAQ,KACZ0G,EAAOvF,IAAI,iBACjBJ,MAAKC,QACE,IAAI2F,KAAO3F,MACP,IAAI4F,KAAc5F,EAAS2F,GAAM,OAC3BrD,EAAQ,CAAEtD,MAAQ4G,EAAY3G,MAAQe,EAAS2F,GAAKC,GAAY3G,OAClEe,EAAS2F,GAAKC,GAAYL,UAASjD,EAAMiD,SAAU,GACvDjD,EAAMA,MAAQsD,EACd5D,EAAWG,OAAOkC,KAAK/B,GAElBN,EAAWE,KAAKyD,KAAM3D,EAAWE,KAAKyD,GAAO,IAClD3D,EAAWE,KAAKyD,GAAKtB,KAAK/B,OAO1C,SAASuD,WACEH,EAAOvF,IAAI,qBAAuB0B,EAAIS,MAAQ,IAAMT,EAAI7C,OAC9De,MAAKC,IACFgC,EAAWM,MAAMwD,SAAW9F,EAAS8F,SACrC9D,EAAWM,MAAMyD,MAAQ/F,EAAS+F,MAClC/D,EAAWM,MAAMC,OAASvC,EAASuC,OACnCP,EAAWK,MAAQrC,EAASqC,MAC5BL,EAAWxC,KAAOQ,EAASR,KACbQ,EAASgG,cAE1BC,OAAMC,GAAKC,QAAQC,IAAIF,KAUrB,SAASG,KAKT,iBACGC,EAAU3E,OAAOH,SAAS+E,SAAW,KAAO5E,OAAOH,SAASgF,KAAQ3E,EAAIsC,eACxE5E,EAAM,IAAIkF,IAAI6B,GACpB3E,OAAO8E,QAAQC,UAAU,MAAUnH,EAAIoF,UAAWgC,SAAStE,MAAO9C,GAPlEqH,GACA7E,IASG,SAASA,QACR8E,EAAW,UACVhF,EAAI7C,MAQE6C,EAAIiC,UAAU,UACvB+C,EAASxC,KAAKoB,KACdoB,EAASxC,KAAKwB,MACLhE,EAAIiC,UAAU,UACrB+C,EAASxC,KAAKwB,KAXdgB,EAASxC,KACLoB,IACC1F,MAAK,KACF8B,EAAI2D,MAtEpB,eACQ,IAAIG,KAAO3D,EAAWE,SAClB,IAAII,KAASN,EAAWE,KAAKyD,MACzBrD,EAAMiD,eACCjD,EAkEGwE,IACHjB,QAUZkB,QAAQC,IAAIH,GAClB9G,MAAK,KACG8B,EAAI7C,MA3GI,OAAb6C,EAAI5C,OAA+B,UAAb4C,EAAI5C,MAC1B+C,EAAWI,UAAY,WACH,WAAbP,EAAI5C,MACX+C,EAAWI,UAAY,cACH,SAAbP,EAAI5C,QACX+C,EAAWI,UAAY,0BA2G1B6D,OAAMC,GAAKC,QAAQC,IAAIF,oDExH5B,SAASzG,IACL,IAAI,IAAIc,KAAK0G,EAAM3E,MACfT,EAAItB,GAAK0G,EAAM3E,MAAM/B,GAEzB8F,2ICpBJ,SAASa,EAAYC,EAAKC,QACX,IAARA,IAAiBA,EAAM,IAC5B,IAAIC,EAAWD,EAAIC,SAEnB,GAAKF,GAA2B,oBAAbR,SAAnB,CAEA,IAAIW,EAAOX,SAASW,MAAQX,SAASY,qBAAqB,QAAQ,GAC9DC,EAAQb,SAASc,cAAc,SACnCD,EAAM3I,KAAO,WAEI,QAAbwI,GACEC,EAAKI,WACPJ,EAAKK,aAAaH,EAAOF,EAAKI,YAKhCJ,EAAKM,YAAYJ,GAGfA,EAAMK,WACRL,EAAMK,WAAWC,QAAUX,EAE3BK,EAAMI,YAAYjB,SAASoB,eAAeZ,q9CCnBvC,MAAMa,EAAO/F,WAAS,CAACgG,MAAO,EAAOC,OAAQ,EAAOC,KAAO,WAE3D,SAASC,IACZC,EAAOpH,KAAK,gBACXlB,MAAK,KJ0FNyB,SAASkD,KAAO7C,EAAIgD,QIlFjB,SAASyD,IACZD,EAAOlI,IAAI,oBACVJ,MAAKC,OACEA,EAASuI,kBACFF,EAAOlH,IAAI,uBACjBpB,MAAK,KACFuI,OAGHN,EAAKC,OACND,EAAKG,KAAOnI,EAASmI,KACrBH,EAAKQ,KAAOxI,EAASwI,KACrBR,EAAKC,MAAO,MAUjBlI,MAAKC,IACa,UAAbgI,EAAKG,MAAkBM,WAAWH,EAzB3B,QA0BZrC,OAAMC,IACL8B,EAAKE,OAAQ,sDC9BrB,MAAMQ,EAAStB,MAAI,WAsBnBuB,WAAUC,whBCHV,MAAMxG,EAAYyG,YAAS,IAClB7G,EAAWI,UACJ0G,wBAAqB,IAAMC,EAAatH,WAAWO,EAAWI,aADxC,2BAO5B,MNJH,iBAEG1D,EAAWY,EAASR,YAAY,iBAClCJ,IACAmD,EAAIgD,KAAO,IAAMnG,EAASmG,KAAKD,QAAQ,aAAc,IACjDlG,EAAS8J,MAKjB3G,EAAIC,iBACGiF,QAAQiC,WMNff,GACClI,MAAK,IACKgC,yvCCxBfuG,weCEe,CACXW,OAfJ,SAAgBC,EAAOC,GACnB7J,EAASX,YAAYwK,SACfC,EAAMC,YAAUC,UACtBF,EAAIF,MAAMA,GACHE,GAYPG,UATJ,SAAmBJ,UACf7J,EAASX,YAAYwK,GACdd"}