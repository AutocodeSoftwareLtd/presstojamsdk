{"version":3,"file":"ptj.min.js","sources":["../presstojam/src/js/settings.js","../presstojam/src/js/client.js","../presstojam/src/js/route.js","../presstojam/src/js/map.js","../presstojam/src/components/ptj-button.vue","../node_modules/style-inject/dist/style-inject.es.js","../presstojam/src/js/user.js","../presstojam/src/components/ptj-slug-trail.vue","../presstojam/src/js/moduleloader.js","../presstojam/src/components/ptj-router.vue","../presstojam/src/components/ptj-user.vue","../import.js"],"sourcesContent":["let settings = {};\r\n\r\nfunction regSettings(isettings, type = null) {\r\n    if (!type) settings = isettings;\r\n    else settings[type] = isettings;\r\n}\r\n\r\n\r\nfunction getSettings(type) {\r\n    return settings[type];\r\n} \r\n\r\n\r\nfunction getModelSettings(model, state) {\r\n    if (settings.models && settings.models[model] && settings.models[model][state]) {\r\n        return settings.models[model][state];\r\n    }\r\n    return {};\r\n}\r\n\r\nexport default {\r\n    regSettings,\r\n    getSettings,\r\n    getModelSettings\r\n}","import Settings from \"./settings.js\"\r\n\r\nlet custom_headers  = {};\r\nlet main_url;\r\n\r\nexport default {\r\n\r\n    initSettings() {\r\n        const settings = Settings.getSettings(\"client\");\r\n        if (!settings.url) {\r\n            throw(\"No URL defined for client\");\r\n        }\r\n        main_url = settings.url;\r\n\r\n        if (settings.custom_headers) {\r\n            for(let name in settings.custom_headers) {\r\n                custom_headers[name] = settings.custom_headers[name];\r\n            }\r\n        }\r\n    },\r\n\r\n    run(url, headers) {\r\n\r\n        if (!main_url) {\r\n            this.initSettings();\r\n        }\r\n        \r\n        headers.mode = 'cors';\r\n        headers.cache = 'no-cache';\r\n        headers.credentials = 'include';\r\n        headers['Content-Type'] = 'application/json';\r\n        headers.headers = custom_headers;\r\n\r\n        const _self = this;\r\n\r\n        return fetch(main_url + url, headers)\r\n        .then(response => {\r\n            if (response.ok) {\r\n                return response.json();\r\n            } else {\r\n                throw response;\r\n            }\r\n        });\r\n    }, \r\n    get(url, data) {\r\n        if (data) {\r\n            const params = new URLSearchParams();\r\n            for(let i in data) {\r\n                if (Array.isArray(data[i]) || (typeof data[i] == 'object' && data[i] !== null)) {\r\n                   params.append(i, JSON.stringify(data[i]));\r\n                } else params.append(i, data[i]);\r\n            }\r\n\r\n            if (url.indexOf(\"?\") == -1) url += \"?\";\r\n            else url += \"&\";\r\n            url += params.toString();\r\n        }\r\n        let headers = {};\r\n        headers.method = 'GET';\r\n        return  this.run(url, headers);\r\n    },\r\n\r\n    getprimary(url, data) {\r\n        return this.get(url, data);\r\n    },\r\n\r\n    post(url, data) {\r\n        //call our fetch response and return\r\n        let headers = {};\r\n        headers.method = 'POST';\r\n        headers.body = JSON.stringify(data);\r\n        return this.run(url, headers);\r\n    },\r\n\r\n    put(url, data) {\r\n        let headers = {};\r\n        headers.method = 'PUT';\r\n        headers.body = JSON.stringify(data);\r\n        return this.run(url, headers);\r\n    },\r\n\r\n    patch(url, data) {\r\n        let headers = {};\r\n        headers.method = 'PATCH';\r\n        headers.body = JSON.stringify(data);\r\n        return this.run(url, headers);\r\n    },\r\n\r\n    delete(url, data) {\r\n        let headers = {};\r\n        headers.method = 'DELETE';\r\n        headers.body = JSON.stringify(data);\r\n        return this.run(url, headers);\r\n    }\r\n}\r\n","import { reactive, defineAsyncComponent } from \"vue\"\r\nimport client from \"./client.js\"\r\nimport Settings from \"./settings.js\"\r\nimport { MapModel } from \"./map.js\"\r\nimport { setDictionary } from \"./dictionary.js\"\r\n\r\nwindow.onpopstate = function() {\r\n    Map.convertFromURL();\r\n    runRoute();\r\n}\r\n\r\nexport const RouteStore = reactive({ \r\n    cats : {}, \r\n    routes : [], \r\n    component : '', \r\n    title : '',\r\n    name : '',\r\n    route : { \"children\" : [], parent : null, \"perms\" : []}, \r\n});\r\n\r\nexport const Map = new MapModel();\r\n\r\nfunction setComponent() {\r\n    if (Map.state == \"get\" || Map.state == \"parent\") {\r\n        RouteStore.component = \"ptj-repo\";\r\n    } else if (Map.state == \"primary\") {\r\n        RouteStore.component = \"ptj-primary\";\r\n    } else if (Map.state == \"login\") {\r\n        RouteStore.component = \"ptj-account-handler\";\r\n    }\r\n}\r\n\r\n\r\nexport function init() {\r\n    let role = \"\";\r\n    const settings = Settings.getSettings(\"mapper\");\r\n    if (settings) {\r\n        Map.base = \"/\" + settings.base.replace(/^\\/+|\\/+$/g, '');\r\n        if (settings.role) {\r\n            role = settings.role;\r\n        }\r\n    }\r\n\r\n    Map.convertFromURL();\r\n    return Promise.resolve();\r\n}\r\n\r\nfunction getDefault() {\r\n    for(let cat in RouteStore.cats) {\r\n        for(let route of RouteStore.cats[cat]) {\r\n            if (route.default) {\r\n                return route;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\nfunction load(response) {\r\n    RouteStore.cats = {};\r\n    RouteStore.routes = [];\r\n    RouteStore.route = { \"children\" : [], parent : null, \"perms\" : []};\r\n    RouteStore.model = null;\r\n    return client.get(\"/nav/site-map\")\r\n    .then(response => {\r\n        for(let cat in response) {\r\n            for(let route_name in response[cat]) {\r\n                const route = { model : route_name, state : response[cat][route_name].state };\r\n                if (response[cat][route_name].default) route.default = true;\r\n                route.route = route_name;\r\n                RouteStore.routes.push(route);\r\n\r\n                if (!RouteStore.cats[cat]) RouteStore.cats[cat] = [];\r\n                RouteStore.cats[cat].push(route);\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\n\r\nfunction loadRoute() {\r\n    return client.get(\"/nav/route-points/\" + Map.route + \"/\" + Map.model)\r\n    .then(response => {   \r\n        RouteStore.route.children = response.children;\r\n        RouteStore.route.perms = response.perms;\r\n        RouteStore.route.parent = response.parent;\r\n        RouteStore.title = response.title;\r\n        RouteStore.name = response.name;\r\n        setDictionary(response.dictionary);\r\n    })\r\n    .catch(e => console.log(e));\r\n}\r\n\r\n\r\n\r\n\r\nexport function refresh() {\r\n    location.href = Map.base;\r\n}\r\n\r\nexport function redirect() {\r\n    addToHistory();\r\n    runRoute();\r\n}\r\n\r\nexport function addToHistory() {\r\n    const url_str = window.location.protocol + \"//\" + window.location.host +  Map.convertToURL();\r\n    const url = new URL(url_str);\r\n    window.history.pushState({'name' : url.pathname}, document.title, url);\r\n}\r\n\r\nexport function runRoute() {\r\n    let promises = [];\r\n    if (!Map.model) {\r\n        promises.push(\r\n            load()\r\n            .then(() => {\r\n                Map.apply(getDefault());\r\n                return loadRoute();\r\n            })\r\n        );\r\n    } else if (Map.hasChange(\"route\")) {\r\n      promises.push(load());\r\n      promises.push(loadRoute());\r\n    } else if (Map.hasChange(\"model\")) {\r\n        promises.push(loadRoute());\r\n    }\r\n\r\n    return Promise.all(promises)\r\n    .then(() => {\r\n        if (!Map.model) {\r\n            \r\n        }\r\n        setComponent();\r\n    })\r\n    .catch(e => console.log(e));\r\n}\r\n","import { computed, reactive } from \"vue\"\r\n\r\nexport class MapModel {\r\n\r\n    constructor() {\r\n        this._route = '';\r\n        this._model = '';\r\n        this._state = '';\r\n        this._key = 0;\r\n        this._to = '';\r\n        this._params = {};\r\n        this._settings = {};\r\n        this._base = \"/\";\r\n        this._default = false;\r\n        this._changes = {};\r\n\r\n        const keys = Object.keys(this);\r\n\r\n        keys.forEach(property => {\r\n          if (property[0] == \"_\") {\r\n            Object.defineProperty(this, property.substring(1), {\r\n                get: function() { \r\n                    return this[property];\r\n                },\r\n                set: function(newValue) {\r\n                    this._changes[property.substring(1)] = this[property];\r\n                    this[property] = newValue;\r\n                }\r\n            });\r\n          } \r\n        });\r\n\r\n\r\n        this.action_map = {\r\n            'post' : '-create',\r\n            'put' : '-update',\r\n            'delete' : '-delete',\r\n            'login' : '-login',\r\n            'logout' : '-logout',\r\n            'primary' : '-primary',\r\n            'parent' : '-parent',\r\n            'get' : ''\r\n        };\r\n    }\r\n\r\n    get id() {\r\n        return this.model + \"-\" + this.state + \"-\" + this.to;\r\n    }\r\n\r\n    hasChange(key) {\r\n        return this._changes.hasOwnProperty(key);\r\n    }\r\n\r\n    reset() {\r\n        this.route = '';\r\n        this.model = '';\r\n        this.state = '';\r\n        this.key = 0;\r\n        this.to = '';\r\n        this.params = {};\r\n        this.settings = {};\r\n        this._changes = {};\r\n    }\r\n\r\n    resetChanges() {\r\n        this._changes = {};\r\n    }\r\n\r\n\r\n    convertToURL() {\r\n        let url = this._base + this.route + \"/\" + this.model + this.action_map[this.state];\r\n        if (this.key) url += \"-\" + this.key;\r\n        if (this.to) url += \"-to-\" + this.to;\r\n\r\n        let param_str = [];\r\n        for(const i in this.params) {\r\n            if (typeof this.params[i] == 'Array' || typeof this.params[i] == 'Object') {\r\n                param_str.push(i + \"=\" + JSON.stringify(this.params[i]));\r\n            } else {\r\n                param_str.push(i + \"=\" + this.params[i]);\r\n            }\r\n        }\r\n\r\n        if (param_str.length > 0) url += \"?\" + param_str.join(\"&\");\r\n\r\n        return url;\r\n    }\r\n    \r\n    convertFromURL(url_obj) {\r\n        if (!url_obj) url_obj = new URL(window.location.href);\r\n        let url = url_obj.pathname.replace(this.base, \"\");\r\n        url = url.replace(/^\\/+|\\/+$/g, '');\r\n\r\n        if (!url) return;\r\n\r\n\r\n        let parts = url.split(\"/\");\r\n        this.route = parts[0];\r\n        url = parts[1];\r\n\r\n        const _self = this;\r\n        url_obj.searchParams.forEach(function(value, key) {\r\n            _self.params[key] = (value.indexOf(\",\") > -1) ? value.split(\",\") : value;\r\n        });\r\n\r\n        parts = url.split(\"-to-\");\r\n        if (parts.length > 1) {\r\n            this.to = parts[1];\r\n            url = parts[0];\r\n        }\r\n\r\n       \r\n        parts = url.split(\"-\");\r\n        let key = parts[parts.length - 1];\r\n        if (key == \"first\") {\r\n            this.key = key;\r\n            parts.pop();\r\n        } else if (!isNaN(key)) {\r\n            this.key = key;\r\n            parts.pop();\r\n        }\r\n            \r\n        if (parts.length == 0) {\r\n            throw new Error(\"Can't convert this url string: \" + url);\r\n        }\r\n    \r\n        this.state = \"get\";\r\n        for(let i in this.action_map) {\r\n            if (this.action_map[i] == \"-\" + parts[parts.length - 1]) {\r\n                this.state = i\r\n                parts.pop();\r\n                break;\r\n            }\r\n        }\r\n        this.model = parts.join(\"-\");\r\n    }\r\n\r\n    getAll() {\r\n        return {\r\n            route : this.route,\r\n            model : this.model,\r\n            state : this.state,\r\n            key : this.key,\r\n            to : this.to,\r\n            params : this.params,\r\n            base : this.base,\r\n            default : this.default\r\n        };\r\n    }\r\n\r\n    apply(route) {\r\n        for(let i in route) {\r\n            this[i] = route[i];\r\n        }\r\n    }\r\n}\r\n\r\n","<template>\r\n  <a class=\"ptj-button\" :key=\"route\" @click=\"run\">\r\n    <slot />\r\n  </a> \r\n</template>\r\n\r\n<script setup>\r\n\r\n\r\nimport { redirect, Map } from \"./../js/route.js\"\r\n\r\nconst props = defineProps({\r\n    route : Object\r\n});\r\n\r\n\r\nfunction run() {\r\n    for(let i in props.route) {\r\n        Map[i] = props.route[i];\r\n    }\r\n    redirect();\r\n}\r\n\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\n</style>","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import { reactive } from \"vue\"\r\nimport { refresh } from \"./route.js\"\r\nimport Client from \"./client.js\"\r\n\r\nexport const User = reactive({init : false, login : false, user : \"public\" });\r\n\r\nexport function logout() {\r\n    Client.post(\"/core/logout\")\r\n    .then(() => {\r\n        refresh();\r\n    });\r\n}\r\n\r\n\r\nconst user_check = 600000;\r\n\r\nexport function checkLoginStatus() {\r\n    Client.get(\"/core/check-user\")\r\n    .then(response => {\r\n        if (response.is_expired) {\r\n            return Client.put(\"/core/switch-tokens\")\r\n            .then(() => {\r\n                checkLoginStatus();\r\n            });\r\n        }\r\n        if (!User.init) {\r\n            User.user = response.user;\r\n            User.role = response.role;\r\n            User.init = true;\r\n            /*if (user.user != \"public\") {\r\n                return Client.post(\"/route/\" + user.user + \"/\" + user.user + \"/login\")\r\n                .then(response => {\r\n                    let meta = new MetaRow();\r\n                    meta.map(response.fields);\r\n                    register_data.applyMetaRow(meta);\r\n                });\r\n            }*/\r\n        }\r\n    }).then(response => {\r\n        if (User.user != \"public\") setTimeout(checkLoginStatus, user_check);\r\n    }).catch(e => {\r\n        User.login = true;\r\n    });\r\n}\r\n\r\n","<template>\r\n    <div class=\"ptj-slug-trail\">\r\n        <ptj-button v-for=\"trail in trails\" :key=\"trail.id\" :route=\"trail.route\">{{ trail.value }}</ptj-button>\r\n    </div>\r\n</template>\r\n<script setup>\r\nimport PtjButton from \"./ptj-button.vue\"\r\nimport { ref } from \"vue\"\r\nimport client from \"./../js/client.js\"\r\nimport { Map } from \"./../js/route.js\"\r\n\r\nconst trails = ref([]);\r\n\r\nconst init = async() => {\r\n    trails.value.splice(0);\r\n    return client.get(\"/slug/\" + Map.route + \"/\" + Map.model + \"/\" + Map.key)\r\n    .then(response => {\r\n        for(let i in response) {\r\n            let values = [];\r\n            for(let x in response[[i]]) {\r\n                if (x == \"--id\") {\r\n                    continue;\r\n                }\r\n                values.push(response[i][x]);\r\n            }\r\n            trails.value.push({\r\n                id : response[i][\"--parentid\"],\r\n                model : response[i].model\r\n            });\r\n        }\r\n    });\r\n}\r\n\r\nonMounted(async () => {\r\n   // await init();\r\n});\r\n\r\n</script>","const path = require('path');\r\n\r\nconst module_address = {\r\n}\r\n\r\nfunction addModule(name, location) {\r\n    module_address[name] = location;\r\n}\r\n\r\n\r\nfunction loadModule(name) {\r\n    if (module_address[name]) {\r\n        return import(/* @vite-ignore */module_address[name]);\r\n    } else {\r\n        return import(/* @vite-ignore */path.resolve(__dirname, \"/../components/\" + name + \".vue\"));\r\n    }\r\n}\r\n\r\nexport default {\r\n    addModule,\r\n    loadModule\r\n}","<template>\r\n    <div class=\"ptj-nav\">\r\n        <div v-for=\"(routes, title) in RouteStore.cats\" :key=\"title\">\r\n            <span v-if=\"routes.length > 1\">{{ title }}</span>\r\n            <ptj-button v-for=\"(route) in routes\" :route=\"{ 'route' : route.route, 'model' : route.model, 'state':route.state, 'key' : 0}\" :key=\"route.route\">{{ route.route }}</ptj-button>\r\n        </div>\r\n    </div>\r\n    <ptj-slug-trail />\r\n    <Suspense>\r\n        <template #default>\r\n            <div :class=\"[Map.model, Map.state]\">\r\n            <ptj-button v-if=\"RouteStore.back\" :route=\"RouteStore.back\"><span class=\"material-icons\">back</span></ptj-button>\r\n            <h1>{{ RouteStore.title }}</h1>\r\n            <component v-if=\"component\" :is=\"component\" />\r\n            </div>\r\n        </template>\r\n        <template #fallback>\r\n            <div>Loading ...</div>\r\n        </template>\r\n    </Suspense>\r\n</template>\r\n<script setup>\r\n\r\nimport { computed, defineAsyncComponent, onMounted } from \"vue\"\r\nimport PtjButton from \"./ptj-button.vue\"\r\nimport PtjSlugTrail from \"./ptj-slug-trail.vue\"\r\nimport { init, RouteStore, runRoute } from \"./../js/route.js\"\r\nimport ModuleLoader from \"./../js/moduleloader.js\"\r\n\r\n\r\nconst component = computed(() => {\r\n    if (!RouteStore.component) return null;\r\n    else return defineAsyncComponent(() => ModuleLoader.loadModule(RouteStore.component));\r\n});\r\n\r\n\r\n\r\n\r\nonMounted(() => {\r\n    init()\r\n    .then(() => {\r\n        return runRoute();\r\n    });\r\n});\r\n\r\n</script>","<template>\r\n    <Teleport to=\"#ptj-accountdetails\">\r\n    <a v-if=\"User.user != 'public'\" class=\"ptj-account-details-logout\" @click=\"logout\">Logout</a>\r\n    </Teleport>\r\n    <ptj-router />\r\n    <ptj-modal :active=\"User.login\">\r\n        \r\n    </ptj-modal>\r\n</template>\r\n<script setup>\r\n\r\nimport PtjModal from \"./ptj-modal.vue\"\r\nimport PtjString from \"./ptj-string.vue\"\r\nimport { User, checkLoginStatus, logout } from \"./../js/user.js\"\r\nimport PtjRouter from \"./ptj-router.vue\"\r\n\r\n\r\ncheckLoginStatus();\r\n\r\n/*\r\n<form @submit.prevent=\"submit\" class=\"ptj-login\">\r\n            <ptj-form-row v-for=\"field in login_data.cells\" :key=\"field.meta.name\" :field=\"field\">\r\n                <ptj-string type=\"edit\" :field=\"field\" />\r\n            </ptj-form-row>\r\n            <input type=\"submit\" value=\"Login\" class=\"ptj-form-submit\" @click=\"submit\">\r\n        </form>\r\n*/\r\n\r\n</script>","import PTJUser from \"./presstojam/src/components/ptj-user.vue\"\r\nimport Settings from \"./presstojam/src/js/settings.js\"\r\nimport Client from \"./presstojam/src/js/client.js\"\r\nimport { createApp } from \"vue\"\r\n\r\nfunction runApp(mount, user_settings) {\r\n    Settings.regSettings(user_settings);\r\n    const app = createApp(PTJUser);\r\n    app.mount(mount);\r\n    return app;\r\n}\r\n\r\n\r\nfunction getClient(user_settings) {\r\n    Settings.regSettings(user_settings);\r\n    return Client;\r\n}\r\n\r\n\r\n\r\nexport default { \r\n    runApp,\r\n    getClient\r\n}\r\n\r\n\r\n"],"names":["settings","regSettings","isettings","type","getSettings","getModelSettings","model","state","models","main_url","custom_headers","initSettings","Settings","url","name","run","headers","mode","cache","credentials","fetch","then","response","ok","json","get","data","params","URLSearchParams","i","Array","isArray","append","JSON","stringify","indexOf","toString","this","getprimary","post","body","put","patch","delete","window","onpopstate","Map","convertFromURL","runRoute","RouteStore","reactive","cats","routes","component","title","route","parent","constructor","_route","_model","_state","_key","_to","_params","_settings","_base","_default","_changes","Object","keys","forEach","property","defineProperty","substring","set","newValue","action_map","id","to","hasChange","key","hasOwnProperty","reset","resetChanges","convertToURL","param_str","push","length","join","url_obj","URL","location","href","pathname","replace","base","parts","split","_self","searchParams","value","pop","isNaN","Error","getAll","default","apply","load","client","cat","route_name","loadRoute","children","perms","dictionary","catch","e","console","log","redirect","url_str","protocol","host","history","pushState","document","addToHistory","promises","getDefault","Promise","all","props","styleInject","css","ref","insertAt","head","getElementsByTagName","style","createElement","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","User","init","login","user","logout","Client","checkLoginStatus","is_expired","role","setTimeout","trails","onMounted","async","path","require","module_address","addModule","loadModule","import","resolve","__dirname","computed","defineAsyncComponent","ModuleLoader","runApp","mount","user_settings","app","createApp","PTJUser","getClient"],"mappings":"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"}