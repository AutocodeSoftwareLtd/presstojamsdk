!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("vue")):"function"==typeof define&&define.amd?define(["vue"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).ptj=t(e.Vue)}(this,(function(e){"use strict";const t={class:"ptj-modal-backdrop"},l={class:"ptj-modal"};var r={props:{active:{required:!0}},setup:r=>(n,o)=>e.withDirectives((e.openBlock(),e.createElementBlock("div",t,[e.createElementVNode("div",l,[e.createElementVNode("header",null,[e.createElementVNode("button",{type:"button",class:"btn-close",onClick:o[0]||(o[0]=e=>{n.$emit("close")})}," x ")]),e.renderSlot(n.$slots,"default")])],512)),[[e.vShow,r.active]]),__file:"presstojam/src/components/ptj-modal.vue"};let n={};var o={regSettings:function(e,t=null){t?n[t]=e:n=e},getSettings:function(e){return n[e]},getModelSettings:function(e,t){return n.models&&n.models[e]&&n.models[e][t]?n.models[e][t]:{}}};let a,i={};var s={initSettings(){const e=o.getSettings("client");if(!e.url)throw"No URL defined for client";if(a=e.url,e.custom_headers)for(let t in e.custom_headers)i[t]=e.custom_headers[t]},run(e,t){return a||this.initSettings(),t.mode="cors",t.cache="no-cache",t.credentials="include",t["Content-Type"]="application/json",t.headers=i,fetch(a+e,t).then((e=>{if(e.ok)return e.json();throw e}))},get(e,t){if(t){const l=new URLSearchParams;for(let e in t)Array.isArray(t[e])||"object"==typeof t[e]&&null!==t[e]?l.append(e,JSON.stringify(t[e])):l.append(e,t[e]);-1==e.indexOf("?")?e+="?":e+="&",e+=l.toString()}let l={method:"GET"};return this.run(e,l)},getprimary(e,t){return this.get(e,t)},post(e,t){let l={method:"POST"};return l.body=JSON.stringify(t),this.run(e,l)},put(e,t){let l={method:"PUT"};return l.body=JSON.stringify(t),this.run(e,l)},patch(e,t){let l={method:"PATCH"};return l.body=JSON.stringify(t),this.run(e,l)},delete(e,t){let l={method:"DELETE"};return l.body=JSON.stringify(t),this.run(e,l)}};let c={};function d(e,t,l){if(!c.fields[e])return l;const r=c.fields[e];return r[t]?r[t]:l}window.onpopstate=function(){u.convertFromURL(),k()};const p=e.reactive({cats:{},routes:[],component:"",title:"",name:"",route:{children:[],parent:null,perms:[]}}),u=new class{constructor(){this._route="",this._model="",this._state="",this._key=0,this._to="",this._params={},this._settings={},this._base="/",this._default=!1,this._changes={};Object.keys(this).forEach((e=>{"_"==e[0]&&Object.defineProperty(this,e.substring(1),{get:function(){return this[e]},set:function(t){this._changes[e.substring(1)]=this[e],this[e]=t}})})),this.action_map={post:"-create",put:"-update",delete:"-delete",login:"-login",logout:"-logout",primary:"-primary",parent:"-parent",get:""}}get id(){return this.model+"-"+this.state+"-"+this.to}hasChange(e){return this._changes.hasOwnProperty(e)}reset(){this.route="",this.model="",this.state="",this.key=0,this.to="",this.params={},this.settings={},this._changes={}}resetChanges(){this._changes={}}convertToURL(){let e=this._base+this.route+"/"+this.model+this.action_map[this.state];this.key&&(e+="-"+this.key),this.to&&(e+="-to-"+this.to);let t=[];for(const e in this.params)"Array"==typeof this.params[e]||"Object"==typeof this.params[e]?t.push(e+"="+JSON.stringify(this.params[e])):t.push(e+"="+this.params[e]);return t.length>0&&(e+="?"+t.join("&")),e}convertFromURL(e){e||(e=new URL(window.location.href));let t=e.pathname.replace(this.base,"");if(t=t.replace(/^\/+|\/+$/g,""),!t)return;let l=t.split("/");this.route=l[0],t=l[1];const r=this;e.searchParams.forEach((function(e,t){r.params[t]=e.indexOf(",")>-1?e.split(","):e})),l=t.split("-to-"),l.length>1&&(this.to=l[1],t=l[0]),l=t.split("-");let n=l[l.length-1];if("first"==n?(this.key=n,l.pop()):isNaN(n)||(this.key=n,l.pop()),0==l.length)throw new Error("Can't convert this url string: "+t);this.state="get";for(let e in this.action_map)if(this.action_map[e]=="-"+l[l.length-1]){this.state=e,l.pop();break}this.model=l.join("-")}getAll(){return{route:this.route,model:this.model,state:this.state,key:this.key,to:this.to,params:this.params,base:this.base,default:this.default}}apply(e){for(let t in e)this[t]=e[t]}};function m(e){return p.cats={},p.routes=[],p.route={children:[],parent:null,perms:[]},p.model=null,s.get("/nav/site-map").then((e=>{for(let t in e)for(let l in e[t]){const r={model:l,state:e[t][l].state};e[t][l].default&&(r.default=!0),r.route=l,p.routes.push(r),p.cats[t]||(p.cats[t]=[]),p.cats[t].push(r)}}))}function h(){return s.get("/nav/route-points/"+u.route+"/"+u.model).then((e=>{var t;p.route.children=e.children,p.route.perms=e.perms,p.route.parent=e.parent,p.title=e.title,p.name=e.name,t=e.dictionary,c=t})).catch((e=>console.log(e)))}function f(){location.href=u.base}function g(){_(),k()}function _(){const e=window.location.protocol+"//"+window.location.host+u.convertToURL(),t=new URL(e);window.history.pushState({name:t.pathname},document.title,t)}function k(){let e=[];return u.model?u.hasChange("route")?(e.push(m()),e.push(h())):u.hasChange("model")&&e.push(h()):e.push(m().then((()=>(u.apply(function(){for(let e in p.cats)for(let t of p.cats[e])if(t.default)return t}()),h())))),Promise.all(e).then((()=>{u.model,"get"==u.state||"parent"==u.state?p.component="ptj-repo":"primary"==u.state?p.component="ptj-primary":"login"==u.state&&(p.component="ptj-account-handler")})).catch((e=>console.log(e)))}var y={props:{route:Object},setup(t){const l=t;function r(){for(let e in l.route)u[e]=l.route[e];g()}return(l,n)=>(e.openBlock(),e.createElementBlock("a",{class:"ptj-button",key:t.route,onClick:r},[e.renderSlot(l.$slots,"default")]))},__file:"presstojam/src/components/ptj-button.vue"};const v={class:"ptj-multiple-select"},B={class:"ptj-multiple-select-display"},b={class:"ptj-multiple-select-values"},w=["onClick"],E=[(t=>(e.pushScopeId("data-v-51b18f4e"),t=t(),e.popScopeId(),t))((()=>e.createElementVNode("span",{class:"material-icons"},"close",-1)))];var j={props:{field:Object},setup(t){const l=t,r=e.ref("");function n(){l.field.change1=r.value,r.value=""}return(o,a)=>(e.openBlock(),e.createElementBlock("div",v,[e.createElementVNode("div",B,[e.createElementVNode("div",b,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.field.change1,(t=>(e.openBlock(),e.createElementBlock("div",{class:"ptj-multiple-select-val",key:t},[e.createTextVNode(e.toDisplayString(t)+" ",1),e.createElementVNode("a",{class:"ptj-multiple-select-val-remove",onClick:e=>{return r=t,void(l.field.change=l.field.change.filter((function(e){return e!==r})));var r}},E,8,w)])))),128))]),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>r.value=e)},null,512),[[e.vModelText,r.value]]),e.createElementVNode("a",{onClick:n},"add")])]))}};function V(e,t){void 0===t&&(t={});var l=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===l&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}}V("\n.ptj-multiple-select-val[data-v-51b18f4e] {\r\n    display : inline-block;\r\n    border : 1px solid green;\r\n    margin-left : 2px;\r\n    margin-right : 2px;\r\n    padding : 2px;\r\n    background-color : green;\n}\n.ptj-multiple-select-val-remove[data-v-51b18f4e] {\r\n    color : red;\n}\n.ptj-multiple-select-display[data-v-51b18f4e] {\r\n    position :relative;\r\n    background-color : #fff;\r\n    border : 1px solid #cdcdcd;\r\n    min-height : 35px;\n}\r\n\r\n"),j.__scopeId="data-v-51b18f4e",j.__file="presstojam/src/components/ptj-multiple-input.vue";const N={class:"ptj-multiple-select"},S={class:"ptj-multiple-select-display"},x={class:"ptj-multiple-select-values"},C=["onClick"],D=[(t=>(e.pushScopeId("data-v-5b05457d"),t=t(),e.popScopeId(),t))((()=>e.createElementVNode("span",{class:"material-icons"},"close",-1)))],O={class:"material-icons"},M=["data-key"];var P={props:{field:Object},setup(t){const l=t;e.onMounted((()=>{if(l.field.reference){let e="/reference/"+u.model+"/"+l.field.name;l.field.setReferenceOptions(e,{"--parentid":u.key})}}));const r=e.reactive({display:!1,symbol:"keyboard_arrow_down"});function n(){r.display?(r.display=!1,r.symbol="keyboard_arrow_down"):(r.display=!0,r.symbol="keyboard_arrow_up")}function o(e){l.field.change1=e.target.getAttribute("data-key"),n()}return(a,i)=>(e.openBlock(),e.createElementBlock("div",N,[e.createElementVNode("div",S,[e.createElementVNode("div",x,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.field.change,(r=>(e.openBlock(),e.createElementBlock("div",{class:"ptj-multiple-select-val",key:r},[e.createTextVNode(e.toDisplayString(t.field.getOption(r))+" ",1),e.createElementVNode("a",{class:"ptj-multiple-select-val-remove",onClick:e=>{return t=r,void(l.field.change=l.field.change.filter((function(e){return e!==t})));var t}},D,8,C)])))),128))]),e.createElementVNode("a",{class:"ptj-multiple-select-arrow",onClick:n},[e.createElementVNode("span",O,e.toDisplayString(e.unref(r).symbol),1)])]),e.withDirectives(e.createElementVNode("ul",{class:"ptj-multiple-select-options",onClick:o},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.field.options,(t=>(e.openBlock(),e.createElementBlock("li",{key:t.key,"data-key":t.key},e.toDisplayString(t.value),9,M)))),128))],512),[[e.vShow,e.unref(r).display]])]))}};V("\n.ptj-multiple-select-val[data-v-5b05457d] {\r\n    display : inline-block;\r\n    border : 1px solid green;\r\n    margin-left : 2px;\r\n    margin-right : 2px;\r\n    padding : 2px;\r\n    background-color : green;\n}\n.ptj-multiple-select-val-remove[data-v-5b05457d] {\r\n    color : red;\n}\n.ptj-multiple-select-arrow[data-v-5b05457d] {\r\n    position :absolute;\r\n    right : 2px;\r\n    top : 3px;\n}\n.ptj-multiple-select-display[data-v-5b05457d] {\r\n    position :relative;\r\n    background-color : #fff;\r\n    border : 1px solid #cdcdcd;\r\n    min-height : 35px;\n}\n.ptj-multiple-select-options li[data-v-5b05457d] {\r\n    list-style: none;\r\n    cursor: pointer;\r\n    margin-top : 2px;\r\n    border : 1px solid #cdcdcd;\r\n    background-color : #fff;\n}\n.ptj-multiple-select-options li[data-v-5b05457d]:hover {\r\n    background-color : #f9f9fb;\r\n    transition : background-color .2s ease-out,border .2s ease-out;\n}\r\n"),P.__scopeId="data-v-5b05457d",P.__file="presstojam/src/components/ptj-multiple-select.vue";const T=["name"],L={key:1},A=["name"],F=e.createElementVNode("option",{value:"",selected:"",disabled:""},"Select Option",-1),U=["value"],I=["name"],R={key:6},z={key:7};var $={props:{field:{type:Object,required:!0},type:{type:String,default:"view"}},setup(t){const l=t;let r=e.computed((()=>"edit"==l.type&&l.field.immutable?"view":l.type));const n=e.computed((()=>function(e){if(0==e.length)return null;let t=[];const l=new RegExp(/^[a-zA-Z]+[a-zA-Z0-9._]+$/);for(let r of e)if(r){if(!l.test(r))return null;t.push(r)}return t}(l.field.contains)?"select":l.field.encrypted?"input":l.field.html||l.field.max>300?"textarea":"input")),o=e.computed((()=>{let e=[];for(let t of l.field.contains)e.push({key:t,value:t});return e})),a=e.computed((()=>{let e={};return l.field.encrypted&&(e.type="password"),l.field.atts.readonly&&(e.readonly=!0),l.field.atts.placeholder&&(e.placeholder=field.meta.placeholder),l.field.atts.html&&(e["data-html"]=1),e}));return(l,i)=>"textarea"==e.unref(n)&&"edit"==e.unref(r)?e.withDirectives((e.openBlock(),e.createElementBlock("textarea",e.mergeProps({key:0},e.unref(a),{name:t.field.name,"onUpdate:modelValue":i[0]||(i[0]=e=>t.field.change=e)}),null,16,T)),[[e.vModelText,t.field.change]]):"textarea"==e.unref(n)&&"view"==e.unref(r)?(e.openBlock(),e.createElementBlock("div",L,e.toDisplayString(t.field.val),1)):"select"==e.unref(n)&&"filter"==e.unref(r)?(e.openBlock(),e.createBlock(P,{key:2,field:t.field},null,8,["field"])):"select"==e.unref(n)&&"edit"==e.unref(r)?e.withDirectives((e.openBlock(),e.createElementBlock("select",e.mergeProps({key:3,"onUpdate:modelValue":i[1]||(i[1]=e=>t.field.change=e),name:t.field.name},e.unref(a),{onBlur:i[2]||(i[2]=e=>t.field.validateon=!0)}),[F,(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(t=>(e.openBlock(),e.createElementBlock("option",{key:t.key,value:t.key},e.toDisplayString(t.value),9,U)))),128))],16,A)),[[e.vModelSelect,t.field.change]]):"edit"==e.unref(r)?e.withDirectives((e.openBlock(),e.createElementBlock("input",e.mergeProps({key:4},e.unref(a),{name:t.field.name,"onUpdate:modelValue":i[3]||(i[3]=e=>t.field.change=e),onBlur:i[4]||(i[4]=e=>t.field.validateon=!0)}),null,16,I)),[[e.vModelDynamic,t.field.change]]):"filter"==e.unref(r)?(e.openBlock(),e.createBlock(j,{key:5,field:t.field},null,8,["field"])):"view"==e.unref(r)&&t.field.reference?(e.openBlock(),e.createElementBlock("span",R,[e.createVNode(y,{route:{model:t.field.reference,key:t.field.val,state:"primary"}},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(t.field.val),1)])),_:1},8,["route"])])):(e.openBlock(),e.createElementBlock("span",z,e.toDisplayString(t.field.val),1))},__file:"presstojam/src/components/ptj-string.vue"};const J=e.reactive({init:!1,login:!1,user:"public"});function q(){s.post("/core/logout").then((()=>{f()}))}function X(){s.get("/core/check-user").then((e=>{if(e.is_expired)return s.put("/core/switch-tokens").then((()=>{X()}));J.init||(J.user=e.user,J.role=e.role,J.init=!0)})).then((e=>{"public"!=J.user&&setTimeout(X,6e5)})).catch((e=>{J.login=!0}))}const Y={class:"ptj-slug-trail"};var H={setup(t){const l=e.ref([]);return e.onMounted((async()=>{})),(t,r)=>(e.openBlock(),e.createElementBlock("div",Y,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.value,(t=>(e.openBlock(),e.createBlock(y,{key:t.id,route:t.route},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(t.value),1)])),_:2},1032,["route"])))),128))]))},__file:"presstojam/src/components/ptj-slug-trail.vue"};class K{constructor(e={}){this._handle=e.handle,this._drop_target=e.drop_target,this._drag_target=e.drag_target,this._call_back=e.callback,this._x=0,this._y=0,this._offset_x=0,this._offset_y=0,this._judder=e.judder?e.judder:5,this._drag_node,this._drop_node,this._tree=e.tree}isJudder(e,t){const l=e-this._x,r=t-this._y;return!(l<-5||l>5)&&!(r<-5||r>5)}getDirection(e,t){return{x:e==this._x?0:e>this._x?1:-1,y:t==this._y?0:t>this._y?1:-1}}offset(e){var t=e.getBoundingClientRect(),l=e.ownerDocument.defaultView;return{top:t.top+l.pageYOffset,left:t.left+l.pageXOffset}}insertAfter(){let e=this._drag_node.getAttribute("id"),t=this._drop_node.getAttribute("id"),l=0,r=0;if(this._drop_node.nextElementSibling){for(let e in this._tree){let n=this._tree[e];if(n.id==t){l=n.circular,r=n.sort;break}}for(let t in this._tree){let n=this._tree[t];n.id==e?(n.circular=l,n.sort=r+1):n.circular==l&&n.sort>r&&++n.sort}}else for(let t in this._tree){let r=this._tree[t];r.id==e&&(r.circular=l,r.sort=0)}}insertBefore(){let e=this._drag_node.getAttribute("id"),t=this._drop_node.getAttribute("id"),l=0,r=0;for(let e in this._tree){let n=this._tree[e];if(n.id==t){l=n.circular,r=n.sort,++n.sort;break}}for(let t in this._tree){let n=this._tree[t];n.id==e?(n.circular=l,n.sort=r):n.circular==l&&n.sort>r&&++n.sort}}dragStart(e){const t=e.target.closest("[id]");this._drag_node=t;const{top:l,left:r}=this.offset(t);e.dataTransfer.dropEffect="move",this._x=e.clientX,this._y=e.clientY,this._offset_x=e.clientX-r,this._offset_y=e.clientY-l}isDroppable(e){return!!e.target.closest(this._drop_target)}dragEnter(e){if(!this.isDroppable(e))return!0;if(e.preventDefault(),e.dataTransfer.dropEffect="move",this._drop_node=e.target.closest(this._drag_target),!this._drop_node||this._drop_node.getAttribute("id")==this._drag_node.getAttribute("id"))return;const t=this.getDirection(e.clientX,e.clientY);1==t.y?this.insertAfter():-1==t.y&&this.insertBefore(),this._x=e.clientX,this._y=e.clientY}dragOver(e){if(!this.isDroppable(e))return!0;e.preventDefault(),e.dataTransfer.dropEffect="move"}dragEnd(){this._drag_node&&this._drag_node.setAttribute("draggable",!1),this._drag_node=null}drop(e){if(!this._drop_node)return!0;e.preventDefault(),this._call_back&&this._call_back(this._tree)}}var W={initDD:function(e){let t=new K(e);if(document.querySelectorAll(e.handle).forEach((e=>e.addAttribute("draggable",!0))),e.handle){document.querySelectorAll(e.handle).forEach((t=>{t.addEventListener("mousedown",(t=>{t.target.closest(e.drag_target).addAttribute("draggable",!0)}))}))}e.main.addEventListener("dragstart",(e=>t.dragStart(e))),e.main.addEventListener("dragenter",(e=>t.dragEnter(e))),e.main.addEventListener("dragover",(e=>t.dragOver(e))),e.main.addEventListener("drop",(e=>t.drop(e))),e.main.addEventListener("dragend",(e=>t.dragEnd(e)))}};const Z=0,G=1,Q=2,ee=3,te=4;class le{constructor(t,l=null){this._name=t,this._type="",this._atts={},this._confirm=!1,this._reference="",this._label="",this._store=e.reactive({summary:0,options:[]}),this._default_val=null,this._immutable=!1,this._encrypted=!1,this._min=null,this._max=null,this._contains=[],this._notcontains=[],this._recursive=!1,this._error={OK:0,MIN_VALUE:1,MAX_VALUE:2,HAS:3,HAS_NOT:4};if(Object.keys(this).forEach((e=>{"_store"!=e&&"_"==e[0]&&Object.defineProperty(this,e.substring(1),{get:function(){return this[e]},set:function(t){"_type"==e?this._type=t.toLowerCase():this[e]=t}})})),this.summary=e.computed({get:()=>this._store.summary,set:e=>{this._store.summary=e?1:0}}),this.options=e.computed({get:()=>this._store.options,set:e=>{this._store.options=e}}),l){for(let e in l)if("summary"==e)this.summary=l[e]?1:0;else{if("validation"==e)continue;"type"==e?this.type=l[e].toLowerCase():this["_"+e]=l[e]}this._min=l.validation.min,this._max=l.validation.max,l.validation.contains&&(this._contains=l.validation.contains.split("|")),l.validation.notcontains&&(this._notcontains=l.validation.notcontains.split("|"))}}getOption(e){for(let t of this._store.options)if(t.key==e)return t.value}setReferenceOptions(e,t){return this._store.options=[],s.get(e,t).then((e=>{for(let t in e){let l=e[t]["--id"],r=[];for(let l in e[t])"--id"!=l&&r.push(e[t][l]);this._store.options.push({key:l,value:r.join(" ",r)})}})).catch((e=>{console.log(e)}))}clean(e){return"checkbox"==this._type?e?1:0:e}calcValue(e){return e||""}validateSize(e){return e<this._min?G:e>this._max?Q:Z}validate(e){if(null===e)return;let t;if(isNaN(e)){const l=e?e.length:0;t=this.validateSize(l)}else t=this.validateSize(e);if(t!=Z)return t;for(let t of this._notcontains)if(e.match(t))return te;if(0==this._contains.length)return Z;for(let t of this._contains)if(e.match(t))return Z;return ee}}class re{constructor(){this._cells={},this._children={},this._states={},this._limit=0,this._page=0,this._sort={},this._groups=[],this._active=0,this._max_pages=0,this._count=0,this._limited_fields=[],this._init=!1,this._store=e.reactive({index:null});Object.keys(this).forEach((e=>{"_"==e[0]&&Object.defineProperty(this,e.substring(1),{get:function(){return this[e]},set:function(t){this[e]=t}})}))}addChild(e,t){this._children[e]=t}addState(e,t){this._actions[e]=t}convertToParams(){let e={};return this._limit&&(e._limit=this._limit),this._page&&(e._page=this._page),this._limited_fields.length>0&&(e._fields=this._limited_fields),Object.keys(this._sort).length>0&&(e._sort=this._sort),e}resetSummary(e){for(let e in this._cells)this._cells[e].summary=!1;for(let t in e)this._cells[e[t]]&&(this._cells[e[t]].summary=!0)}mapField(e,t){this._cells[e]=new le(e,t),this._cells[e].recursive&&(this._store.index=e)}map(e,t=[]){if(t.length>0)for(let l of t)this.mapField(l,e[l]);else for(let t in e)this.mapField(t,e[t])}getCellByType(e){let t={};for(let l in this._cells)this._cells[l].type==e&&(t[l]=this._cells[l]);return t}applyMap(e){if("first"==e.key?this._limit=1:e.key&&(this._key=e.key),e.param_str){const t=JSON.parse(e.param_str);t._limit&&(this._limit=t._limit),t._fields&&(this._cells=t._fields),t.hasOwnProperty("_page")&&(this._page=t._page),t.hasOwnProperty("_sort")&&(this._sort=t._sort);for(const e in this._cells)t.hasOwnProperty(e)&&this._cells[e].setVal(t[e])}}applySettings(e){e.groups&&(this._groups=e.groups),e.limit&&(this._limit=e.limit)}}class ne{constructor(t){this._meta=t,this._store=e.reactive({value:null,change:null,display:null,error:0,is_validate_on:!1});const l=Object.getOwnPropertyNames(this._meta),r=Object.keys(this);l.forEach((e=>{"_"==e[0]||r.includes(e)||Object.defineProperty(this,e,{get:function(){return this._meta[e]},set:function(t){this._meta[e]=t}})})),this.error=e.computed({get:()=>{this._store.error},set:e=>{this._store.error=e}}),this.showError=e.computed((()=>!(!this._store.is_validate_on||!this._store.error))),this._meta.default_val?this._store.value=this._meta.default_val:"select"==this._meta.type&&(this._store.value=0),this.val=e.computed({get:()=>this._store.value,set:e=>{this._store.value=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.change=e.computed({get:()=>null==this._store.change?this._store.value:this._store.change,set:e=>{this._store.change=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.addParam=e=>{null!==this._store.value&&(e[this.name]=this._store.value)},"time"==this.type?(this.change1=e.computed({get:()=>(null==this._store.change&&(this._store.change=this._store.value),this._store.change?this._store.change.min:""),set:e=>{this._store.change||(this._store.change={min:null,max:null}),this._store.change.min=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.change2=e.computed({get:()=>(null==this._store.change&&(this._store.change=this._store.value),this._store.change?this._store.change.max:""),set:e=>{this._store.change||(this._store.change={min:null,max:null}),this._store.change.max=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.addAPIParam=e=>{null!=this._store.value&&(e[this.name]=this._store.value)}):"flag"==this.type?(this.change1=e.computed({get:()=>(null==this._store.change&&(this._store.change=this._store.value),null==this._store.change?0:this._store.change?this._store.change:2),set:e=>{0!=e?(2==e&&(e=0),this._store.change=this._meta.clean(e),this._store.error=this._meta.validate(e)):this._store.change=null}}),this.addAPIParam=e=>{null!=this._store.value&&(e[this.name]=this._store.value)}):"id"==this.type?(this.change1=e.computed({get:()=>(null==this._store.change&&(this._store.change=this._store.value),null==this._store.change?[]:this._store.change),set:e=>{null==this._store.change&&(this._store.change=[]),this._store.change.includes(e)||(this._store.change.push(this._meta.clean(e)),this._store.error=this._meta.validate(e))}}),this.addAPIParam=e=>{null!=this._store.value&&(e[this.name]=this._store.value)}):"number"==this.type?(this.change1=e.computed({get:()=>(null==this._store.change&&(this._store.change=this._store.value),this._store.change?this._store.change.min:""),set:e=>{this._store.change||(this._store.change={min:null,max:null}),this._store.change.min=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.change2=e.computed({get:()=>(null==this._store.change&&(this._store.change=this._store.value),this._store.change?this._store.change.max:""),set:e=>{this._store.change||(this._store.change={min:null,max:null}),this._store.change.max=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.addAPIParam=e=>{null!=this._store.value&&(e[this.name]=this._store.value)}):"string"==this.type&&(this.change=e.computed({get:()=>null==this._store.change?"":this._store.change,set:e=>{this._store.change=this._meta.clean(e),this._store.error=this._meta.validate(e)}}),this.change1=e.computed({get:()=>(null==this._store.change&&(this._store.change=this._store.value),null==this._store.change?[]:this._store.change),set:e=>{null==this._store.change&&(this._store.change=[]),this._store.change.push(this._meta.clean(e)),this._store.error=this._meta.validate(e)}}),this.addAPIParam=e=>{if(null!=this._store.value){e[this.name]=[];for(let t in this._store.value)e[this.name].push("%"+this._store.value[t]+"%")}})}get meta(){return this._meta}set validateon(e){this._store.is_validate_on=e}set display(e){this._store.display=e}get display(){return this._store.display?this._store.display:this._store.value}get store(){return this._store}toString(){return this._store.display}isSummary(){return this._meta.summary}setReferenceOptions(e,t){this._meta.setReferenceOptions(e,t)}reset(){this._store.change=null}getOption(e){return"string"==this._meta.type?e:this._meta.getOption(e)}}class oe{constructor(t){this._metarow=t,this._cells=e.reactive({}),this._children={},t&&this.applyMetaRow(t),this.cells=e.computed((()=>this._cells))}set children(e){this._children=e}get children(){return this._children}get primary(){return this._cells["--id"]}get parent(){return this._cells["--parentid"]}clone(){const e=new oe(this._metarow);let t={};for(let e in this._cells)t[e].val=this._cells[e].val;let l={};for(let t in e.children)l[t]=e.children[t].clone();return e.children=l,e}applyMetaRow(e){for(const t in e.cells){const l=e.cells[t];this._cells[l.name]=new ne(l)}for(const t in e.children)this._children[t]=e.children[t]}addChild(e,t){this._children[e]||(this._children[e]=[]),this._children[e].push(t)}set row(e){if(e){for(let t in this._cells)e.hasOwnProperty(t)&&(this._cells[t].val=e[t]);for(let t in this._children)this._children[t].row=e[t]}}getSummary(){let e=[];for(let t in this._cells){const l=this._cells[t];if(l.isSummary()){const t=l.display;e.push(t)}}return e.join(" ")}toString(){let e=[];for(let t in this._cells)e.push(this._cells[t].display);return e.join(" ")}serialize(e=!1){let t={};for(let l in this._cells)e?this._cells[l].change!=this._cells[l].val&&(t[l]=this._cells[l].change):null!=this._cells[l].change&&(t[l]=this._cells[l].change);return t}getCellByType(e){let t={};for(let l in this._cells)this._cells[l].type==e&&(t[l]=this._cells[l]);return t}clearErrors(){for(let e in this._cells)this._cells[e].error=0}reset(){for(let e in this._cells)this._cells[e].error=0,this._cells[e].change=null}setErrors(e){for(let t in e)0!==t.indexOf("__")&&this._cells[t]&&(this._cells[t].error=e[t])}convertToParams(){let e={};for(let t in this._cells)this._cells[t].addParam(e);return e}convertToAPIParams(){let e={};for(let t in this._cells)"asset"!=this._cells[t].type&&this._cells[t].addAPIParam(e);return e}applyChangeData(){for(let e in this._cells)this._cells[e].val=this._cells[e].change}}const ae=o.getModelSettings(u.model,u.state),ie=e.reactive({meta:new re,data:[],indexes:{},search:new oe});function se(){ie.indexes={};for(const e in ie.data){let t=ie.data[e].cells[ie.meta.store.index].val;ie.indexes[t]||(ie.indexes[t]=[]),ie.indexes[t].push(e)}}function ce(e){ie.data=[];for(const t in e){let l=new oe(ie.meta);l.row=e[t],ie.data.push(l)}}ae.fields&&(ie.meta.limited_fields=ae.fields);const de=async()=>{let e={...ie.meta.convertToParams(),...ie.search.convertToParams()};ie.meta=new re,ie.data=[],ie.indexes={},ie.search=new oe,e||(e={}),u.to&&(e.__to=u.to),u.key&&(e["--parentid"]=u.key),ae.fields&&(e.__fields=ae.fields);let t="/"+u.route+"/"+u.model;return"parent"==u.state&&(t+="/parent"),s.get("/route"+t,e).then((e=>{ie.meta.map(e.fields,ae.fields),ie.meta.applyMap(u),ie.meta.applyMap(ae),ie.search.applyMetaRow(ie.meta),ie.search.row=u.params,ie.meta.init=!0})).then((()=>(e={...e,...ie.search.convertToAPIParams()},ie.meta.limit>0?s.get("/data"+t+"/count",e).then((e=>{ie.meta.count=e.count,ie.meta.max_pages=Math.ceil(e.count/ie.meta.limit)})).then((()=>s.get("/data"+t,e))).then((e=>(ce(e),ie.meta.store.index&&se(),e))):s.get("/data"+t,e).then((e=>(ce(e),ie.meta.store.index&&se(),e)))))).catch((e=>console.log(e)))},pe=t=>(e.pushScopeId("data-v-1dcaa9f5"),t=t(),e.popScopeId(),t),ue=["id"],me={class:"ptj-tree-node-row"},he=[pe((()=>e.createElementVNode("span",{class:"material-icons"},"subdirectory_arrow_right",-1)))],fe=[pe((()=>e.createElementVNode("span",{class:"material-icons"},"keyboard_arrow_right",-1)))],ge={key:0},_e=[pe((()=>e.createElementVNode("span",{class:"material-icons"},"drag_handle",-1)))],ke=pe((()=>e.createElementVNode("span",{class:"material-icons"},"arrow_forward_ios",-1)));var ye={props:{row:{type:[String,Number],required:!0},draggable:Boolean,ischild:{type:Boolean,default:!1}},setup(t){const l=t,r=e.reactive({toggle_state:{},branch:null});function n(){const e=r.branch.primary.val;r.toggle_state[e]=!r.toggle_state[e]}const o=e.computed((()=>{if(!r.branch)return[];const e=r.branch.primary.val;return ie.indexes[e]?ie.indexes[e]:[]})),a=e.computed((()=>r.branch?r.branch.primary.val:0)),i=e.computed((()=>r.branch?r.branch.getSummary():""));return e.onMounted((()=>{r.branch=ie.data[l.row]})),(l,s)=>{const c=e.resolveComponent("ptj-tree-node",!0);return e.openBlock(),e.createElementBlock("div",{class:"ptj-tree-node ptj-draggable",id:e.unref(a),draggable:"false"},[e.createElementVNode("div",me,[e.createElementVNode("div",null,[t.ischild?(e.openBlock(),e.createElementBlock("a",{key:0,"data-action":"more",class:"button",onClick:s[0]||(s[0]=e.withModifiers((e=>n()),["prevent","stop"]))},he)):(e.openBlock(),e.createElementBlock("a",{key:1,"data-action":"more",class:"button",onClick:s[1]||(s[1]=e.withModifiers((e=>n()),["prevent","stop"]))},fe))]),e.unref(ie).meta.sortable?(e.openBlock(),e.createElementBlock("div",ge,[e.createElementVNode("a",{"data-action":"more",class:"button",onClick:s[2]||(s[2]=(...e)=>l.prevent.stop&&l.prevent.stop(...e)),onMousedown:s[3]||(s[3]=(...e)=>l.setDraggable&&l.setDraggable(...e)),onMouseup:s[4]||(s[4]=(...e)=>l.endDraggable&&l.endDraggable(...e))},_e,32)])):e.createCommentVNode("v-if",!0),e.createElementVNode("div",null,e.toDisplayString(e.unref(i)),1),e.createVNode(y,{route:{state:"primary",key:e.unref(a)}},{default:e.withCtx((()=>[ke])),_:1},8,["route"])]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),((t,l)=>e.withDirectives((e.openBlock(),e.createBlock(c,{row:t,ischild:!0,key:l},null,8,["row"])),[[e.vShow,e.unref(r).toggle_state[e.unref(a)]]]))),128))],8,ue)}}};V("\n.model-tree.branch[data-v-1dcaa9f5] {\r\n  padding-left: 8px;\r\n  padding-right: 8px;\r\n  margin: 6px 0;\r\n  background-color:#111111;\n}\n.tree .ide-block[data-v-1dcaa9f5] {\r\n\tdisplay : none;\n}\n.dragArea[data-v-1dcaa9f5] {\r\n  min-height: 50px;\r\n  outline: 1px solid #777777;\n}\r\n\r\n\r\n"),ye.__scopeId="data-v-1dcaa9f5",ye.__file="presstojam/src/components/ptj-tree-node.vue";const ve={class:"ptj-tree ptj-drop-target'",ref:"treeroot"};var Be={setup(t){function l(){}return e.onMounted((()=>{ie.meta.sortable&&W.initDD({handle:".ptj-drag-handle",drag_target:".ptj-draggable",drop_target:".ptj-drop-target",callback:l})})),(t,l)=>(e.openBlock(),e.createElementBlock("div",ve,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(ie).indexes[0],((t,l)=>(e.openBlock(),e.createBlock(ye,{key:l,row:t},null,8,["row"])))),128))],512))},__file:"presstojam/src/components/ptj-tree.vue"};const be=["name"],we={key:1},Ee=["name"],je=e.createTextVNode(" - "),Ve=["name"],Ne={key:2};var Se={props:{field:Object,type:{type:String,default:"view"}},setup:t=>(l,r)=>"edit"==t.type?e.withDirectives((e.openBlock(),e.createElementBlock("input",e.mergeProps({key:0,class:"ptj-form-number",name:t.field.name,type:"number","onUpdate:modelValue":r[0]||(r[0]=e=>t.field.change=e)},t.field.atts,{onBlur:r[1]||(r[1]=e=>t.field.validateon=!0)}),null,16,be)),[[e.vModelText,t.field.change]]):"filter"==t.type?(e.openBlock(),e.createElementBlock("div",we,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"ptj-form-filter-number ptj-min",name:t.field.name,type:"number","onUpdate:modelValue":r[2]||(r[2]=e=>t.field.change1=e)},t.field.atts,{onBlur:r[3]||(r[3]=e=>t.field.validateon=!0)}),null,16,Ee),[[e.vModelText,t.field.change1]]),je,e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"ptj-form-filter-number ptj-max",name:t.field.name,type:"number","onUpdate:modelValue":r[4]||(r[4]=e=>t.field.change2=e)},t.field.atts,{onBlur:r[5]||(r[5]=e=>t.field.validateon=!0)}),null,16,Ve),[[e.vModelText,t.field.change2]])])):(e.openBlock(),e.createElementBlock("span",Ne,e.toDisplayString(t.field.val),1)),__file:"presstojam/src/components/ptj-number.vue"};const xe=["name"],Ce=["name"],De=[e.createElementVNode("option",{value:0},e.toDisplayString("All"),-1),e.createElementVNode("option",{value:1},e.toDisplayString("Checked"),-1),e.createElementVNode("option",{value:2},e.toDisplayString("Unchecked"),-1)],Oe={class:"material-icons"};var Me={props:{field:Object,type:{type:String,default:"view"}},setup(t){const l=t;let r=e.computed((()=>"edit"==l.type&&l.field.immutable?"view":l.type));let n=e.computed((()=>1==l.field.val?"check_circle_outline":"highlight_off"));return(o,a)=>"edit"==e.unref(r)?e.withDirectives((e.openBlock(),e.createElementBlock("input",{key:0,class:"ptj-checkbox",type:"checkbox","true-value":1,"false-value":0,name:t.field.name,"onUpdate:modelValue":a[0]||(a[0]=e=>t.field.change=e)},null,8,xe)),[[e.vModelCheckbox,t.field.change]]):"filter"==e.unref(r)?e.withDirectives((e.openBlock(),e.createElementBlock("select",{key:1,name:t.field.name,"onUpdate:modelValue":a[1]||(a[1]=e=>t.field.change1=e),class:"ptj-filter-form-checkbox"},De,8,Ce)),[[e.vModelSelect,t.field.change1]]):(e.openBlock(),e.createElementBlock("a",{key:2,onClick:a[2]||(a[2]=e=>function(){let e={};return e["--id"]=u.key,e[l.field.name]=1==l.field.val?0:1,u.key&&(e["--id"]=u.key),s.put("/data/"+u.route+"/"+u.model,e).then((()=>{l.field.val=1==l.field.val?0:1})).catch((e=>{console.log(e)}))}())},[e.createElementVNode("span",Oe,e.toDisplayString(e.unref(n)),1)]))},__file:"presstojam/src/components/ptj-flag.vue"};const Pe=["name"],Te=e.createElementVNode("option",{value:"0",selected:""},"Select Option",-1),Le=["value"],Ae={key:2};var Fe={props:{field:Object,type:{default:"view",type:String}},setup(t){const l=t;let r=e.computed((()=>"edit"==l.type&&l.field.immutable?"view":l.type));return e.computed((()=>l.field.options)),(l,n)=>"edit"==e.unref(r)?e.withDirectives((e.openBlock(),e.createElementBlock("select",e.mergeProps({key:0,"onUpdate:modelValue":n[0]||(n[0]=e=>t.field.change=e)},t.field.atts,{name:t.field.name,onBlur:n[1]||(n[1]=e=>t.field.validateon=!0)}),[Te,(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.field.options,(t=>(e.openBlock(),e.createElementBlock("option",{key:t.key,value:t.key},e.toDisplayString(t.value),9,Le)))),128))],16,Pe)),[[e.vModelSelect,t.field.change]]):"filter"==e.unref(r)?(e.openBlock(),e.createBlock(P,{key:1,field:t.field},null,8,["field"])):(e.openBlock(),e.createElementBlock("span",Ae,e.toDisplayString(t.field.getOption(t.field.val)),1))},__file:"presstojam/src/components/ptj-id.vue"};const Ue=["name"],Ie={key:1},Re=["name"],ze=e.createTextVNode(" - "),$e=["name"],Je={key:2};var qe={props:{field:Object,type:{default:"view",type:String}},setup(t){const l=t;let r=e.computed((()=>"edit"==l.type&&l.field.immutable?"view":l.type));return(l,n)=>"edit"==e.unref(r)?e.withDirectives((e.openBlock(),e.createElementBlock("input",e.mergeProps({key:0,name:t.field.name,type:"datetime-local","onUpdate:modelValue":n[0]||(n[0]=e=>t.field.change=e)},t.field.atts,{onBlur:n[1]||(n[1]=e=>t.field.validateon=!0)}),null,16,Ue)),[[e.vModelText,t.field.change]]):"filter"==e.unref(r)?(e.openBlock(),e.createElementBlock("div",Ie,[e.withDirectives(e.createElementVNode("input",e.mergeProps({type:"datetime-local",name:t.field.name+"min"},t.field.atts,{"onUpdate:modelValue":n[2]||(n[2]=e=>t.field.change1=e)}),null,16,Re),[[e.vModelText,t.field.change1]]),ze,e.withDirectives(e.createElementVNode("input",e.mergeProps({type:"datetime-local",name:t.field.name+"max"},t.field.atts,{"onUpdate:modelValue":n[3]||(n[3]=e=>t.field.change2=e)}),null,16,$e),[[e.vModelText,t.field.change2]])])):(e.openBlock(),e.createElementBlock("span",Je,e.toDisplayString(t.field.val),1))},__file:"presstojam/src/components/ptj-time.vue"};const Xe=["name"],Ye={key:1};var He={props:{field:Object,type:{type:String,default:"view"}},setup:t=>(l,r)=>"edit"==t.type?(e.openBlock(),e.createElementBlock("input",{key:0,class:"ptj-form-asset",ref:"input",onChange:r[0]||(r[0]=(...e)=>l.setFile&&l.setFile(...e)),name:t.field.meta.name,type:"file"},null,40,Xe)):(e.openBlock(),e.createElementBlock("span",Ye,e.toDisplayString(t.field.val),1)),__file:"presstojam/src/components/ptj-asset.vue"};const Ke=t=>(e.pushScopeId("data-v-15ab9672"),t=t(),e.popScopeId(),t),We={class:"ptj-table-header"},Ze=["onClick"],Ge={key:0,class:"material-icons"},Qe={key:1,class:"material-icons"},et=Ke((()=>e.createElementVNode("th",{class:"ptj-actions"}," ",-1))),tt={class:"ptj-actions"},lt=Ke((()=>e.createElementVNode("span",{class:"material-icons"},"arrow_forward_ios",-1)));var rt={setup(t){let l=e.reactive({name:"",dir:""});return(t,r)=>(e.openBlock(),e.createElementBlock("table",{class:e.normalizeClass(["ptj-table",Map.model])},[e.createElementVNode("thead",null,[e.createElementVNode("tr",We,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(ie).meta.cells,(t=>e.withDirectives((e.openBlock(),e.createElementBlock("th",{key:t.name,class:e.normalizeClass(["ptj-table-header-cell",t.name]),onClick:e=>{!function(e){if(ie.meta.pages>0){l.dir=!l.name!=e||"desc"==l.dir?"asc":"desc",l.name=e;let t=[];t[l.name]=l.dir,ie.meta.sort=t,load()}else l.name!=e||"desc"==l.dir?(ie.data.sort((function(t,l){let r=t.getCell(e).toVal(),n=l.getCell(e).toVal();return r<n?-1:r>n?1:0})),l.name=e,l.dir="asc"):(ie.data.sort((function(t,l){let r=t.getCell(e).toVal(),n=l.getCell(e).toVal();return r<n?1:r>n?-1:0})),l.name=e,l.dir="desc")}(t.name)}},[e.createTextVNode(e.toDisplayString(t.label)+" ",1),e.unref(l).name==t.name&&"asc"==e.unref(l).dir?(e.openBlock(),e.createElementBlock("span",Ge,"keyboard_arrow_up")):e.createCommentVNode("v-if",!0),e.unref(l).name==t.name&&"desc"==e.unref(l).dir?(e.openBlock(),e.createElementBlock("span",Qe,"keyboard_arrow_down")):e.createCommentVNode("v-if",!0)],10,Ze)),[[e.vShow,t.summary]]))),128)),et])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(ie).data,((t,l)=>(e.openBlock(),e.createElementBlock("tr",{key:l,class:"ptj-table-row"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.cells,((t,l)=>e.withDirectives((e.openBlock(),e.createElementBlock("td",{key:l,class:e.normalizeClass(["ptj-table-cell",t.meta.name])},["asset"==t.type?(e.openBlock(),e.createBlock(He,{key:0,field:t},null,8,["field"])):"number"==t.type?(e.openBlock(),e.createBlock(Se,{key:1,field:t},null,8,["field"])):"flag"==t.type?(e.openBlock(),e.createBlock(Me,{key:2,field:t},null,8,["field"])):"id"==t.type?(e.openBlock(),e.createBlock(Fe,{key:3,field:t},null,8,["field"])):"time"==t.type?(e.openBlock(),e.createBlock(qe,{key:4,field:t},null,8,["field"])):"string"==t.type?(e.openBlock(),e.createBlock($,{key:5,field:t},null,8,["field"])):e.createCommentVNode("v-if",!0)],2)),[[e.vShow,t.summary]]))),128)),e.createElementVNode("td",tt,[e.createVNode(y,{route:{state:"primary",key:t.cells["--id"].val}},{default:e.withCtx((()=>[lt])),_:2},1032,["route"])])])))),128))])],2))}};V("\n.table[data-v-15ab9672], .thead[data-v-15ab9672], .tbody[data-v-15ab9672], .tr[data-v-15ab9672] {\r\n    width : 100%;\n}\r\n\r\n\r\n"),rt.__scopeId="data-v-15ab9672",rt.__file="presstojam/src/components/ptj-table.vue";var nt={setup(t){e.inject("data"),e.inject("indexes");const l=e.computed((()=>{let e=[];for(let t in indexes)e=this.getCombinations(t,indexes[t],e);return e}));return(t,r)=>(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),((l,r)=>(e.openBlock(),e.createElementBlock("div",{key:r},[e.createElementVNode("h3",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.tags,((t,l)=>(e.openBlock(),e.createElementBlock("span",{key:l},e.toDisplayString(t)+" ",1)))),128))]),e.createElementVNode("ul",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.data,(l=>(e.openBlock(),e.createElementBlock("li",{key:l},[e.createVNode(y,{route:t.route},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(t.data[l].getSummary()),1)])),_:2},1032,["route"])])))),128))])])))),128))},__file:"presstojam/src/components/ptj-list.vue"};const ot={class:"ptj-error"};var at={props:{error:[Number,String,Object]},setup:t=>(l,r)=>(e.openBlock(),e.createElementBlock("p",ot,e.toDisplayString(t.error),1))};V("\n.ptj-error {\r\n  color : red;\n}\r\n"),at.__file="presstojam/src/components/ptj-error.vue";const it={class:"ptj-form-label"};var st={props:{field:[Object,Function]},setup:t=>(l,r)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["ptj-form-row",t.field.name])},[e.createElementVNode("label",it,e.toDisplayString(e.unref(d)(t.field.name,"label",t.field.label)),1),e.renderSlot(l.$slots,"default"),e.withDirectives(e.createVNode(at,{error:t.field.error},null,8,["error"]),[[e.vShow,t.field.showError]])],2)),__file:"presstojam/src/components/ptj-form-row.vue"};const ct={class:"ptj-widget-window"},dt={class:"ptj-widget-window-header"},pt={class:"ptj-widget-window-title"},ut=[e.createElementVNode("span",{class:"material-icons"},"more_horiz",-1)],mt={class:"ptj-widget-window-body"};var ht={props:{title:String,active:{type:Boolean,default:!1}},setup(t){let l=e.ref(!1);function r(){l.value=!l.value}return(n,o)=>(e.openBlock(),e.createElementBlock("div",ct,[e.createElementVNode("div",dt,[e.createElementVNode("h1",pt,[e.createTextVNode(e.toDisplayString(t.title)+" ",1),e.createElementVNode("a",{class:"ptj-widget-window-toggle",onClick:r},ut)])]),e.withDirectives(e.createElementVNode("div",mt,[e.renderSlot(n.$slots,"default",{toggleWidget:r})],512),[[e.vShow,e.unref(l)]])]))},__file:"presstojam/src/components/ptj-widget.vue"};const ft=["onSubmit"],gt=["onClick"],_t=["onClick"];var kt={setup(t){function l(){ie.search.applyChangeData(),u.params=ie.search.convertToParams(),_(),de()}return(t,r)=>(e.openBlock(),e.createBlock(ht,{title:"search"},{default:e.withCtx((t=>[e.createElementVNode("form",{onSubmit:e.withModifiers(l,["prevent"]),class:"ptj-filter-form"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(ie).search.cells,(t=>e.withDirectives((e.openBlock(),e.createBlock(st,{key:t.name,field:t},{default:e.withCtx((()=>["id"==t.type?(e.openBlock(),e.createBlock(Fe,{key:0,type:"filter",field:t},null,8,["field"])):"flag"==t.type?(e.openBlock(),e.createBlock(Me,{key:1,type:"filter",field:t},null,8,["field"])):"number"==t.type?(e.openBlock(),e.createBlock(Se,{key:2,type:"filter",field:t},null,8,["field"])):"time"==t.type?(e.openBlock(),e.createBlock(qe,{key:3,type:"filter",field:t},null,8,["field"])):"string"==t.type?(e.openBlock(),e.createBlock($,{key:4,type:"filter",field:t},null,8,["field"])):e.createCommentVNode("v-if",!0),e.createElementVNode("a",{onClick:e=>t.reset()},"x",8,gt)])),_:2},1032,["field"])),[[e.vShow,"id"!=t.type||Object.keys(t.options).length>0]]))),128)),e.createElementVNode("input",{type:"submit",value:"Submit",class:"ptj-filter-form-submit",onClick:t.toggleWidget},null,8,_t)],40,ft)])),_:1}))}};V("\n.error[data-v-71ada21d] {\r\n  color : red;\n}\r\n\r\n"),kt.__scopeId="data-v-71ada21d",kt.__file="presstojam/src/components/ptj-filter-form.vue";const yt=["onUpdate:modelValue"],vt={class:"ptj-selectfields-label"};var Bt={setup:t=>(t,l)=>(e.openBlock(),e.createBlock(ht,{title:"select fields",class:"ptj-selectfields"},{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(ie).meta.cells,((t,l)=>(e.openBlock(),e.createElementBlock("div",{key:l},[e.withDirectives(e.createElementVNode("input",{type:"checkbox","onUpdate:modelValue":e=>t.summary=e,"true-value":1,"false-value":0,class:"ptj-selectfields-checkbox"},null,8,yt),[[e.vModelCheckbox,t.summary]]),e.createElementVNode("label",vt,e.toDisplayString(e.unref(d)(t.name,"label",t.name)),1)])))),128))])),_:1})),__file:"presstojam/src/components/ptj-selectfields.vue"};const bt={class:"ptj-pagination"},wt=["onClick"];var Et={props:{data_template:Object},setup(t){const l=t;function r(e){return e-1==l.data_template.page?"ptj-pagination-active":""}return(l,n)=>(e.openBlock(),e.createElementBlock("div",bt,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.data_template.max_pages,(t=>(e.openBlock(),e.createElementBlock("a",{key:t,onClick:e=>l.$emit("setPage",t-1),class:e.normalizeClass(r(t))},e.toDisplayString(t),11,wt)))),128))]))},__file:"presstojam/src/components/ptj-pagination.vue"};const jt={class:"ptj-progress-bar-wrapper"},Vt={class:"ptj-progress-holder"};var Nt={props:{total:Number,progress:Number},setup(t){const l=t,r=e.computed((()=>{let e=Math.floor(l.progress/l.total*100);return isNaN(e)?0:e}));return(t,l)=>(e.openBlock(),e.createElementBlock("div",jt,[e.createElementVNode("div",Vt,[e.createElementVNode("div",{class:"ptj-progress-bar",style:e.normalizeStyle("width:"+e.unref(r)+"px")}," ",4)]),e.createElementVNode("span",null,e.toDisplayString(e.unref(r))+"%",1)]))}};V("\n.ptj-progress-holder[data-v-460b10ff] {\r\n     width : 100%;\r\n     min-height : 10px;\r\n     position : relative;\r\n     display : flex;\r\n     align-items: stretch;\r\n     padding : 2px;\n}\n.ptj-progress-bar[data-v-460b10ff] {\r\n     width : 0;\r\n     height : 100%;\r\n     position : relative;\r\n     line-height : 100%;\n}\r\n\r\n\r\n"),Nt.__scopeId="data-v-460b10ff",Nt.__file="presstojam/src/components/ptj-progress-bar.vue";const St=["onSubmit"],xt=e.createElementVNode("input",{type:"submit",value:"Submit",class:"ptj-form-submit"},null,-1);var Ct={emits:["close"],setup(t,{emit:l}){let r=e.ref("");o.getModelSettings(u.model,u.state);const n=e.reactive(new oe),a=e.reactive({total:0,progress:0});let i=0;function c(){i=a.total>0?1:2,n.clearErrors();let e=n.serialize();return u.key&&(e["--parentid"]=u.key),s.post("/data/"+u.route+"/"+u.model,e).then((e=>{let t=[],l=n.getCellByType("asset");a.total=0;for(let r in l){if(!l[r].val)continue;++a.total;const n=new Asset;n.url="/asset/"+u.model+"/"+r+"/"+e["--id"];let o=n.saveFile(l[r].val).then((()=>{++a.progress}));t.push(o)}return Promise.all(t)})).then((()=>{n.reset(),de(),l("close")})).catch((e=>{console.log(e),i=0,"string"==typeof e?r=e:n.setErrors(e)}))}return e.onMounted((async()=>{await(async()=>s.post("/route/"+u.route+"/"+u.model).then((e=>{const t=new re;t.map(e.fields),n.applyMetaRow(t);let l=[];for(let e in t.cells)if("id"==t.cells[e].type&&t.cells[e].reference){let r="/reference/"+u.model+"/"+e;l.push(t.cells[e].setReferenceOptions(r,{"--parentid":u.key}))}return Promise.all(l)})).catch((e=>console.log(e))))()})),(t,l)=>e.withDirectives((e.openBlock(),e.createElementBlock("form",{onSubmit:e.withModifiers(c,["prevent"]),class:e.normalizeClass(["ptj-form",u.model+" "+u.state])},[e.withDirectives(e.createElementVNode("div",{class:"ptj-form-error"},e.toDisplayString(e.unref(r)),513),[[e.vShow,e.unref(r)]]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n).cells,(t=>(e.openBlock(),e.createBlock(st,{key:t.name,field:t},{default:e.withCtx((()=>["asset"==t.type?(e.openBlock(),e.createBlock(He,{key:0,type:"edit",field:t},null,8,["field"])):"number"==t.type?(e.openBlock(),e.createBlock(Se,{key:1,type:"edit",field:t},null,8,["field"])):"flag"==t.type?(e.openBlock(),e.createBlock(Me,{key:2,type:"edit",field:t},null,8,["field"])):"id"==t.type?(e.openBlock(),e.createBlock(Fe,{key:3,type:"edit",field:t},null,8,["field"])):"time"==t.type?(e.openBlock(),e.createBlock(qe,{key:4,type:"edit",field:t},null,8,["field"])):"string"==t.type?(e.openBlock(),e.createBlock($,{key:5,type:"edit",field:t},null,8,["field"])):e.createCommentVNode("v-if",!0)])),_:2},1032,["field"])))),128)),xt,e.withDirectives(e.createVNode(Nt,{total:e.unref(a).total,progress:e.unref(a).progress},null,8,["total","progress"]),[[e.vShow,1==e.unref(i)]])],42,St)),[[e.vShow,0==e.unref(i)]])},__file:"presstojam/src/components/ptj-create-form.vue"},Dt={setup(t){const l=o.getModelSettings(Map.model,Map.state),n=e.ref(!1),a=e.computed((()=>l.component?l.component:ie.meta.cells?ie.meta.store.index||ie.meta.children.length>0?"tree":"table":""));function i(){n.value=!n.value}return e.onMounted((async()=>{await de()})),(t,o)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass([Map.model,Map.state])},[e.createElementVNode("button",{onClick:o[0]||(o[0]=e=>i())},"Create"),e.createVNode(r,{active:n.value,onClose:o[2]||(o[2]=e=>i())},{default:e.withCtx((()=>[e.createVNode(Ct,{onClose:o[1]||(o[1]=e=>i())})])),_:1},8,["active"]),1!=e.unref(l).disable_filter?(e.openBlock(),e.createBlock(kt,{key:0})):e.createCommentVNode("v-if",!0),1!=e.unref(l).disable_selectfields?(e.openBlock(),e.createBlock(Bt,{key:1})):e.createCommentVNode("v-if",!0),"tree"==e.unref(a)?(e.openBlock(),e.createBlock(Be,{key:2})):"list"==e.unref(a)?(e.openBlock(),e.createBlock(nt,{key:3})):"table"==e.unref(a)?(e.openBlock(),e.createBlock(rt,{key:4})):e.createCommentVNode("v-if",!0),e.unref(ie).meta.limit>0?(e.openBlock(),e.createBlock(Et,{key:5})):e.createCommentVNode("v-if",!0)],2))}};V("\n.table[data-v-1c7fb47e], .thead[data-v-1c7fb47e], .tbody[data-v-1c7fb47e], .tr[data-v-1c7fb47e] {\r\n    width : 100%;\n}\r\n\r\n"),Dt.__scopeId="data-v-1c7fb47e",Dt.__file="presstojam/src/components/ptj-repo.vue";const Ot=["placeholder"],Mt=["disabled"];var Pt={props:{check_str:{type:String,default:"delete"},parentid:{default:0}},emits:["close"],setup(t,{emit:l}){const r=t;let n=e.ref(""),o=e.ref(!0);function a(){o.value=n.value!=r.check_str}function i(){s.delete("/data/"+u.route+"/"+u.model,{"--id":u.key}).then((e=>{u.state="parent",u.key=r.parentid.val,g()})).catch((e=>console.log(e)))}return(l,r)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("p",null,"Are you sure you want to permanently delete this record? Type "+e.toDisplayString(t.check_str)+" in the box below to continue.",1),e.withDirectives(e.createElementVNode("input",{type:"text",placeholder:t.check_str,onKeyup:a,"onUpdate:modelValue":r[0]||(r[0]=t=>e.isRef(n)?n.value=t:n=t)},null,40,Ot),[[e.vModelText,e.unref(n)]]),e.createElementVNode("button",{disabled:e.unref(o),onClick:i},"Delete",8,Mt)],64))},__file:"presstojam/src/components/ptj-delete.vue"};const Tt={class:"ptj-children"};var Lt={setup(t){const l=o.getModelSettings(u.model,u.state),n=e.reactive({data:new oe,fstate:0,type:"view",show_def:!1,progress:{total:0,progress:0}});let a=e.ref(!1);function i(){n.type="view"==n.type?"edit":"view"}let c=e.computed((()=>"edit"==n.type?"view":"edit"));function d(){a.value=!a.value}function m(){n.fstate=n.progress.total>0?1:2,n.data.clearErrors();let e=n.data.serialize(!0);if(0!=Object.keys(e).length)return e["--id"]=u.key,s.put("/data/"+u.route+"/"+u.model,e).then((e=>{let t=[],l=n.data.getCellByType("asset");n.progress.total=0;for(let r in l){if(!l[r].val)continue;++n.progress.total;const o=new Asset;o.url="/asset/"+u.model+"/"+r+"/"+e["--id"];let a=o.saveFile(l[r].val).then((()=>{++n.progress.progress}));t.push(a)}return Promise.all(t)})).then((()=>{for(let e in n.data.cells)n.data.cells[e].val=n.data.cells[e].change})).then((()=>{i()})).catch((e=>{n.fstate=0,"string"==typeof e?globalerror=e:n.data.setErrors(e)}));i()}return e.onMounted((async()=>{await(async()=>{let e={};return u.to&&(e.__to=u.to),u.key&&(e["--id"]=u.key),l.fields&&(e.__fields=l.fields),s.get("/route/"+u.route+"/"+u.model+"/primary",e).then((e=>{const t=new re;t.map(e.fields,l.fields),n.data.applyMetaRow(t)})).then((()=>s.get("/data/"+u.route+"/"+u.model+"/primary",e))).then((e=>{n.data.row=e;for(let e in n.data.cells)n.data.cells[e].change=n.data.cells[e].val})).then((e=>{for(let e in n.data.cells)if("id"==n.data.cells[e].type&&n.data.cells[e].reference){let t="/reference/"+u.model+"/"+e;n.data.cells[e].setReferenceOptions(t,{"--id":u.key})}})).catch((e=>console.log(e)))})()})),(t,l)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(p).route.perms.includes("put")?(e.openBlock(),e.createElementBlock("button",{key:0,onClick:i},e.toDisplayString(e.unref(c)),1)):e.createCommentVNode("v-if",!0),e.unref(p).route.perms.includes("delete")?(e.openBlock(),e.createElementBlock("button",{key:1,onClick:d},"Delete")):e.createCommentVNode("v-if",!0),e.createVNode(r,{active:e.unref(a),onClose:l[1]||(l[1]=e=>d())},{default:e.withCtx((()=>[e.createVNode(Pt,{parentid:e.unref(n).data.parent,onClose:l[0]||(l[0]=e=>d())},null,8,["parentid"])])),_:1},8,["active"]),e.createElementVNode("div",{class:e.normalizeClass(["ptj-primary",u.model])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n).data.cells,(t=>(e.openBlock(),e.createBlock(st,{key:t.name,field:t},{default:e.withCtx((()=>["asset"==t.meta.type?(e.openBlock(),e.createBlock(He,{key:0,type:e.unref(n).type,field:t},null,8,["type","field"])):"number"==t.meta.type?(e.openBlock(),e.createBlock(Se,{key:1,type:e.unref(n).type,field:t},null,8,["type","field"])):"flag"==t.meta.type?(e.openBlock(),e.createBlock(Me,{key:2,type:e.unref(n).type,field:t},null,8,["type","field"])):"id"==t.meta.type?(e.openBlock(),e.createBlock(Fe,{key:3,type:e.unref(n).type,field:t},null,8,["type","field"])):"time"==t.meta.type?(e.openBlock(),e.createBlock(qe,{key:4,type:e.unref(n).type,field:t},null,8,["type","field"])):"string"==t.meta.type?(e.openBlock(),e.createBlock($,{key:5,type:e.unref(n).type,field:t},null,8,["type","field"])):e.createCommentVNode("v-if",!0)])),_:2},1032,["field"])))),128)),"edit"==e.unref(n).type?(e.openBlock(),e.createElementBlock("input",{key:0,type:"submit",value:"Submit",class:"ptj-form-submit",onClick:m})):e.createCommentVNode("v-if",!0)],2),e.createElementVNode("div",Tt,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(p).route.children,(t=>(e.openBlock(),e.createBlock(y,{key:t,route:{model:t,state:"parent"}},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(t),1)])),_:2},1032,["route"])))),128))])],64))},__file:"presstojam/src/components/ptj-primary.vue"};const At={class:"ptj-account-handler"},Ft=["onSubmit"],Ut=e.createElementVNode("input",{type:"submit",value:"Submit",class:"ptj-form-submit"},null,-1),It=["onSubmit"],Rt=e.createElementVNode("input",{type:"submit",value:"Submit",class:"ptj-form-submit"},null,-1);var zt={props:{actions:[]},setup(t){const l=e.reactive({state:"login",active:!0,login_data:new oe,register_data:new oe,globalerror:""});function r(){return l.active=!1,l.globalerror="","login"==l.state?s.post("/data/"+u.route+"/"+u.model+"/login",l.login_data.serialize("login")).then((e=>{f()})).catch((e=>{l.globalerror="Incorrect username / password"})):s.post("/data/"+u.route+"/"+u.model,l.register_data.serialize("post")).then((e=>{f()})).catch((e=>{l.register_data.applyErrors(e)}))}return s.post("/route/"+u.route+"/"+u.model).then((e=>{let t=new re;t.map(e.fields),l.register_data.applyMetaRow(t)})),s.post("/route/"+u.route+"/"+u.model+"/login").then((e=>{let t=new re;t.map(e.fields),l.login_data.applyMetaRow(t)})),(t,n)=>(e.openBlock(),e.createElementBlock("div",At,[e.withDirectives(e.createElementVNode("form",{onSubmit:e.withModifiers(r,["prevent"]),class:"ptj-login"},[e.withDirectives(e.createElementVNode("div",{class:"ptj-form-error"},e.toDisplayString(e.unref(l).globalerror),513),[[e.vShow,e.unref(l).globalerror]]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l).login_data.cells,(t=>(e.openBlock(),e.createBlock(st,{key:t.meta.name,field:t},{default:e.withCtx((()=>[e.createVNode($,{type:"edit",field:t},null,8,["field"])])),_:2},1032,["field"])))),128)),Ut],40,Ft),[[e.vShow,"login"==e.unref(l).state]]),e.withDirectives(e.createElementVNode("form",{onSubmit:e.withModifiers(r,["prevent"]),class:"ptj-register"},[e.withDirectives(e.createElementVNode("div",{class:"ptj-form-error"},e.toDisplayString(e.unref(l).globalerror),513),[[e.vShow,e.unref(l).globalerror]]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l).register_data.cells,(t=>(e.openBlock(),e.createBlock(st,{key:t.meta.name,field:t},{default:e.withCtx((()=>["number"==t.meta.type?(e.openBlock(),e.createBlock(Se,{key:0,type:"edit",field:t},null,8,["field"])):"flag"==t.meta.type?(e.openBlock(),e.createBlock(Me,{key:1,type:"edit",field:t},null,8,["field"])):"time"==t.meta.type?(e.openBlock(),e.createBlock(qe,{key:2,type:"edit",field:t},null,8,["field"])):"string"==t.meta.type?(e.openBlock(),e.createBlock($,{key:3,type:"edit",field:t},null,8,["field"])):e.createCommentVNode("v-if",!0)])),_:2},1032,["field"])))),128)),Rt],40,It),[[e.vShow,"create"==e.unref(l).state]])]))},__file:"presstojam/src/components/ptj-account-handler.vue"};const $t={class:"ptj-nav"},Jt={key:0},qt=e.createElementVNode("span",{class:"material-icons"},"back",-1),Xt=e.createElementVNode("div",null,"Loading ...",-1);var Yt={setup(t){const l=e.computed((()=>p.component?"ptj-primary"==p.component?Lt:"ptj-repo"==p.component?Dt:"ptj-account-handler"==p.component?zt:void 0:null));return e.onMounted((()=>{(function(){const e=o.getSettings("mapper");return e&&(u.base="/"+e.base.replace(/^\/+|\/+$/g,""),e.role),u.convertFromURL(),Promise.resolve()})().then((()=>k()))})),(t,r)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",$t,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(p).cats,((t,l)=>(e.openBlock(),e.createElementBlock("div",{key:l},[t.length>1?(e.openBlock(),e.createElementBlock("span",Jt,e.toDisplayString(l),1)):e.createCommentVNode("v-if",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t,(t=>(e.openBlock(),e.createBlock(y,{route:{route:t.route,model:t.model,state:t.state,key:0},key:t.route},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(t.route),1)])),_:2},1032,["route"])))),128))])))),128))]),e.createVNode(H),(e.openBlock(),e.createBlock(e.Suspense,null,{default:e.withCtx((()=>[e.createElementVNode("div",{class:e.normalizeClass([Map.model,Map.state])},[e.unref(p).back?(e.openBlock(),e.createBlock(y,{key:0,route:e.unref(p).back},{default:e.withCtx((()=>[qt])),_:1},8,["route"])):e.createCommentVNode("v-if",!0),e.createElementVNode("h1",null,e.toDisplayString(e.unref(p).title),1),e.unref(l)?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(l)),{key:1})):e.createCommentVNode("v-if",!0)],2)])),fallback:e.withCtx((()=>[Xt])),_:1}))],64))},__file:"presstojam/src/components/ptj-router.vue"},Ht={setup:t=>(X(),(t,l)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[(e.openBlock(),e.createBlock(e.Teleport,{to:"#ptj-accountdetails"},["public"!=e.unref(J).user?(e.openBlock(),e.createElementBlock("a",{key:0,class:"ptj-account-details-logout",onClick:l[0]||(l[0]=(...t)=>e.unref(q)&&e.unref(q)(...t))},"Logout")):e.createCommentVNode("v-if",!0)])),e.createVNode(Yt),e.createVNode(r,{active:e.unref(J).login},null,8,["active"])],64)))};return Ht.__file="presstojam/src/components/ptj-user.vue",{runApp:function(t,l){o.regSettings(l);const r=e.createApp(Ht);return r.mount(t),r},getClient:function(e){return o.regSettings(e),s}}}));
//# sourceMappingURL=ptj.min.js.map
