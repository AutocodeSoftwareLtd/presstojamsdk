"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("vue"),t=e.defineComponent({name:"gc-error",props:{error:String}});const r={class:"error"};function s(e,t){void 0===t&&(t={});var r=t.insertAt;if(e&&"undefined"!=typeof document){var s=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===r&&s.firstChild?s.insertBefore(o,s.firstChild):s.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}s("\n.error {\r\n  color : red;\n}\r\n"),t.render=function(t,s,o,i,n,a){return e.openBlock(),e.createBlock("p",r,e.toDisplayString(t.error),1)},t.__file="vite-sdk/src/components/gc-error.vue";var o=e.defineComponent({name:"gc-input",props:{field:Object,stores:Object},setup:e=>e.stores.exportToViewField(e.field),components:{"gc-error":t}});const i={key:0};o.render=function(t,r,s,o,n,a){const l=e.resolveComponent("gc-error");return e.openBlock(),e.createBlock(e.Fragment,null,["hidden"!=t.field.atts.type?(e.openBlock(),e.createBlock("label",i,e.toDisplayString(t.field.label),1)):e.createCommentVNode("v-if",!0),e.withDirectives(e.createVNode("input",{name:t.field.name,type:t.field.atts.type,"onUpdate:modelValue":r[1]||(r[1]=e=>t.val=e),onBlur:r[2]||(r[2]=e=>t.setValidateOn()),readonly:t.field.readonly},null,40,["name","type","readonly"]),[[e.vModelDynamic,t.val]]),e.withDirectives(e.createVNode(l,{error:t.field.error},null,8,["error"]),[[e.vShow,t.showError]])],64)},o.__file="vite-sdk/src/components/gc-form-input.vue";var n=e.defineComponent({name:"gc-confirm",props:{field:Object,stores:Object},setup:e=>e.stores.exportToViewField(e.field),data:()=>({cval:""}),computed:{name(){return this.field.name+"_confirm"},error(){if(this.isvalidateon)return this.val==this.cval?"":"Doesn't match "+this.field.name}},watch:{cval(e){this.error?this.$emit("confirmerror",1):this.$emit("confirmerror",-1)}},components:{"gc-error":t}});n.render=function(t,r,s,o,i,n){const a=e.resolveComponent("gc-error");return e.openBlock(),e.createBlock(e.Fragment,null,[e.createVNode("label",null,e.toDisplayString(t.field.label),1),e.withDirectives(e.createVNode("input",{name:t.name,type:t.field.atts.type,"onUpdate:modelValue":r[1]||(r[1]=e=>t.cval=e),onBlur:r[2]||(r[2]=e=>t.setValidateOn())},null,40,["name","type"]),[[e.vModelDynamic,t.cval]]),e.withDirectives(e.createVNode(a,{error:t.error},null,8,["error"]),[[e.vShow,t.error]])],64)},n.__file="vite-sdk/src/components/gc-form-confirm.vue";let a,l={},c={},d=!0;var h={regCustomHeader(e,t){l[e]=t},regStatusHandler(e,t){c[e]=t},setURL(e){a=e},regDebug(e){d=e},run:(e,t)=>(t.mode="cors",t.cache="no-cache",t.credentials="include",t["Content-Type"]="application/json",t.headers=l,fetch(a+e,t).then((e=>{if(!c[e.status]){if(401==e.status)return e.status;if(e.ok)return e.json();throw Error(e.statusText)}c[e.status](e)})).then((r=>{if(401==r){let r=t.method;return t.method="PUT",fetch(a+"/core-switch-tokens",t).then((s=>{if(s.ok)return t.method=r,fetch(a+e,t).then((e=>{if(401==e.status)throw new Error("Issue with refresh token");if(e.ok)return e.json()}))}))}return r})).catch((e=>{throw d&&console.log(e),e}))),setDebug:e=>(e?e.__debug=!0:e={__debug:!0},e),get(e,t){if(d&&(t=this.setDebug(t)),t){const r=new URLSearchParams;let s={};for(let e in t)Array.isArray(t[e])||"object"==typeof t[e]&&null!==t[e]?s[e]=t[e]:r.append(e,t[e]);s&&r.append("graph",JSON.stringify(s)),-1==e.indexOf("?")?e+="?":e+="&",e+=r.toString()}let r={method:"GET"};return this.run(e,r)},getprimary(e,t){return this.get(e,t)},post(e,t){d&&(t=this.setDebug(t));let r={method:"POST"};return r.body=JSON.stringify(t),this.run(e,r)},put(e,t){d&&(t=this.setDebug(t));let r={method:"PUT"};return r.body=JSON.stringify(t),this.run(e,r)},patch(e,t){d&&(t=this.setDebug(t));let r={method:"PATCH"};return r.body=JSON.stringify(t),this.run(e,r)},delete(e,t){d&&(t=this.setDebug(t));let r={method:"DELETE"};return r.body=JSON.stringify(t),this.run(e,r)}},u={props:{field:Object,stores:Object,multiple:Boolean},setup:e=>e.stores.exportToViewField(e.field),components:{"gc-error":t}};const p=e.withScopeId("data-v-2db2f132");e.pushScopeId("data-v-2db2f132");const _=e.createVNode("option",{value:"0"},"Select Option",-1);e.popScopeId();const g=p(((t,r,s,o,i,n)=>{const a=e.resolveComponent("gc-error");return e.openBlock(),e.createBlock(e.Fragment,null,[e.createVNode("label",null,e.toDisplayString(s.field.label),1),e.withDirectives(e.createVNode("select",{"onUpdate:modelValue":r[1]||(r[1]=e=>t.val=e),readonly:s.field.readonly,name:s.field.name,multiple:s.multiple},[_,(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(t.options,(t=>(e.openBlock(),e.createBlock("option",{key:t.key,value:t.key},e.toDisplayString(t.value),9,["value"])))),128))],8,["readonly","name","multiple"]),[[e.vModelSelect,t.val]]),e.withDirectives(e.createVNode(a,{error:s.field.error},null,8,["error"]),[[e.vShow,s.field.error]])],64)}));s("\r\n"),u.render=g,u.__scopeId="data-v-2db2f132",u.__file="vite-sdk/src/components/gc-form-select.vue";var m=e.defineComponent({name:"gc-radio",props:{field:Object,stores:Object},data:()=>({isvalidateon:!1}),methods:{setValidateOn(){this.isvalidateon=!0},validate(){let e=this.stores.getData(this.field.name);const t=this.field.validate(e);this.stores.updateField(this.field.name,"error",t)}},computed:{val:{get:function(){return this.stores.getData(this.field.name)},set:function(e){this.stores.setData(this.field.name,e),this.isvalidateon&&this.validate()}}},components:{"gc-error":t}});m.render=function(t,r,s,o,i,n){const a=e.resolveComponent("gc-error");return e.openBlock(),e.createBlock(e.Fragment,null,[e.createVNode("label",null,e.toDisplayString(t.field.label),1),(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(t.options,(s=>(e.openBlock(),e.createBlock("div",{key:s},[e.createVNode("label",null,e.toDisplayString(s.option),1),e.withDirectives(e.createVNode("input",{name:t.cfield.name,type:"radio",value:s.value,"onUpdate:modelValue":r[1]||(r[1]=e=>t.val=e)},null,8,["name","value"]),[[e.vModelRadio,t.val]])])))),128)),e.withDirectives(e.createVNode(a,{error:t.field.error},null,8,["error"]),[[e.vShow,t.field.error]])],64)},m.__file="vite-sdk/src/components/gc-form-radio.vue";var f=e.defineComponent({name:"gc-checkbox",props:{field:Object,stores:Object},setup:e=>e.stores.exportToViewField(e.field),components:{"gc-error":t}});f.render=function(t,r,s,o,i,n){const a=e.resolveComponent("gc-error");return e.openBlock(),e.createBlock(e.Fragment,null,[e.createVNode("label",null,e.toDisplayString(t.field.label),1),e.withDirectives(e.createVNode("input",{type:"checkbox",name:t.field.name,"onUpdate:modelValue":r[1]||(r[1]=e=>t.val=e)},null,8,["name"]),[[e.vModelCheckbox,t.val]]),e.withDirectives(e.createVNode(a,{error:t.field.error},null,8,["error"]),[[e.vShow,t.field.error]])],64)},f.__file="vite-sdk/src/components/gc-form-checkbox.vue";var v=e.defineComponent({name:"gc-textarea",props:{field:Object,stores:{type:Object,required:!0}},setup:()=>props.stores.exportToViewField(props.field),methods:{validate(){let e=this.stores.getData(this.field.name);const t=this.field.validate(e);this.stores.updateField(this.field.name,"error",t)}},components:{"gc-error":t}});v.render=function(t,r,s,o,i,n){const a=e.resolveComponent("gc-error");return e.openBlock(),e.createBlock(e.Fragment,null,[e.createVNode("label",null,e.toDisplayString(t.field.label),1),e.withDirectives(e.createVNode("textarea",{name:t.field.name,"onUpdate:modelValue":r[1]||(r[1]=e=>t.val=e),readonly:t.field.readonly},null,8,["name","readonly"]),[[e.vModelText,t.val]]),e.withDirectives(e.createVNode(a,{error:t.field.error},null,8,["error"]),[[e.vShow,t.field.error]])],64)},v.__file="vite-sdk/src/components/gc-form-textarea.vue";var k=e.defineComponent({name:"gc-asset-field",props:{field:{type:Object,required:!0},stores:{type:Object,required:!0}},setup:e=>e.stores.exportToViewField(e.field),methods:{validate(){let e=this.stores.data[this.field.name];this.stores.fields[this.field_name].error=this.field.validate(e)},setFile(e){e.target.files.length>0?this.val=e.target.files[0]:this.val=null}},components:{"gc-error":t}});k.render=function(t,r,s,o,i,n){const a=e.resolveComponent("gc-error");return e.openBlock(),e.createBlock(e.Fragment,null,[e.createVNode("label",null,e.toDisplayString(t.field.label),1),e.createVNode("input",{ref:"input",onChange:r[1]||(r[1]=(...e)=>t.setFile&&t.setFile(...e)),name:t.field.name,type:"file"},null,40,["name"]),e.withDirectives(e.createVNode(a,{error:t.field.error},null,8,["error"]),[[e.vShow,t.field.error]])],64)},k.__file="vite-sdk/src/components/gc-form-asset.vue";var y={name:"gc-progress-bar",props:{total:Number,progress:Number},computed:{num(){let e=Math.floor(this.progress/this.total*100);return isNaN(e)?0:e},style(){return"width:"+this.num+"%;"}}};const b=e.withScopeId("data-v-76910936");e.pushScopeId("data-v-76910936");const B={class:"gc-holder"};e.popScopeId();const w=b(((t,r,s,o,i,n)=>(e.openBlock(),e.createBlock("div",null,[e.createVNode("div",B,[e.createVNode("div",{class:"gc-bar",style:n.style}," ",4)]),e.createVNode("span",null,e.toDisplayString(n.num)+"%",1)]))));s("\n.gc-holder[data-v-76910936] {\r\n     width : 100%;\r\n     min-height : 10px;\r\n     position : relative;\r\n     display : flex;\r\n     align-items: stretch;\r\n     padding : 2px;\n}\n.gc-bar[data-v-76910936] {\r\n     width : 0;\r\n     height : 100%;\r\n     position : relative;\r\n     line-height : 100%;\n}\r\n\r\n\r\n"),y.render=w,y.__scopeId="data-v-76910936",y.__file="vite-sdk/src/components/gc-progress-bar.vue";const V={1:"too small",2:"too large",3:"contains incorrect characters",4:"doesn't contain required characters",5:"not unique"};var C={getError:function(e){return V[e]}};const x={},S={};function N(e,t={}){let r={label:"",options:{},error:""};for(let t in S)key.regex.test(e)&&(r={...r,...S[t].entry});r={...r,...t},x[e]=r}function D(e){return x[e]}var T={setDictionary:function(e){x=e},setDictionaryTemplate:function(e,t){S[key]={regex:new RegExp(e),entry:t}},createEntry:N,getEntry:D,exportToView:function(e){return{dict:function(e,t){return D(e)},setEntry:function(e,t){let r=N(e);r={...r,...t}}}},get:function(e,t,r){return x[e]&&x[e][t]?x[e][t]:r}},F=e.defineComponent({name:"gc-form",props:{store:{type:Object,required:!0}},data:()=>({fstate:0,progress:0,globalerror:""}),setup:e=>({...e.store.exportToViewBlock(),...T.exportToView(e.store.model+"-"+e.store.action)}),methods:{clearErrors(){this.globalerror="";for(let e in this.store.fields)this.store.fields[e].error=0},submit(e){this.fstate=this.total>0?1:2,this.clearErrors(),this.store.submit().then((()=>{let e=[];for(let t in this.fields)if("asset"==this.fields[t].type){let r=this.store.saveAsset(this.fields[t]).then((()=>{++this.progress})).catch((e=>{this.fstate=0,this.progress=0,this.store.fields[t].error=e}));e.push(r)}return Promise.all(e)})).then((()=>{this.store.runNext()})).catch((e=>{if(this.fstate=0,e.message)this.globalerror=e.message;else for(let t in e)0!==t.indexOf("__")&&this.store.fields[t]&&(this.store.fields[t].error=C.getError(e[t]))}))}},computed:{total(){let e=0;for(let t in this.fields)"asset"==this.fields[t].type&&++e;return e}},components:{"gc-input":o,"gc-confirm":n,"gc-select":u,"gc-radio":m,"gc-checkbox":f,"gc-textarea":v,"gc-asset-field":k,"gc-progress-bar":y}});const O={key:6};F.render=function(t,r,s,o,i,n){const a=e.resolveComponent("gc-select"),l=e.resolveComponent("gc-radio"),c=e.resolveComponent("gc-checkbox"),d=e.resolveComponent("gc-textarea"),h=e.resolveComponent("gc-asset-field"),u=e.resolveComponent("gc-input"),p=e.resolveComponent("gc-confirm"),_=e.resolveComponent("gc-progress-bar");return e.openBlock(),e.createBlock("div",null,[e.withDirectives(e.createVNode("form",{onSubmit:r[1]||(r[1]=e.withModifiers(((...e)=>t.submit&&t.submit(...e)),["prevent"])),class:t.store.classes},[e.createVNode("h1",null,e.toDisplayString(t.dict("title",t.store.title)),1),e.withDirectives(e.createVNode("div",{class:"error"},e.toDisplayString(t.dict("globalerror",t.store.globalerror)),513),[[e.vShow,t.globalerror]]),(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(t.fields,(r=>(e.openBlock(),e.createBlock("div",{key:r.name,class:"gc-form-row"},["select"==r.type?(e.openBlock(),e.createBlock(a,{key:0,field:r,stores:t.store},null,8,["field","stores"])):"radio"==r.type?(e.openBlock(),e.createBlock(l,{key:1,field:r,stores:t.store},null,8,["field","stores"])):"checkbox"==r.type?(e.openBlock(),e.createBlock(c,{key:2,field:r,stores:t.store},null,8,["field","stores"])):"textarea"==r.type?(e.openBlock(),e.createBlock(d,{key:3,field:r,stores:t.store},null,8,["field","stores"])):"asset"==r.type?(e.openBlock(),e.createBlock(h,{key:4,field:r,stores:t.store},null,8,["field","stores"])):(e.openBlock(),e.createBlock(u,{key:5,field:r,stores:t.store},null,8,["field","stores"])),r.confirm?(e.openBlock(),e.createBlock("div",O,[e.createVNode(p,{field:r,stores:t.store},null,8,["field","stores"])])):e.createCommentVNode("v-if",!0),e.createCommentVNode(" REMOVED: ")])))),128)),e.createVNode("input",{type:"submit",value:t.dict("submit","Submit")},null,8,["value"])],34),[[e.vShow,0==t.fstate]]),e.withDirectives(e.createVNode(_,{total:t.total,progress:t.progress},null,8,["total","progress"]),[[e.vShow,1==t.fstate]])])},F.__file="vite-sdk/src/components/gc-form.vue";var L=e.defineComponent({name:"gc-nav",props:{actions:Array},setup:t=>({ctrl:e.inject("ctrl")}),methods:{setRoute(e){e(),this.ctrl.runLink()}}});const j=e.withScopeId("data-v-0ddb4230");e.pushScopeId("data-v-0ddb4230");const A={class:"gc-nav"};e.popScopeId();const E=j(((t,r,s,o,i,n)=>(e.openBlock(),e.createBlock("span",A,[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(t.actions,(r=>(e.openBlock(),e.createBlock("a",{key:r,onClick:e=>{t.setRoute(r.r)}},e.toDisplayString(r.n),9,["onClick"])))),128))]))));s("\r\n"),L.render=E,L.__scopeId="data-v-0ddb4230",L.__file="vite-sdk/src/components/gc-nav.vue";var R={name:"gc-time-range",props:{field:Object,stores:Object},setup:e=>e.stores.exportToViewField(e.field),components:{"gc-error":t}};const U=e.withScopeId("data-v-79505a64")(((t,r,s,o,i,n)=>{const a=e.resolveComponent("gc-error");return e.openBlock(),e.createBlock(e.Fragment,null,[e.createVNode("label",null,e.toDisplayString(t.dict("label",s.field.label)),1),e.withDirectives(e.createVNode("input",{type:"date","onUpdate:modelValue":r[1]||(r[1]=e=>t.val1=e)},null,512),[[e.vModelText,t.val1]]),e.withDirectives(e.createVNode("input",{type:"date","onUpdate:modelValue":r[2]||(r[2]=e=>t.val2=e)},null,512),[[e.vModelText,t.val2]]),e.withDirectives(e.createVNode(a,{error:s.field.error},null,8,["error"]),[[e.vShow,s.field.error]])],64)}));s("\r\n"),R.render=U,R.__scopeId="data-v-79505a64",R.__file="vite-sdk/src/components/gc-filter-form-time.vue";var M=e.defineComponent({name:"gc-checkbox",props:{field:Object,stores:Object},setup:e=>e.stores.exportToViewField(e.field)});const I={value:""},P={value:"1"},z={value:"0"};M.render=function(t,r,s,o,i,n){return e.openBlock(),e.createBlock(e.Fragment,null,[e.createVNode("label",null,e.toDisplayString(t.field.label),1),e.withDirectives(e.createVNode("select",{name:t.field.name,"onUpdate:modelValue":r[1]||(r[1]=e=>t.val=e)},[e.createVNode("option",I,e.toDisplayString(t.dict("all","All")),1),e.createVNode("option",P,e.toDisplayString(t.dict("checked","Checked")),1),e.createVNode("option",z,e.toDisplayString(t.dict("unchecked","Unchecked")),1)],8,["name"]),[[e.vModelSelect,t.val]])],64)},M.__file="vite-sdk/src/components/gc-filter-form-checkbox.vue";var q=e.defineComponent({props:{title:String,active:{type:Boolean,default:!1}},data(){return{show:this.active}},methods:{toggleWidget(){this.show=!this.show}}});const G={class:"gc-widget-window-header"},H=e.createVNode("span",{class:"material-icons"},"more_horiz",-1),J={class:"gc-widget-window-body"};q.render=function(t,r,s,o,i,n){return e.openBlock(),e.createBlock("div",null,[e.createVNode("div",G,[e.createTextVNode(e.toDisplayString(t.title)+" ",1),e.createVNode("a",{class:"gc-widget-window-toggle-view",onClick:r[1]||(r[1]=(...e)=>t.toggleWidget&&t.toggleWidget(...e))},[H])]),e.withDirectives(e.createVNode("div",J,[e.renderSlot(t.$slots,"default")],512),[[e.vShow,t.show]])])},q.__file="vite-sdk/src/components/gc-widget-window.vue";var X=e.defineComponent({name:"gc-filter-form",props:{store:{type:Object,required:!0}},setup:e=>e.store.exportToViewBlock(),methods:{submit(){this.store.submit()}},components:{"gc-input":o,"gc-select":u,"gc-checkbox":f,"gc-time-range":R,"gc-filter-checkbox":M,"gc-widget":q}});const Y=e.withScopeId("data-v-6afc4706");e.pushScopeId("data-v-6afc4706");const $=e.createVNode("input",{type:"submit",value:"Submit"},null,-1);e.popScopeId();const K=Y(((t,r,s,o,i,n)=>{const a=e.resolveComponent("gc-select"),l=e.resolveComponent("gc-filter-checkbox"),c=e.resolveComponent("gc-time-range"),d=e.resolveComponent("gc-input"),h=e.resolveComponent("gc-widget");return e.openBlock(),e.createBlock(h,{title:"search"},{default:Y((()=>[e.createVNode("form",{onSubmit:r[1]||(r[1]=e.withModifiers(((...e)=>t.submit&&t.submit(...e)),["prevent"])),class:"gc-filter-form"},[e.createVNode("h1",null,"Search "+e.toDisplayString(t.store.title),1),(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(t.store.fields,(r=>(e.openBlock(),e.createBlock("div",{key:r.name},["select"==r.type?(e.openBlock(),e.createBlock(a,{key:0,field:r,multiple:!0,stores:t.store},null,8,["field","stores"])):"checkbox"==r.type?(e.openBlock(),e.createBlock(l,{key:1,field:r,stores:t.store},null,8,["field","stores"])):e.createCommentVNode("v-if",!0),"time"==r.type?(e.openBlock(),e.createBlock(c,{key:2,field:r,stores:t.store},null,8,["field","stores"])):(e.openBlock(),e.createBlock(d,{key:3,field:r,stores:t.store},null,8,["field","stores"])),e.createCommentVNode(" REMOVED: ")])))),128)),$],32)])),_:1})}));s("\n.error[data-v-6afc4706] {\r\n  color : red;\n}\r\n\r\n"),X.render=K,X.__scopeId="data-v-6afc4706",X.__file="vite-sdk/src/components/gc-filter-form.vue";var W=e.defineComponent({props:{max_page_limit:Number},setup:e=>({groups:Math.ceil(e.pages/e.max_page_limit),current_group:0}),computed:{firstindex(){return this.current_group*this.max_options},maxoptions:()=>[]},methods:{showPages(e){let t=Controller.current_route.value,r=t+"#";t.query&&(r+=t.query+"&"),r+="__page="+(this.firstindex+e),Router.setRoute(r)}}});const Q={class:"gc-pagination"};W.render=function(t,r,s,o,i,n){return e.openBlock(),e.createBlock("div",Q,[e.withDirectives(e.createVNode("a",{onClick:r[1]||(r[1]=e=>{t.showPages(-1)})},"<<",512),[[e.vShow,t.optiongroup>0]]),(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(t.maxoptions,(r=>(e.openBlock(),e.createBlock("a",{key:r,onClick:e=>t.page(r)},e.toDisplayString(t.firstindex+r),9,["onClick"])))),128)),e.withDirectives(e.createVNode("a",{onClick:r[2]||(r[2]=e=>t.showPages(1))},">>",512),[[e.vShow,t.current_group<t.groups-1]])])},W.__file="vite-sdk/src/components/gc-pagination.vue";var Z=e.defineComponent({props:{store:{type:Object,required:!0}},setup(e){T.createEntry("gc-selectfields",{button:"Select Fields",update:"Update"})},methods:{dict:(e,t)=>T.get("gc-selectfields",e,t),update(){this.store.load()},toggle(e){let t=this.store.selectedfields.indexOf(e);t>-1?this.store.selectedfields.splice(t,1):this.store.selectedfields.push(e)}},components:{"gc-widget":q}});Z.render=function(t,r,s,o,i,n){const a=e.resolveComponent("gc-widget");return e.openBlock(),e.createBlock(a,{title:t.dict("button","select fields")},{default:e.withCtx((()=>[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(t.store.selectfields,(r=>(e.openBlock(),e.createBlock("div",{key:r},[e.createVNode("input",{type:"checkbox",onClick:e=>t.toggle(r),value:r,checked:t.store.selectedfields.includes(r)},null,8,["onClick","value","checked"]),e.createTextVNode(" "+e.toDisplayString(r),1)])))),128)),e.createVNode("button",{onClick:r[1]||(r[1]=e.withModifiers(((...e)=>t.update&&t.update(...e)),["stop"]))},e.toDisplayString(t.dict("update","select")),1)])),_:1},8,["title"])},Z.__file="vite-sdk/src/components/gc-selectfields.vue";var ee={name:"gc-header",props:{store:{type:Object,required:!0}},setup:e=>e.store.exportToViewBlock(),methods:{updateFields(e){this.store.load()}},components:{"gc-nav":L,"gc-filter-form":X,"gc-pagination":W,"gc-selectfields":Z}};const te={key:0,class:"gc-nav"};ee.render=function(t,r,s,o,i,n){const a=e.resolveComponent("gc-filter-form"),l=e.resolveComponent("gc-selectfields");return e.openBlock(),e.createBlock(e.Fragment,null,[e.createVNode("h1",null,e.toDisplayString(s.store.title),1),s.store.actions.post?(e.openBlock(),e.createBlock("span",te,[e.createVNode("a",{onClick:r[1]||(r[1]=e=>{t.setRoute(s.store.actions.post.r)})},e.toDisplayString(s.store.actions.post.n),1)])):e.createCommentVNode("v-if",!0),e.createVNode(a,{store:s.store},null,8,["store"]),e.createVNode(l,{store:s.store},null,8,["store"])],64)},ee.__file="vite-sdk/src/components/gc-repo-header.vue";var re={name:"gc-tree-node",props:{branch:{type:Object,required:!0},draggable:Boolean,store:{type:Object,required:!0},ischild:{type:Boolean,default:!1}},data:()=>({toggle_state:{}}),setup:e=>e.store.exportToViewBlock(),methods:{toggle(e){this.toggle_state[e]=!this.toggle_state[e]},setDraggable(e){e.target.closest(".gc-draggable").setAttribute("draggable",!0)},endDraggable(e){e.target.closest(".gc-draggable").setAttribute("draggable",!1)},selectRow(e){this.store.next(e)}},computed:{sortable:()=>!0,children(){let e=[];this.store.circular&&this.branch[this.store.model]&&(e=this.branch[this.store.model]);for(let t in this.store.activechildren)this.branch[this.store.activechildren[t]]&&(e=e.concat(this.branch[this.store.activechildren[t]]));return e}},components:{}};const se=e.withScopeId("data-v-cdc115c4");e.pushScopeId("data-v-cdc115c4");const oe=e.createVNode("span",{class:"material-icons"},"subdirectory_arrow_right",-1),ie=e.createVNode("span",{class:"material-icons"},"keyboard_arrow_right",-1),ne={key:0},ae=e.createVNode("span",{class:"material-icons"},"drag_handle",-1);e.popScopeId();const le=se(((t,r,s,o,i,n)=>{const a=e.resolveComponent("gc-tree-node",!0);return e.openBlock(),e.createBlock("div",{class:"gc-draggable",id:s.branch[s.store.primarykey],draggable:"false"},[e.createVNode("div",{class:"gc-data-row",onClick:r[6]||(r[6]=e=>{n.selectRow(s.branch[s.store.primarykey])})},[e.createVNode("div",null,[s.ischild?(e.openBlock(),e.createBlock("a",{key:0,"data-action":"more",class:"button",onClick:r[1]||(r[1]=e.withModifiers((e=>n.toggle(s.branch[s.store.primarykey],!1)),["prevent","stop"]))},[oe])):(e.openBlock(),e.createBlock("a",{key:1,"data-action":"more",class:"button",onClick:r[2]||(r[2]=e.withModifiers((e=>n.toggle(s.branch[s.store.primarykey],!0)),["prevent","stop"]))},[ie]))]),n.sortable?(e.openBlock(),e.createBlock("div",ne,[e.createVNode("a",{"data-action":"more",class:"button",onClick:r[3]||(r[3]=(...e)=>t.prevent.stop&&t.prevent.stop(...e)),onMousedown:r[4]||(r[4]=(...e)=>n.setDraggable&&n.setDraggable(...e)),onMouseup:r[5]||(r[5]=(...e)=>n.endDraggable&&n.endDraggable(...e))},[ae],32)])):e.createCommentVNode("v-if",!0),(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(t.fields,((t,r)=>(e.openBlock(),e.createBlock("div",{key:r},[e.createVNode("span",null,e.toDisplayString(s.branch[t.name]),1)])))),128))]),(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.children,((t,r)=>e.withDirectives((e.openBlock(),e.createBlock(a,{branch:t,ischild:!0,key:r,store:s.store},null,8,["branch","store"])),[[e.vShow,i.toggle_state[s.branch[s.store.primarykey]]]]))),128))],8,["id"])}));s("\n.model-tree.branch[data-v-cdc115c4] {\r\n  padding-left: 8px;\r\n  padding-right: 8px;\r\n  margin: 6px 0;\r\n  background-color:#111111;\n}\n.tree .ide-block[data-v-cdc115c4] {\r\n\tdisplay : none;\n}\n.dragArea[data-v-cdc115c4] {\r\n  min-height: 50px;\r\n  outline: 1px solid #777777;\n}\r\n\r\n\r\n"),re.render=le,re.__scopeId="data-v-cdc115c4",re.__file="vite-sdk/src/components/gc-tree-node.vue";class ce{constructor(e={}){this._handle=e.handle,this._drop_target=e.drop_target,this._drag_target=e.drag_target,this._call_back=e.callback,this._x=0,this._y=0,this._offset_x=0,this._offset_y=0,this._judder=e.judder?e.judder:5,this._drag_node,this._drop_node,this._tree=e.tree}isJudder(e,t){const r=e-this._x,s=t-this._y;return!(r<-5||r>5)&&!(s<-5||s>5)}getDirection(e,t){return{x:e==this._x?0:e>this._x?1:-1,y:t==this._y?0:t>this._y?1:-1}}offset(e){var t=e.getBoundingClientRect(),r=e.ownerDocument.defaultView;return{top:t.top+r.pageYOffset,left:t.left+r.pageXOffset}}insertAfter(){let e=this._drag_node.getAttribute("id"),t=this._drop_node.getAttribute("id"),r=0,s=0;if(this._drop_node.nextElementSibling){for(let e in this._tree){let o=this._tree[e];if(o.id==t){r=o.circular,s=o.sort;break}}for(let t in this._tree){let o=this._tree[t];o.id==e?(o.circular=r,o.sort=s+1):o.circular==r&&o.sort>s&&++o.sort}}else for(let t in this._tree){let s=this._tree[t];s.id==e&&(s.circular=r,s.sort=0)}}insertBefore(){let e=this._drag_node.getAttribute("id"),t=this._drop_node.getAttribute("id"),r=0,s=0;for(let e in this._tree){let o=this._tree[e];if(o.id==t){r=o.circular,s=o.sort,++o.sort;break}}for(let t in this._tree){let o=this._tree[t];o.id==e?(o.circular=r,o.sort=s):o.circular==r&&o.sort>s&&++o.sort}}dragStart(e){const t=e.target.closest("[id]");this._drag_node=t;const{top:r,left:s}=this.offset(t);e.dataTransfer.dropEffect="move",this._x=e.clientX,this._y=e.clientY,this._offset_x=e.clientX-s,this._offset_y=e.clientY-r}isDroppable(e){return!!e.target.closest(this._drop_target)}dragEnter(e){if(!this.isDroppable(e))return!0;if(e.preventDefault(),e.dataTransfer.dropEffect="move",this._drop_node=e.target.closest(this._drag_target),!this._drop_node||this._drop_node.getAttribute("id")==this._drag_node.getAttribute("id"))return;const t=this.getDirection(e.clientX,e.clientY);1==t.y?this.insertAfter():-1==t.y&&this.insertBefore(),this._x=e.clientX,this._y=e.clientY}dragOver(e){if(!this.isDroppable(e))return!0;e.preventDefault(),e.dataTransfer.dropEffect="move"}dragEnd(){this._drag_node&&this._drag_node.setAttribute("draggable",!1),this._drag_node=null}drop(e){if(!this._drop_node)return!0;e.preventDefault(),this._call_back&&this._call_back(this._tree)}}var de={initDD:function(e){let t=new ce(e);if(document.querySelectorAll(e.handle).forEach((e=>e.addAttribute("draggable",!0))),e.handle){document.querySelectorAll(e.handle).forEach((t=>{t.addEventListener("mousedown",(t=>{t.target.closest(e.drag_target).addAttribute("draggable",!0)}))}))}e.main.addEventListener("dragstart",(e=>t.dragStart(e))),e.main.addEventListener("dragenter",(e=>t.dragEnter(e))),e.main.addEventListener("dragover",(e=>t.dragOver(e))),e.main.addEventListener("drop",(e=>t.drop(e))),e.main.addEventListener("dragend",(e=>t.dragEnd(e)))}},he={name:"gc-tree",props:{store:{type:Object,required:!0}},setup(t){const r=e.ref(null);let s=t.store.exportToViewBlock();return e.onMounted((()=>{de.initDD({handle:".gc-drag-handle",drag_target:".gc-draggable",drop_target:".gc-drop-target",main:r.value,tree:t.store.data,callback:t.store.saveSort})})),{...s,treeroot:r}},components:{"gc-nav":L,"gc-tree-node":re,"gc-filter-form":X,"gc-selectfields":Z}};const ue={class:"gc-data-header"},pe=e.createVNode("div",null," ",-1),_e={key:0},ge={class:"gc-tree gc-drop-target",ref:"treeroot"};he.render=function(t,r,s,o,i,n){const a=e.resolveComponent("gc-tree-node");return e.openBlock(),e.createBlock("div",{class:s.store.classes},[e.createVNode("div",ue,[pe,(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(t.fields,(t=>(e.openBlock(),e.createBlock("div",{key:t.name,class:t.name},e.toDisplayString(t.label),3)))),128)),s.store.sort?(e.openBlock(),e.createBlock("div",_e," ")):e.createCommentVNode("v-if",!0)]),e.createVNode("div",ge,[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(s.store.data,((t,r)=>(e.openBlock(),e.createBlock(a,{key:r,branch:t,store:s.store},null,8,["branch","store"])))),128))],512)],2)},he.__file="vite-sdk/src/components/gc-tree.vue";var me={name:"gc-table",props:{store:{type:Object,required:!0}},setup:e=>e.store.exportToViewBlock(),methods:{orderBy(e,t){let r={};r[e.name]=t,this.store.orderby=r,this.store.pages>0?this.store.load():t?this.store.data.sort((function(t,r){let s=t[e.name],o=r[e.name];return s<o?-1:s>o?1:0})):this.store.data.sort((function(t,r){let s=t[e.name],o=r[e.name];return s<o?1:s>o?-1:0}))}},computed:{sortable(){return!!this.store.sort},overlimit:()=>!1,primarykey(){return this.store.primarykey}},components:{"gc-pagination":W}};const fe=e.withScopeId("data-v-772343ca");e.pushScopeId("data-v-772343ca");const ve={class:"gc-data-table"},ke={class:"gc-data-header"},ye={key:0},be={class:"gc-data-tbody"},Be={key:0},we=e.createVNode("span",{class:"material-icons"},"drag",-1);e.popScopeId();const Ve=fe(((t,r,s,o,i,n)=>{const a=e.resolveComponent("gc-pagination");return e.openBlock(),e.createBlock("div",{class:s.store.classes},[e.createVNode("table",ve,[e.createVNode("thead",null,[e.createVNode("tr",ke,[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(t.fields,(t=>(e.openBlock(),e.createBlock("th",{key:t.name,class:t.name},[e.createTextVNode(e.toDisplayString(t.label)+" ",1),0==n.sortable?(e.openBlock(),e.createBlock("span",{key:0,class:"material-icons",onClick:e=>{n.orderBy(t,!1)}},"keyboard_arrow_up",8,["onClick"])):e.createCommentVNode("v-if",!0),0==n.sortable?(e.openBlock(),e.createBlock("span",{key:1,class:"material-icons",onClick:e=>{n.orderBy(t,!0)}},"keyboard_arrow_down",8,["onClick"])):e.createCommentVNode("v-if",!0)],2)))),128)),n.sortable?(e.openBlock(),e.createBlock("th",ye," ")):e.createCommentVNode("v-if",!0)])]),e.createVNode("tbody",be,[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(s.store.data,((o,i)=>(e.openBlock(),e.createBlock("tr",{class:"gc-data-row",key:i,onClick:e=>{s.store.next(o[n.primarykey])}},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(t.fields,((t,r)=>(e.openBlock(),e.createBlock("td",{key:r,class:t.name},e.toDisplayString(o[t.name]),3)))),128)),n.sortable?(e.openBlock(),e.createBlock("td",Be,[e.createVNode("a",{"data-action":"more",class:"button",onClick:r[1]||(r[1]=e.withModifiers(((...e)=>t.toggle&&t.toggle(...e)),["prevent"])),draggable:"true"},[we])])):e.createCommentVNode("v-if",!0)],8,["onClick"])))),128))])]),n.overlimit?(e.openBlock(),e.createBlock(a,{key:0})):e.createCommentVNode("v-if",!0)],2)}));s("\n.table[data-v-772343ca], .thead[data-v-772343ca], .tbody[data-v-772343ca], .tr[data-v-772343ca] {\r\n    width : 100%;\n}\r\n\r\n\r\n"),me.render=Ve,me.__scopeId="data-v-772343ca",me.__file="vite-sdk/src/components/gc-table.vue";var Ce={name:"gc-repo",props:{store:{type:Object,required:!0},active:{type:Boolean,default:!1}},setup(e){let t=e.store.exportToViewBlock();return t.key=e.store.model+"-"+e.store.action,t},components:{"gc-repo-header":ee,"gc-tree":he,"gc-table":me}};const xe=e.withScopeId("data-v-19e0d3b5")(((t,r,s,o,i,n)=>{const a=e.resolveComponent("gc-repo-header");return s.active?(e.openBlock(),e.createBlock("div",{key:0,class:s.store.classes},[e.createVNode(a,{store:s.store},null,8,["store"]),(e.openBlock(),e.createBlock(e.resolveDynamicComponent(s.store.rawcomponent),{key:t.key,store:s.store},null,8,["store"]))],2)):e.createCommentVNode("v-if",!0)}));let Se;function Ne(e){e||(e=window.location.pathname),Se&&Se(e)}s("\n.table[data-v-19e0d3b5], .thead[data-v-19e0d3b5], .tbody[data-v-19e0d3b5], .tr[data-v-19e0d3b5] {\r\n    width : 100%;\n}\n.gc-data-row[data-v-19e0d3b5]:nth-child(odd) {background : #CCC}\r\n\r\n"),Ce.render=xe,Ce.__scopeId="data-v-19e0d3b5",Ce.__file="vite-sdk/src/components/gc-repo.vue",window.onpopstate=function(e){Ne(document.location)};var De={setRoute:function(e,t=""){window.history.pushState({name:e},document.title,e),Ne(e)},hardSetRoute:function(e){window.location=e},runRoute:Ne,regCallback:function(e){Se=e}},Te=e.defineComponent({name:"gc-nav",props:{state:Object},methods:{setRoute(e){De.switchRoute(e)}},computed:{arr:()=>De.history}});const Fe={class:"gc-breadcrumbs"};Te.render=function(t,r,s,o,i,n){return e.openBlock(),e.createBlock("span",Fe,[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(t.arr,(r=>(e.openBlock(),e.createBlock("a",{key:r,onClick:e=>{t.setRoute(r.r)}},e.toDisplayString(r.n),9,["onClick"])))),128))])},Te.__file="vite-sdk/src/components/gc-breadcrumbs.vue";var Oe=e.defineComponent({name:"gc-single-item",props:{store:Object,active:{type:Boolean,default:!1}},setup:e=>e.store.exportToViewBlock(),computed:{editnav(){return this.store.actions.put},delnav(){return this.store.actions.delete},title(){return this.store.title+" "+this.store.summary()}},methods:{runDel(){this.store.runDelete()}},components:{"gc-nav":L,"gc-breadcrumbs":Te,"gc-widget":q}});const Le={class:"gc-nav"};Oe.render=function(t,r,s,o,i,n){const a=e.resolveComponent("gc-breadcrumbs"),l=e.resolveComponent("gc-widget");return e.openBlock(),e.createBlock(e.Fragment,null,[e.createVNode(a,{state:t.store},null,8,["state"]),e.createVNode(l,{title:t.title,active:t.active},{default:e.withCtx((()=>[e.createVNode("div",{class:t.store.classes},[e.createVNode("h1",null,e.toDisplayString(t.store.title),1),e.createVNode("span",Le,[t.editnav?(e.openBlock(),e.createBlock("a",{key:0,onClick:r[1]||(r[1]=e=>{t.setRoute(t.editnav.r,t.editnav.params)})},e.toDisplayString(t.editnav.n),1)):e.createCommentVNode("v-if",!0),t.delnav?(e.openBlock(),e.createBlock("a",{key:1,onClick:r[2]||(r[2]=e=>{t.runDel()})},e.toDisplayString(t.delnav.n),1)):e.createCommentVNode("v-if",!0)]),(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(t.store.fields,((r,s)=>(e.openBlock(),e.createBlock("div",{key:s,class:r.name},[e.createVNode("span",null,e.toDisplayString(r.label)+":",1),e.createVNode("span",null,e.toDisplayString(t.store.data[r.name]),1)],2)))),128))],2)])),_:1},8,["title","active"])],64)},Oe.__file="vite-sdk/src/components/gc-single-item.vue";var je=e.defineComponent({name:"gc-login",props:{store:Object},setup:e=>({...e.store.exportToViewBlock(),...T.exportToView(e.store.model+"-"+e.store.action)}),computed:{hasLogin(){return!("post"!=this.store.getModelType()||!this.store.actions.login)},hasPost(){return!("login"!=this.store.getModelType()||!this.store.actions.post)}},components:{"gc-form":F}});const Ae={key:0,class:"gc-nav"},Ee={key:1,clas:"gc-nav"};je.render=function(t,r,s,o,i,n){const a=e.resolveComponent("gc-form");return e.openBlock(),e.createBlock("div",null,[e.createVNode(a,{store:t.store},null,8,["store"]),e.createVNode("div",null,[t.hasPost?(e.openBlock(),e.createBlock("span",Ae,[e.createVNode("a",{onClick:r[1]||(r[1]=e=>{t.setRoute(t.store.actions.post.r)})},e.toDisplayString(t.dict("post",t.store.actions.post.n)),1)])):e.createCommentVNode("v-if",!0),t.hasLogin?(e.openBlock(),e.createBlock("span",Ee,[e.createVNode("a",{onClick:r[2]||(r[2]=e=>{t.setRoute(t.store.actions.login.r)})},e.toDisplayString(t.dict("post",t.store.actions.login.n)),1)])):e.createCommentVNode("v-if",!0)])])},je.__file="vite-sdk/src/components/gc-accounthandler.vue";var Re=e.defineComponent({props:{group:{type:Object,required:!0},active:{type:Boolean,default:!1}},setup:t=>({ctrl:e.inject("ctrl"),group:t.group}),computed:{key(){return this.model?this.model.model+"-"+this.model.action:""},actions(){return this.group.siblings.set},model(){return this.group.model},component(){return this.model?this.model.component:""},actualcomponent(){}},components:{"gc-form":F,"gc-nav":L,"gc-single-item":Oe,"gc-account-handler":je,"gc-repo":Ce}});const Ue={class:"gc-tabs"},Me={class:"tab"};Re.render=function(t,r,s,o,i,n){const a=e.resolveComponent("gc-nav");return e.openBlock(),e.createBlock("div",Ue,[e.createVNode(a,{actions:t.actions},null,8,["actions"]),e.createVNode("div",Me,[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.component),{key:t.key,store:this.group.model,active:this.group.active},null,8,["store","active"]))])])},Re.__file="vite-sdk/src/components/gc-tabs.vue";var Ie={encodeParams:function(e){let t={},r=[];for(let s in e)"object"==typeof e[s]&&e[s]||Array.isArray(e[s])?t[s]=e[s]:r.push(s+"="+encodeURIComponent(e[s]));return Object.keys(t).length>0&&r.push("graph="+encodeURIComponent(JSON.stringify(t))),r.join("&")},decodeParams:function(){const e=new URLSearchParams(window.location.search);let t={};return e.forEach((function(e,r){if("graph"==r){let r=JSON.parse(decodeURIComponent(e));t={...t,...r}}else t[r]=e})),t},mapParams:function(e,t){for(let r in t){const s=new RegExp("${"+r+"}","g");e=e.replace(s,t[r])}return e}};let Pe="",ze=[],qe={};function Ge(e){let t=(e=e.replace(Pe,"")).split("/c");for(let e in t){if(ze.length<=e)throw"Controller hasn't been registered";ze[e].convertFromURL(t[e])}}function He(){let e=[];for(let t of ze)e.push(t.convertToURL());let t=Pe+e.join("/c");const r=Ie.encodeParams(qe);return r&&(t+="?"+r),t}De.regCallback(Ge);var Je={regCtrl:function(e){ze.push(e)},regParam:function(e,t){qe[e]=t},removeParam:function(e){delete qe[e]},setBase:function(e){e=e.replace(/^\/+|\/+$/g,""),Pe="/"+e},convertToURL:He,runRoute:function(){const e=He();De.setRoute(e)},reloadFromBase:function(e){e&&(e=e.replace(/^\/+/g,"")),De.hardSetRoute(Pe+"/"+e)},convertFromURL:Ge},Xe=e.defineComponent({setup(){},methods:{logout(){h.post("/core-logout").then((e=>{Je.reloadFromBase()}))}}});Xe.render=function(t,r,s,o,i,n){return e.openBlock(),e.createBlock("a",{onClick:r[1]||(r[1]=(...e)=>t.logout&&t.logout(...e))},"Logout")},Xe.__file="vite-sdk/src/components/gc-account-details.vue";var Ye=e.defineComponent({name:"gc-root",setup:()=>({ctrl:e.inject("ctrl")}),computed:{groups(){return this.ctrl.store.groups},isaccount(){return"public"!=this.ctrl.store.profile}},components:{"gc-tabs":Re,"gc-nav":L,"gc-account-details":Xe}});Ye.render=function(t,r,s,o,i,n){const a=e.resolveComponent("gc-account-details"),l=e.resolveComponent("gc-nav"),c=e.resolveComponent("gc-tabs");return e.openBlock(),e.createBlock(e.Fragment,null,[t.isaccount?(e.openBlock(),e.createBlock(a,{key:0})):e.createCommentVNode("v-if",!0),(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(t.groups,((t,r)=>(e.openBlock(),e.createBlock("div",{class:"gc-root gc-wrapper",key:r},[e.createVNode(l,{actions:t.actions},null,8,["actions"]),e.createVNode(c,{group:t},null,8,["group"])])))),128))],64)},Ye.__file="vite-sdk/src/components/gc-root.vue";class $e{constructor(){this._min,this._max,this._has=[],this._has_not=[],this._errors={OK:0,MIN_VALUE:1,MAX_VALUE:2,HAS:3,HAS_NOT:4}}set min(e){this._min=e}set max(e){this._max=e}set has(e){this._has.push(e)}set nothas(e){this._has_not.push(e)}validateSize(e){return e<this._min?this._errors.MIN_VALUE:e>this._max?this._errors.MAX_VALUE:this._errors.OK}validate(e){let t;if(isNaN(e)){const r=e?e.length:0;t=this.validateSize(r)}else t=this.validateSize(e);if(t!=this._errors.OK)return t;for(let t of this._has_not)if(e.match(t))return this._errors.HAS_NOT;if(0==this._has.length)return this._errors.OK;for(let t of this._has)if(e.match(this._has))return this._errors.OK;return this._errors.HAS}}class Ke{constructor(e,t=null){if(this._name=e,this._type,this._is_primary=!1,this._is_parent=!1,this._valid=1,this._atts={},this._confirm=!1,this._readonly=!1,this._placeholder="",this._conditions,this._link,this._reference,this._error=0,this._label="",this._on=!0,this._summary=!1,this._default=null,this._validator=new $e,t){for(let e in t)"field"!=e&&"validator"!=e&&(this[e]=t[e]);if(t.field)for(let e in t.field)this[e]=t.field[e];if(t.validation)for(let e in t.validation)this._validator[e]=t.validation[e]}}set confirm(e){this._confirm=e}set readonly(e){this._readonly=e}set placeholder(e){this._placeholder=e}set atts(e){this._atts=e}set default(e){this._default=e}set conditions(e){this._conditions=e}set link(e){this._link=e}set name(e){this._name=e}set type(e){this._type=e}set on(e){this._on=e}set is_primary(e){this._is_primary=e}set is_parent(e){this._is_parent=e}set reference(e){this._reference=e}set error(e){this._error=e}set label(e){this._label=e}set summary(e){this._summary=e}get name(){return this._name}get type(){return this._type}get isprimary(){return this._is_primary}get required(){return this._min>0}get summary(){return this._summary}get readonly(){return this._readonly}get placeholder(){return this._placeholder}get default(){return this._default}get on(){return this._on}get atts(){return this._atts}get conditions(){return this._conditions}get link(){return this._link}get isparent(){return this._is_parent}get confirm(){return this._confirm}get reference(){return this._reference}get error(){return this._error?isNaN(this._error)?this._error:C.getError(this._error):""}get label(){return this._label}validate(e){return this._validator.validate(e)}exp(){return{name:this._name,type:this._type,atts:this._atts}}calcValue(e){return e||""}}class We{constructor(t,r,s){this._model=t,this._action=null,this._api_urls=s.api_urls,this._primary_key=s.primarykey,this._parent_key=s.parentkey,this._parent_value=r,this._key=0,this._params={},this._fields=e.reactive(s.fields),this._data=e.reactive({}),this._label=s.label,this._title=s.title,this._component,this._actions=null,this._next=null,this._custom=s.custom?s.custom:{};for(let e in s)"_"!=e.charAt(0)?this["_"+e]=s[e]:this[e]=s[e]}get classes(){return this._model.replace("/","")+" gc-"+this._action+" gc-"+this.getModelType()+" "+this._component}get action(){return this._action}get model(){return this._model}get component(){return this._component}get apiurls(){return this._api_urls}get isinit(){return this._init}get parentkey(){return this._parent_key}get primarykey(){return this._primary_key}get key(){return this._key}get component(){return this._component}get data(){return this._data}get fields(){return this._fields}get states(){return this._states}get params(){return this._params}get title(){return this._title}get label(){return this._label}get data(){return this._data}get actions(){return this._actions}get next(){return this._next}get all_fields(){return this._fields}get parentvalue(){return this._parent_value}set params(e){this._params=e}set action(e){this._action=e}set apiurls(e){this._api_urls=e}set action(e){this._action=e}set component(e){this._component=e}set custom_actions(e){this._custom_actions=e}set actions(e){this._actions=e}set next(e){this._next=e}set parentvalue(e){this._parent_value=e}addParam(e,t){this._params[e]=t}initFields(e,t){this._fields[e]=new Ke(e,t)}exportToViewBlock(){let t=e.inject("ctrl");return{...{setRoute:function(e){e(),t.runLink()},fields:e.computed((()=>{let e={};for(let t in this._fields)this._fields[t].on&&(e[t]=this._fields[t]);return e})),ctrl:t},...T.exportToView(this.model+"-"+this.action)}}exportToViewField(t){let r=e.ref(!1),s={isvalidateon:r,setValidateOn:()=>{r.value=!0},showError:e.computed((()=>!(!r.value||!t.error))),validate:()=>{let e=this._data[t.name];this._fields[t.name].error=t.validate(e)}};if("select"==t.type)if(t.reference){s.options=e.reactive([]);let r={};this._parent_key&&(r[this._parent_key]=this.parentvalue),h.get(t.reference,r).then((e=>{for(let t in e.__data)0!==t.indexOf("__")&&s.options.push({key:e.__data[t].id,value:e.__data[t].value})})).catch((e=>{console.log(e)}))}else{s.options=[];for(let e of t.atts.options)s.options.push({key:e,value:e})}return{...s,...T.exportToView(this.model+"-"+this.action+"-"+t.name)}}runNext(){this._next&&this._next(this)}}class Qe{constructor(){this._size=0,this._blob=null,this._uploaded=!1,this._chunk_size=0,this._load_url,this._save_url,this._key=0}set chunk_size(e){this._chunk_size=e}set blob(e){this._blob=e}set load_url(e){this._load_url=e}set save_url(e){this._save_url=e}set key(e){this._key=e}get blob(){return this._blob}get size(){return this._size}get uploaded(){return this._uploaded}get chunk_size(){return this._chunk_size}get url(){return this._url}getChunk(e){const t=0==this._chunk_size?0:e*this._chunk_size;let r=0==this._chunk_size?this._size:(e+1)*this._chunk_size;r>this._size&&(r=this._size);const s=new DataView(this._blob,t,r-t);let o=[];for(let e=0,t=s.byteLength;e<t;++e)o.push(s.getInt8(e));return o.join("")}uploadAsset(e,t,r){return h.put(e,t).then((()=>{r&&r()})).catch((e=>{alert(e)}))}loadFile(e){}saveFile(e,t,r){return this._size=e.size,new Promise(((t,r)=>{const s=new FileReader;let o=this;s.onload=function(e){o.blob=e.target.result,t(s.result)},s.onerror=r,s.readAsArrayBuffer(e)})).then((()=>{let e=[],s=0==this.chunk_size?1:Math.ceil(this.size/this.chunk_size);for(let o=0;o<s;++o){const s={};s.__chunk=o,s.__blob=this.getChunk(o),s.id=t,e.push(this.uploadAsset(this.save_url,s,r))}return Promise.all(e)}))}}class Ze extends We{constructor(t,r,s){super(t,r,s),this._status=e.reactive({total:0,progress:0});for(let e in this._fields)this._fields[e].atts&&"password"==this._fields[e].atts.type&&(this._fields[e].confirm=!0);this._component="gc-form"}getModelType(){return"post"}get status(){return this._status}load(){for(let e in this._fields)if("asset"==this._fields[e].type){let t=this._fields[e].name.replace("_","-");this._data[e]=new Qe,this._data[e].save_url=this._api_urls.save+"-"+t,this._data[e].chunk_size=this._fields[e].chunk_size}else this._data[e]=this._fields[e].default;if(this._custom.load)return this._custom.load(this)}saveAsset(e){const t=this._data[e.name];if(!t)return Promise.resolve();asset.saveFile(t,this._key,(()=>++this._status.progress)),this._status.total+=asset.num_chunks}submit(){let e=this._data;return this._parent_key&&(e[this._parent_key]=this.parentvalue),h.post(this._api_urls.save,e).then((e=>{if("SUCCESS"!=e.__status)throw e;this._data[this._primary_key]=e[this._primary_key]})).then((()=>{if(this._custom.submit)return this._custom.submit(this)}))}exportToViewField(t){let r=super.exportToViewField(t);return r.val=e.computed({get:()=>"checkbox"==t.type?Boolean(this._data[t.name]):this._data[t.name],set:e=>{this._data[t.name]=e,r.validate()}}),r}}class et extends We{constructor(t,r,s){super(t,r,s),this._has_changes={},this._status=e.reactive({total:0,progress:0});for(let e in this._fields)this._fields[e].atts&&"password"==this._fields[e].atts.type&&(this._fields[e].confirm=!0)}getModelType(){return"put"}get component(){return"gc-form"}get status(){return this._status}load(e){let t={};return t[this._primary_key]=e,this._data[this._primary_key]=e,h.get(this._api_urls.load,t).then((e=>{for(let t in this._fields)if("asset"==this._fields[t].type){let e=this._fields[t].name.replace("_","-");this._data[t]=new Qe,this._data[t].load_url=this._api_urls.load_url+"-"+e,this._data[t].save_url=this._api_urls.save+"-"+e,this._data[t].chunk_size=this._fields[t].chunk_size,this._data[t].key=this._key}else this._data[t]=e[t]})).then((()=>{if(this._custom.load)return this._custom.load(this)})).catch((e=>{alert(e)}))}saveAsset(e){const t=this._data[e.name];if(!t)return Promise.resolve();asset.saveFile(t,this._key,(()=>++this._status.progress)),this._status.total+=asset.num_chunks}submit(){return h.put(this._api_urls.save,this._data).then((e=>{if("SUCCESS"!=e.__status)throw e})).then((()=>{if(this._custom.submit)return this._custom.submit(this)}))}exportToViewField(t){let r=super.exportToViewField(t);return r.val=e.computed({get:()=>"checkbox"==t.type?Boolean(this._data[t.name]):this._data[t.name],set:e=>{this._has_changes[t.name]=!0,this._data[t.name]=e,r.validate()}}),r}}class tt extends We{constructor(e,t,r){super(e,t,r),this._component="gc-single-item"}get hasdelete(){return!!this._api_urls.delete}getModelType(){return"getprimary"}load(e){let t={};return e&&(t[this._primary_key]=e),h.get(this._api_urls.load,t).then((e=>{for(let t in this._fields)"asset"==this._fields[t].type?(this._data[t]=new Qe,this._data[t].load_url=this._api_urls.load_url+"-"+kebab_name,this._data[t].chunk_size=this._fields[t].chunk_size,this._data[t].key=this._key):this._data[t]=e[t]})).then((()=>{if(this._custom.load)return this._custom.load(this)})).catch((e=>{alert(e)}))}runDelete(){if(this.hasdelete&&confirm("Are you sure you want to delete this record?")){let e={};e[this._primary_key]=this._data[this._primary_key],h.delete(this._api_urls.delete,e).then((()=>{this._parent_key&&({}[this._parent_key]=this._data.gets(this._parent_key))})).then((()=>{if(this._custom.delete)return this._custom.delete(this)}))}}summary(){let e="";for(let t in this._field)this._fields[t].summary&&(e+=this._fields[t].summary+" ");return e.trim()}}class rt extends We{constructor(t,r,s){super(t,r,s),this._pages=0,this._children=s.children?s.children:[],this._circular=s.circular,this._component=s.circular||this._children.length>0?"gc-tree":"gc-table",this._sort=s.sort,this._key,this._data=e.reactive([]),this._search_data=e.reactive({}),this._active_children=[],this._order_by={},this._limit_fields=[],this._page=0,this._limit=1e3,this._select_fields=[],this._selected_fields=[];let o=0;for(let e in this._fields)e!=this._parent_key&&(o<2||this._fields[e].summary?(this._fields[e].on=!0,this._limit_fields.push(e),++o):(this._fields[e].on=!1,this._select_fields.push(e)),"select"==this._fields[e].type?this._search_data[e]=[]:this._search_data[e]="")}getModelType(){return"repo"}get key(){return this._key}set key(e){this._key=e}set circular(e){this._circular=e}set sort(e){this._sort=e}set orderby(e){this._order_by=e}get pages(){return this._pages}get component(){return"gc-repo"}get rawcomponent(){return this._component}get orderby(){return this._order_by}get circular(){return this._circular}get sort(){return this._sort}get children(){return this._children}get limitedfields(){return[...this._limit_fields,...this._selected_fields]}get selectfields(){return this._select_fields}get selectedfields(){return this._selected_fields}get searchdata(){return this._search_data}get activechildren(){return this._active_children}get parentvalue(){return this._key}set params(e){this._params=e}set selectedfields(e){this._selected_fields=e}get params(){let e=this._params;this._key&&(e[this._parent_key]=this._key);const t=this.limitedfields;if(t>0&&(e.__fields=t),this._active_children.length>0&&(e.__children=this._active_children),this._search_data)for(let t in this._search_data)this._search_data[t]&&(Array.isArray(this._search_data[t])?this._search_data[t].length>0&&(e[t]=this._search_data[t]):e[t]=this._search_data[t]);return this._order_by&&(e.__order=this._order_by),this._pages>0&&(e.__limit=this._page+", "+this._limit),e}rLoadObj(e){let t={};for(const r in this._fields)this._fields[r].on&&(t[r]=e[r]);if(this._circular&&e[this._model]&&e[this._model]){t[this._model]=[];for(const r in e[this._model])t[this._model].push(this.rLoadObj(e[this._model][r]))}for(const r in this._active_children){const s=this._active_children[r];if(e[s]){t[s]=[];for(const r in e[s])t[s].push(this.rLoadObj(e[s][r]))}}return t}load(e){this._key=e,this._data=[];for(const e in this._fields)this._fields[e].on=!1;for(const e in this.limitedfields)this._fields[this.limitedfields[e]].on=!0;return h.get(this._api_urls.load,this.params).then((e=>{for(const t in e.__data){const r=this.rLoadObj(e.__data[t]);this._data.push(r)}})).then((()=>{if(this._custom.load)return this._custom.load(this)})).catch((e=>{alert(e)}))}submit(){return this.load()}sortData(){this._data.sort(((e,t)=>e[this._primary_key]==t[this._primary_key]?0:this._circular&&e[this._circular]!=t[this._circular]?e[this._circular]<=t[this._circular]?-1:1:e[this._sort]<=t[this._sort]?-1:1))}saveSort(){let e=[];for(let t in this._data){let r={};r[this._primary_key]=this._data[t][this._primary_key],this._circular&&(r[this._circular]=this._data[t][this._circular]),r[this._sort]=this._data[t][this._sort],e.push(r)}h.put(this.state.apiurls.put,e).then((()=>{if(this._custom.sort)return this._custom.sort(this)})).catch((e=>{console.log(e)}))}updateFields(e){for(let t of e)this._fields[t.name].on=t.show;this.load()}search(){let e=data.getData();this._params={};for(let t in e)if(""!=e[t]){const r=this._fields[t];if("checkbox"==r.type||"select"==r.type)this._params[t]=e[t];else if("time"==r.type){let r={};e[t][0]&&(r.min=e[t][0]),e[t][1]&&(r.max=e[t][1]),r&&(this._params[t]=r)}else this._params[t]="%"+e[t]+"%"}this.load()}exportToViewField(t){let r=super.exportToViewField(t);return r.val=e.computed({get:()=>"checkbox"==t.type?Boolean(this._data[t.name]):this._data[t.name],set:e=>{this._data[t.name]=e,r.validate()}}),r}}class st extends We{constructor(e,t,r){super(e,t,r),this._next_profile="public",this._next_id=0,this._component="gc-account-handler",this._globalerror=""}getModelType(){return"login"}get globalerror(){return this._globalerror}get next_profile(){return this._next_profile}load(){if(this._custom.load)return this._custom.load(this)}submit(){return this._globalerror="",h.post(this._api_urls.login,this._data).then((e=>{if("SUCCESS"!=e.__status)throw e;this._next_profile=e.__profile,this._next_id=e.__profile_id})).then((()=>{if(this._custom.submit)return this._custom.submit(this)}))}exportToViewField(t){let r=super.exportToViewField(t);return r.val=e.computed({get:()=>"checkbox"==t.type?Boolean(this._data[t.name]):this._data[t.name],set:e=>{this._data[t.name]=e,r.validate()}}),r}}class ot{constructor(e,t,r,s={}){this._name=e.model,this._label=r.label,this._states={},this._active_state=null,this._options=s,this._primary_key=r.primarykey,this._parent_key=r.parentkey,this._children=r.children,this._parent_value=t,this._key=0,this.buildlink=(t,r=0)=>()=>{e.overwrite(this._name,t,r),e.endChain()};for(let t in r.states){let o=null,i={};if("get"==t||"getprimary"==t)for(let e in r.fields)i[e]=new Ke(e,r.fields[e]);else{let e=r.states[t].fields;for(let t in e)i[e[t]]=new Ke(e[t],r.fields[e[t]])}r.states[t].fields=i,r.states[t].primarykey=this._primary_key,r.states[t].parentkey=this._parent_key,r.circular&&(r.states[t].circular=r.circular),this.setActions(e,r.states),this._options[t]&&(r.states[t].custom=this._options[t]),"get"==t?o=new rt(this._name,this._parent_value,r.states[t]):"getprimary"==t?o=new tt(this._name,this._parent_value,r.states[t]):"post"==t?(o=new Ze(this._name,this._parent_value,r.states[t]),r.states.login&&(o.component="gc-account-handler")):"put"==t?o=new et(this._name,this._parent_value,r.states[t]):"login"==t&&(o=new st(this._name,this._parent_value,r.states[t])),this._states[t]=o,console.log("Building a state for ",t,o),console.log("Passed through custom options",s),this._options[t]&&this._options[t].init&&this._options[t].init(o)}this._active_state=e.state}get name(){return this._name}get currentstate(){return this._active_state?this._states[this._active_state]:null}get label(){return this._label}get action(){return this._active_state}get activestate(){return this._active_state&&this._states[this._active_state]?this._states[this._active_state]:null}get children(){return this._children}load(e){return e.prev&&(this.currentstate.parentkeyvalue=e.prev.key),this.currentstate.load(e.key)}setActions(e,t){t.get&&this.createGetActions(e,t),t.getprimary&&this.createGetPrimaryActions(e,t),t.post&&this.createPostActions(e,t),t.put&&this.createPutActions(e,t),t.login&&this.createLoginActions(e,t)}createGetActions(e,t){let r={};t.post&&(r.post={r:this.buildlink("post",e.key),n:t.post.label}),t.get.actions=r,t.get.next=r=>{t.getprimary?(e.overwrite(this._name,"getprimary",r),Je.runRoute()):t.put&&(e.overwrite(this._name,"put",r),Je.runRoute())}}createGetPrimaryActions(e,t){let r={};t.put&&(r.put={r:this.buildlink("put",e.key),n:t.put.label}),t.getprimary&&t.getprimary.api_urls.delete&&(r.delete={r:this.buildlink("delete",e.key),n:"delete"}),t.getprimary.actions=r}createPostActions(e,t){let r=[];t.login&&(r.login={r:this.buildlink("login"),n:t.login.label}),t.post.actions=r,t.post.next=t=>{e.createTempURL(this._name,"get",t)}}createPutActions(e,t){t.put.next=()=>{e.createTempURL(this._name,"get")}}createLoginActions(e,t){let r=[];t.post&&(r.post={r:this.buildlink("post"),n:t.post.label}),t.login.actions=r,t.login.next=e=>{Je.reloadFromBase(e.next_profile)}}exportToViewBlock(){return{actions:actions}}getCurrentState(){return this._active_state?this._states[this._active_state]:null}exportToStore(){return this.currentstate}}class it{constructor(t=null){this._parent=t,this._model=null,this._model_set=e.reactive({set:[]}),this._options={},this._key=0,this._init=!1,this._is_active=!1}get model(){return this._model}get children(){return this.model?this.model.children:[]}get key(){return this._key}get is_active(){return this._is_active}set key(e){this._key=e}set is_active(e){this._is_active=e}injectCustomSettings(e){this._options=e}buildLink(e,t,r){return()=>{e.overwrite(t,r,this._model.currentstate.parentvalue),e.endChain()}}getDefaultState(e){return e.get?"get":e.getprimary?"getprimary":e.login?"login":e.put?"put":e.post?"post":void 0}init(e){let t=e.prev?e.prev.key:0;this._model=null,this._model_set.set=[],this._init=!0;let r="/route-";return r+=this._parent&&"__default"!=this._parent?this._parent:"default",h.get(r).then((r=>{if("SUCCESS"!=r.__status)throw new Error(r);for(let s in r.routes)(e.model||this._model)&&e.model!=s||(e.model=s,e.state||(e.state=this.getDefaultState(r.routes[s].states)),this._model=new ot(e,t,r.routes[s],this._options[s])),this._model_set.set.push({n:r.routes[s].label,r:this.buildLink(e,s,this.getDefaultState(r.routes[s].states))});return r}))}getCurrentState(){return this._model?this._model.getCurrentState():null}run(e){return this.init(e).then((()=>this._model.load(e)))}exportToStore(){return this._model_set}}class nt{constructor(t={}){this._store=e.reactive({groups:[],profile:null}),this._model_settings={},this._route_interrupt=null,this._map=null,this._groups=[],this._settings=t,this._profile}get store(){return this._store}get groups(){return this._groups}set map(e){this._map=e}get map(){return this._map}initProfile(){return h.get("/core-check-user").then((e=>(this._profile=e.__profile,this._store.profile=this._profile,this._profile)))}assumeRole(e){return gc.Client.post("/core-assume-role",{role:e}).then((e=>(this._profile=e.__profile,e.__profile)))}buildGroup(e){console.log("Building model group for",e.group);let t=new it(e.group);return this._settings[this._profile]&&(console.log("Injecting Settings for ",this._profile),t.injectCustomSettings(this._settings[this._profile])),this._groups.push(t),t}run(){let e=this._map.maps;if(!e)throw new Error("Error with controller run, no maps created");this._store.groups=[];let t=[],r=e;for(let e in this._groups){if(!r||!r.notchanged){this._groups.splice(e,this._groups.length-e);break}r=r.next}for(;r;){const e=this.buildGroup(r);t.push(e.run(r)),r=r.next}Promise.all(t).then((()=>{const e=this._map.lastmap;if("getprimary"==e.state){let t=this._groups[this._groups.length-1];if(t.is_active=!0,t.model.children.length>0){const t=this._map.createMap(e.model);t.key=e.key;return this.buildGroup(t).run(t)}}else{for(let e of this._groups)e.is_active=!1;this._groups[this._groups.length-1].is_active=!0}})).then((()=>{for(let e of this._groups)this._store.groups.push({siblings:e.exportToStore(),active:e.is_active,model:e.model.exportToStore()})}))}runLink(){Je.runRoute()}}const at={post:"-create",put:"-update",delete:"-delete",login:"-login",logout:"-logout",getprimary:"-primary",get:""};class lt{constructor(e){this._group=e,this._model,this._state,this._key=0,this._not_changed=!1,this._next,this._prev,this._overwrite=null}set model(e){this._model=e}set state(e){this._state=e}set key(e){this._key=e}set group(e){this._group=e}set notchanged(e){this._not_changed=e}set next(e){this._next=e,e.prev=this}set prev(e){this._prev=e}get model(){return this._model}get state(){return this._state}get key(){return this._key}get group(){return this._group}get notchanged(){return this._not_changed}get next(){return this._next}get prev(){return this._prev}swap(e){this._group=e.group,this._model=e.model,this._state=e.state,this._key=e.key,this._next=e.next,this._not_changed=!1}endChain(){this._next=null}overwrite(e,t,r){this._overwrite={},this._overwrite.model=e,this._overwrite.state=t,this._overwrite.key=r}matches(e){let t=["group","model","state","key"];for(let r of t){if(e[r]!=this[r])return!1}return!0}convertToURL(){let e=this._model,t=this._state,r=this._key;this._overwrite&&(e=this._overwrite.model,t=this._overwrite.state,r=this._overwrite.key);let s=e+at[t];return r&&(s+="-"+r),s}convertFromURL(e){let t=e.split("-");if(0==t.length)return;let r=parseInt(t[t.length-1]);if(isNaN(r)?this._key=0:(t.pop(),this._key=r),0==t.length)throw new Error("Can't convert this url string: "+e);for(let e in at)if(at[e]=="-"+t[t.length-1]){this._state=e,t.pop();break}this._model=t.join("-")}}class ct{constructor(e){this._root=null,this._ctrl=e,this._trigger}get ctrl(){return this._ctrl}get maps(){return this._root}get lastmap(){if(!this._root)return null;let e=this._root;for(;e.next;)e=e.next;return e}append(e){const t=this.lastmap;t?t.next=e:this._root=e}trigger(e){this._trigger=e}createMap(e){let t=new lt(e);return this.append(t),t}convertToURL(){let e=[],t=this._root;for(;t;)e.push(t.convertToURL()),t=t.next;return"/"+e.join("/")}convertFromURL(e){let t=(e=e.replace(/^\/+|\/+$/g,"")).split("/"),r="__default",s=this._root;for(let e in t){let o=new lt(r);o.convertFromURL(t[e]),s?s.matches(o)?s.notchanged=!0:s.swap(o):this.append(o),r=o.model,s&&(s=s.next)}console.log(this._root),this._trigger()}}var dt={createController:function(e={}){let t=new nt(e),r=new ct;return t.map=r,r.trigger((()=>{t.run()})),Je.regCtrl(r),t},regSettings:function(e){}};var ht={injectSettings:function(e){if(!e.client)throw new Error("You must set client settings");if(h.setURL(e.client.url),e.client.custom_headers)for(let t in e.client.custom_headers)h.regCustomHeader(t,e.client.custom_headers[t]);e.client.debug&&h.regDebug(!0),h.regStatusHandler(403,(function(){alert("Page not found")})),e.mapper&&e.mapper.base&&Je.setBase(e.mapper.base),e.models&&dt.regSettings(e.models)}},ut={GCRoot:Ye,Router:De,Controller:nt,Client:h,URLMapper:Je,FactoryController:dt,Settings:ht,GCForm:F,GCSingleItem:Oe,GCTable:me,GCTree:he,GCRepo:Ce};exports.default=ut;
//# sourceMappingURL=gc.cjs.js.map
